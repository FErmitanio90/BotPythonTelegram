"use strict";(globalThis.webpackChunk=globalThis.webpackChunk||[]).push([["ui_packages_diff-lines_diff-lines_ts-ui_packages_diff-lines_hooks_use-selected-diff-hash_ts-u-62bb97","ui_packages_file-renderer-blob_FileRendererBlob_tsx"],{73412:(e,t,n)=>{function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n.d(t,{z:()=>WebWorker});let WebWorker=class WebWorker{set onmessage(e){this.worker.onmessage=e}postMessage(e){this.worker.postMessage(e)}terminate(){this.worker.terminate()}constructor(e,t){i(this,"worker",void 0);try{this.worker=new Worker(`${e}?module=true`,{type:"module"})}catch{console.warn("Web workers are not available. Please enable web workers to benefit from the improved performance."),this.worker=new MainThreadWorker(t)}}};let MainThreadWorker=class MainThreadWorker{async postMessage(e){if(this.terminated)return;let t={data:this.job({data:e})};this.onmessage?.(t)}terminate(){this.terminated=!0}constructor(e){i(this,"terminated",!1),i(this,"onmessage",void 0),this.job=e}}},93307:(e,t,n)=>{function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}n.d(t,{N:()=>DebouncedWorkerManager});let DebouncedWorkerManager=class DebouncedWorkerManager{post(e){if(this.debounceOverrideCondition&&this.debounceOverrideCondition(e))return this.delayId&&clearTimeout(this.delayId),this.postNow(e);this.idle()?(this.delayId&&clearTimeout(this.delayId),this.delayId=setTimeout(()=>{this.postNow(e)},this.delayMs)):this.nextRequest=e}postNow(e){this.currentRequest=e,this.worker.postMessage(e)}idle(){return!this.currentRequest}terminate(){this.worker.terminate()}constructor(e,t=200,n){i(this,"currentRequest",void 0),i(this,"nextRequest",void 0),i(this,"onResponse",void 0),i(this,"delayId",void 0),this.worker=e,this.delayMs=t,this.debounceOverrideCondition=n,this.worker.onmessage=({data:e})=>{this.onResponse&&this.onResponse(e),this.nextRequest?(this.postNow(this.nextRequest),this.nextRequest=void 0):this.currentRequest=void 0}}}},57259:(e,t,n)=>{n.d(t,{e:()=>i});function i(e){let t=document.querySelector('#__primerPortalRoot__ div[role="dialog"]'),n=document.querySelector(`#${e} div[role="dialog"]`);(t||n)&&document.dispatchEvent(new KeyboardEvent("keydown",{key:"Escape",code:"Escape",ctrlKey:!0}))}},91618:(e,t,n)=>{n.d(t,{HS:()=>l,Oc:()=>r,Tv:()=>o,Xr:()=>SymbolChangedEvent,f7:()=>a,fD:()=>s,qR:()=>i});let OpenCopilotChatEvent=class OpenCopilotChatEvent extends Event{constructor(e){super("open-copilot-chat",{bubbles:!1,cancelable:!0}),this.payload=e}};Event;let AddCopilotChatReferenceEvent=class AddCopilotChatReferenceEvent extends Event{constructor(e,t=!1,n){super("add-copilot-chat-reference",{bubbles:!1,cancelable:!0}),this.reference=e,this.openPanel=t,this.id=n}};let SymbolChangedEvent=class SymbolChangedEvent extends Event{constructor(e){super("symbol-changed",{bubbles:!1,cancelable:!0}),this.context=e}};function i(e){window.dispatchEvent(new OpenCopilotChatEvent(e))}function r(e,t=!1,n){window.dispatchEvent(new AddCopilotChatReferenceEvent(e,t,n))}function l(e){return window.addEventListener("open-copilot-chat",e),()=>{window.removeEventListener("open-copilot-chat",e)}}function a(e){return window.addEventListener("add-copilot-chat-reference",e),()=>{window.removeEventListener("add-copilot-chat-reference",e)}}function s(e){return window.addEventListener("search-copilot-chat",e),()=>{window.removeEventListener("search-copilot-chat",e)}}function o(e){return window.addEventListener("symbol-changed",e),()=>{window.removeEventListener("symbol-changed",e)}}},77342:(e,t,n)=>{n.d(t,{C6:()=>r,UH:()=>o,Wp:()=>d,hs:()=>a,mF:()=>s,wh:()=>i,xP:()=>l});let i={explain:"explain",conversation:"conversation",suggest:"suggest",discussFileDiff:"discuss-file-diff",explainFileDiff:"explain-file-diff",reviewPr:"review-pull-request",actionsAgent:"actions-agent"},r=["exception","filtered","publicCode","contentTooLarge","rateLimit","agentUnauthorized","agentRequest","networkError","multipleAgentsAttempt"],l=["bing-search","codesearch","semantic-code-search","lexical-code-search","kb-search","getfile","getfilechanges","getdiscussion","get-actions-job-logs","getalert","planskill","get-github-data","support-search","get-figma","codesearchagentskill"],a={Experiments:"experiements",Prompt:"prompt",None:"none"},s={Unlicensed:"unlicensed",LicensedFull:"licensed_full",LicensedLimited:"licensed_limited"},o={IndividualFree:"free",IndividualPro:"pro",IndividualProPlus:"pro_plus",Business:"business",Enterprise:"enterprise"},d="NULL_MESSAGE"},1977:(e,t,n)=>{n.d(t,{B:()=>p,C:()=>g});var i=n(74848),r=n(21728),l=n(34164),a=n(38621),s=n(34614),o=n(23976),d=n(42522),c=n(84),u=n(69710),f=n(26514);let h={"diff-file-header":"DiffFileHeader-module__diff-file-header--TjXyn",collapsed:"DiffFileHeader-module__collapsed--FPwYM","file-name":"DiffFileHeader-module__file-name--mY1O5"};function m(e){let t,n,l=(0,r.c)(13),{newPath:s,oldPath:o,status:d}=e;l[0]!==s?(t=(0,i.jsxs)(i.Fragment,{children:["\u200E",s]}),l[0]=s,l[1]=t):t=l[1];let c=t;l[2]!==o?(n=(0,i.jsxs)(i.Fragment,{children:["\u200E",o]}),l[2]=o,l[3]=n):n=l[3];let u=n;if("RENAMED"===d){let e,t,n;return l[4]===Symbol.for("react.memo_cache_sentinel")?(e=(0,i.jsx)(a.ArrowRightIcon,{}),t=(0,i.jsx)("span",{className:"sr-only",children:"renamed to "}),l[4]=e,l[5]=t):(e=l[4],t=l[5]),l[6]!==c||l[7]!==u?(n=(0,i.jsxs)("code",{children:[u," ",e,t,c]}),l[6]=c,l[7]=u,l[8]=n):n=l[8],n}if("DELETED"===d||"REMOVED"===d){let e;return l[9]!==u?(e=(0,i.jsx)("code",{children:u}),l[9]=u,l[10]=e):e=l[10],e}{let e;return l[11]!==c?(e=(0,i.jsx)("code",{children:c}),l[11]=c,l[12]=e):e=l[12],e}}function p(e){let t,n,p,g,x,b,y,C,v,N,j,w,L,S,D,I,k,E,_=(0,r.c)(67),{additionalLeftSideContent:R,areLinesExpanded:A,canExpandOrCollapseLines:T,className:O,diffStatsProps:$,defaultToRichDiff:M,isBinary:P,isSubmodule:F,isCollapsed:U,canToggleRichDiff:H,headingId:B,linesAdded:z,linesChanged:G,linesDeleted:V,fileLinkHref:q,fileLinkRef:W,newMode:K,newPath:X,oldMode:J,oldPath:Y,onCopyPath:Z,onHeaderClick:Q,onToggleDiffDisplay:ee,onToggleExpandAllLines:et,onToggleFileCollapsed:en,patchStatus:ei,path:er,rightSideContent:el,size:ea}=e,es=ea&&"-"===ea[0],eo=U?h.collapsed:"";_[0]!==O||_[1]!==eo?(t=(0,l.$)(h["diff-file-header"],eo,"flex-wrap flex-sm-nowrap",O),_[0]=O,_[1]=eo,_[2]=t):t=_[2];let ed=U?`Expand file: ${er}`:`Collapse file: ${er}`;_[3]!==U?(n=U?(0,i.jsx)(a.ChevronRightIcon,{}):(0,i.jsx)(a.ChevronDownIcon,{}),_[3]=U,_[4]=n):n=_[4],_[5]!==en||_[6]!==ed||_[7]!==n?(p=(0,i.jsx)("button",{onClick:en,className:"Button Button--iconOnly Button--invisible flex-shrink-0 flex-order-1","aria-label":ed,children:n}),_[5]=en,_[6]=ed,_[7]=n,_[8]=p):p=_[8],_[9]===Symbol.for("react.memo_cache_sentinel")?(g=(0,l.$)(h["file-name"]),_[9]=g):g=_[9],_[10]!==X||_[11]!==Y||_[12]!==ei?(x=(0,i.jsx)(m,{newPath:X,oldPath:Y,status:ei}),_[10]=X,_[11]=Y,_[12]=ei,_[13]=x):x=_[13],_[14]!==q||_[15]!==W||_[16]!==Q||_[17]!==x?(b=(0,i.jsx)(s.A,{className:"Link--primary",href:q,onClick:Q,ref:W,"data-analytics-opt-out":!0,children:x}),_[14]=q,_[15]=W,_[16]=Q,_[17]=x,_[18]=b):b=_[18],_[19]!==B||_[20]!==b?(y=(0,i.jsx)("h3",{id:B,className:g,children:b}),_[19]=B,_[20]=b,_[21]=y):y=_[21];let ec=X??Y??"";return _[22]===Symbol.for("react.memo_cache_sentinel")?(C={direction:"s"},_[22]=C):C=_[22],_[23]!==Z||_[24]!==ec?(v=(0,i.jsx)(f.T,{className:"ml-1 flex-shrink-0",textToCopy:ec,ariaLabel:"Copy file name to clipboard",tooltipProps:C,onCopy:Z}),_[23]=Z,_[24]=ec,_[25]=v):v=_[25],_[26]!==K||_[27]!==J||_[28]!==ei?(N=(0,c.AL)(ei,J,K)&&(0,i.jsxs)("div",{className:"p-2",children:[(0,i.jsx)("code",{children:J}),(0,i.jsx)(a.ArrowRightIcon,{className:"mx-1"}),(0,i.jsx)("code",{children:K})]}),_[26]=K,_[27]=J,_[28]=ei,_[29]=N):N=_[29],_[30]!==A||_[31]!==T||_[32]!==et||_[33]!==er?(j=T&&et&&(0,i.jsx)(d.m,{text:A?`Collapse non-diff lines: ${er}`:`Expand all lines: ${er}`,direction:"s",children:(0,i.jsx)("button",{onClick:et,className:`Button Button--iconOnly Button--invisible flex-shrink-0 ${A?"":"js-expand-all-difflines-button"}`,"aria-label":A?`Collapse non-diff lines: ${er}`:`Expand all lines: ${er}`,"data-file-path":er,children:A?(0,i.jsx)(a.FoldIcon,{}):(0,i.jsx)(a.UnfoldIcon,{})})}),_[30]=A,_[31]=T,_[32]=et,_[33]=er,_[34]=j):j=_[34],_[35]!==v||_[36]!==N||_[37]!==j||_[38]!==y?(w=(0,i.jsxs)("div",{className:"d-flex px-1 flex-items-center overflow-hidden flex-order-2 flex-sm-order-1",children:[y,v,N,j]}),_[35]=v,_[36]=N,_[37]=j,_[38]=y,_[39]=w):w=_[39],_[40]!==$||_[41]!==F||_[42]!==z||_[43]!==G||_[44]!==V?(L=!F&&(0,i.jsx)(u.z,{linesAdded:z,linesDeleted:V,linesChanged:G,tooltipDirection:"sw",...$}),_[40]=$,_[41]=F,_[42]=z,_[43]=G,_[44]=V,_[45]=L):L=_[45],_[46]!==L?(S=(0,i.jsx)("div",{className:"d-flex mr-2 flex-justify-end flex-items-center flex-1",children:L}),_[46]=L,_[47]=S):S=_[47],_[48]!==P||_[49]!==es||_[50]!==ea?(D=P&&(0,i.jsx)("div",{className:"d-flex flex-items-center",children:(0,i.jsx)("code",{className:(0,l.$)("px-2",es&&"fgColor-danger",!es&&"fgColor-success"),children:`${ea}`})}),_[48]=P,_[49]=es,_[50]=ea,_[51]=D):D=_[51],_[52]!==H||_[53]!==M||_[54]!==ee?(I=H&&(0,i.jsxs)(o.I,{"aria-label":"File view",size:"small",className:"mx-2",onChange:ee?e=>ee(1===e):void 0,children:[(0,i.jsx)(o.I.IconButton,{"aria-label":"Display the source diff",defaultSelected:!M,icon:a.CodeIcon}),(0,i.jsx)(o.I.IconButton,{"aria-label":"Display the rich diff",defaultSelected:M,icon:a.FileIcon})]}),_[52]=H,_[53]=M,_[54]=ee,_[55]=I):I=_[55],_[56]!==el||_[57]!==S||_[58]!==D||_[59]!==I?(k=(0,i.jsxs)("div",{className:"d-flex flex-row flex-justify-end flex-1 flex-order-1 flex-sm-order-2 flex-items-center",children:[S,D,I,el]}),_[56]=el,_[57]=S,_[58]=D,_[59]=I,_[60]=k):k=_[60],_[61]!==R||_[62]!==w||_[63]!==t||_[64]!==k||_[65]!==p?(E=(0,i.jsxs)("div",{className:t,children:[p,R,w,k]}),_[61]=R,_[62]=w,_[63]=t,_[64]=k,_[65]=p,_[66]=E):E=_[66],E}try{m.displayName||(m.displayName="FileName")}catch{}try{p.displayName||(p.displayName="DiffFileHeader")}catch{}function g(e){let t,n,a=(0,r.c)(6),{children:s,isAddition:o,className:d}=e,c=o?"fgColor-success":"fgColor-danger";return a[0]!==d||a[1]!==c?(t=(0,l.$)("ml-1 text-small text-bold",c,d),a[0]=d,a[1]=c,a[2]=t):t=a[2],a[3]!==s||a[4]!==t?(n=(0,i.jsx)("div",{className:t,children:s}),a[3]=s,a[4]=t,a[5]=n):n=a[5],n}try{g.displayName||(g.displayName="LinesChangedCounterLabel")}catch{}},84:(e,t,n)=>{function i(e){return void 0!==e.linesChanged&&0!==e.linesChanged}function r(e,t,n){return"MODIFIED"===e&&t!==n}function l(e,t,n,r){return"MODIFIED"===t&&n!==r&&!i(e)}function a(e){return"COPIED"===e.status&&!i(e)}function s(e){return"RENAMED"===e.status&&!i(e)}function o(e){return!!e.oldTreeEntry&&null===e.newTreeEntry}function d(e){return!!e.truncatedReason}n.d(t,{AL:()=>r,HI:()=>d,Jc:()=>a,Sn:()=>l,dK:()=>s,lO:()=>o,l_:()=>f,s8:()=>m,xW:()=>h});let c=["maximum diff size exceeded.","maximum number of lines exceeded."],u=/^maximum file count exceeded/;function f(e){let t=e;return c.includes(e)?t="This diff could not be loaded automatically because of too many other changes.":u.test(e)&&(t="This diff could not be loaded automatically because of too many other files to display."),t}function h(e){return!!e.newTreeEntry?.isGenerated}function m(e){return 0===e.linesChanged}},26920:(e,t,n)=>{n.d(t,{QC:()=>f,s2:()=>h,wH:()=>a,xY:()=>u});var i=n(3240);function r(e,t){var n=function(e,t,n){if(!t.has(e))throw TypeError("attempted to get private field on non-instance");return t.get(e)}(e,t,0);return n.get?n.get.call(e):n.value}function l(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function a(e,t){return e<t?-1:+(e>t)}function s(e,t){return a(e.name,t.name)}function o(e,t){return a(e.fileName,t.fileName)}function d(e){return e.diff}let FileNode=class FileNode{constructor(e){this.diff=e,this.filePath=e.path;let t=this.filePath.split("/");this.fileName=t[t.length-1],this.directoryParts=t.slice(0,t.length-1)}};var c=new WeakMap;let DirectoryNode=class DirectoryNode{getOrCreateDirectory(e){let t=r(this,c).get(e);if(!t){let n=this.path?`${this.path}/`:"";t=new DirectoryNode(e,`${n}${e}`),this.directories.push(t),r(this,c).set(e,t)}return t}sort(){for(let e of(this.directories.sort(s),this.files.sort(o),this.directories))e.sort()}getOrderedDiffs(){let e=this.files.map(d);for(let t of this.directories)e.push(...t.getOrderedDiffs());return e}constructor(e,t){l(this,"directories",[]),l(this,"files",[]),function(e,t,n){if(t.has(e))throw TypeError("Cannot initialize the same private elements twice on an object");t.set(e,n)}(this,c,{writable:!0,value:new Map}),this.name=e,this.path=t}};function u(e){let t=new DirectoryNode("","");for(let n of e.slice(0,300).map(e=>new FileNode(e))){let e=t;for(let t of n.directoryParts)e=e.getOrCreateDirectory(t);e.files.push(n)}return t.sort(),t}function f(e){let t;t="string"==typeof e?e:e?.newPath||e?.oldPath;let n=t?.lastIndexOf(".");return t?!n||n<0?i.F7:`.${t.substring(n+1)}`:""}function h(e){let t={};return e.map(e=>{let n=f(e.path);void 0!==t[n]?t[n]+=1:t[n]=1}),t}},28408:(e,t,n)=>{n.d(t,{oO:()=>nS,Ao:()=>nL,n$:()=>nk,cP:()=>n_,T5:()=>ns,Uz:()=>c,Wb:()=>nh,Dd:()=>C.Dd,xB:()=>nP});var i=n(74848),r=n(1977),l=n(96540),a=n(8877),s=n(84688),o=n(44968),d=n(63867);function c({dependencyDiffPath:e,fileRendererInfo:t,proseDiffHtml:n,loading:r}){return r?(0,i.jsx)("div",{className:"d-flex flex-justify-center p-4",children:(0,i.jsx)(d.A,{size:"large"})}):n?(0,i.jsx)("div",{className:"prose-diff position-relative",children:(0,i.jsx)(o.oG,{html:n})}):t?(0,i.jsx)(a.default,{...t}):e?(0,i.jsx)(s.x,{src:e,children:(0,i.jsxs)("div",{className:"text-center py-3",children:[(0,i.jsx)(d.A,{size:"medium"}),(0,i.jsx)("p",{className:"color-fg-muted my-2",children:"Loading Dependency Review..."})]})}):(0,i.jsx)("div",{className:"d-flex flex-justify-center p-4",children:"This rich diff is not supported at the moment."})}try{c.displayName||(c.displayName="RichDiff")}catch{}var u=n(84),f=n(73974),h=n(67220),m=n(34614),p=n(13080),g=n(47584),x=n(46996),b=n(37109);function y({selectedDiffRowRange:e,leftLines:t,rightLines:n,isNumberCell:i}){let r=!!n,{startOrientation:l,endOrientation:a}=e;if(e.startLineNumber===e.endLineNumber&&e.startOrientation===e.endOrientation&&!i)return{isRowSelected:()=>!1,selectedRightLines:[],selectedLeftLines:[]};let s=u(l).findIndex(t=>(0,b.a2)(t,e.startLineNumber,e.startOrientation)),o=u(a).findIndex(t=>(0,b.a2)(t,e.endLineNumber,e.endOrientation)),d=s>=0&&o>=0;function c(e){if(!d||(0,b.Po)(e))return!1;let t=u((0,h.XU)(e.type)).indexOf(e);return t>=s&&t<=o}function u(e){var i;return r&&"left"!==("string"==typeof(i=e)?i:(0,h.XU)(i.type))?n:t}let f=u("left").filter(e=>c(e)),m=u("right").filter(e=>c(e));return{isRowSelected:c,selectedRightLines:m,selectedLeftLines:f}}var C=n(29063),v=n(38568);let N=e=>{let t=(0,l.useRef)(e);return(0,v.N)(()=>(t.current=e,()=>t.current=null),[e]),(0,l.useCallback)((...e)=>t.current?.(...e),[])};var j=n(4460);let w=(0,l.createContext)(null);function L(){let e=(0,l.useContext)(w);if(!e)throw Error("useSelectedDiffRowRange must be used within a SelectedDiffRowRangeContext");return e}function S(e){e.startLineNumber===e.endLineNumber&&e.startOrientation===e.endOrientation?(0,p.i)(`${"left"===e.startOrientation?"L":"R"}${e.startLineNumber} selected.`):(0,p.i)(`${"left"===e.startOrientation?"L":"R"}${e.startLineNumber} to ${"left"===e.endOrientation?"L":"R"}${e.endLineNumber} selected.`)}function D({children:e}){let t=(0,l.useRef)(new Map),n=N((e,n)=>{if(!e)return;let i=e.diffAnchor,r=t.current.get(i);if(!r)return;let{leftLines:l,rightLines:a}=(0,b.Mk)(r);return y({selectedDiffRowRange:e,leftLines:l,rightLines:a,isNumberCell:n})}),[r,a]=(0,l.useState)(()=>(0,C.ZD)(g.fV.hash)),[s,o]=(0,l.useState)(()=>{if(r){let e=n(r);if(e)return{leftLines:e.selectedLeftLines,rightLines:e.selectedRightLines||[]}}return{leftLines:[],rightLines:[]}}),d=N((e,t)=>{let i=n(e,t),r=i?{leftLines:i.selectedLeftLines,rightLines:i.selectedRightLines||[]}:{leftLines:[],rightLines:[]};(0,x.A)(s,r)||o(r)}),c=N((e,t,n,i,l)=>{if(!t||!n)return;let s=i&&r&&r.diffAnchor===e?t<=r.firstSelectedLineNumber?{...r,startLineNumber:t,startOrientation:n,endLineNumber:r.firstSelectedLineNumber,endOrientation:r.firstSelectedOrientation}:{...r,startLineNumber:r.firstSelectedLineNumber,startOrientation:r.firstSelectedOrientation,endLineNumber:t,endOrientation:n}:{diffAnchor:e,endLineNumber:t,endOrientation:n,startLineNumber:t,startOrientation:n,firstSelectedLineNumber:t,firstSelectedOrientation:n};S(s),(l||i)&&a(s),d(s,l),(0,C.i8)(s)}),u=N(e=>{S(e),a(e),d(e),(0,C.i8)(e)}),f=N(({diffAnchor:e,startGridCell:t,endGridCell:n,focusedGridCell:i})=>{u({diffAnchor:e,endLineNumber:n.lineNumber,endOrientation:n.orientation,firstSelectedLineNumber:i.lineNumber,firstSelectedOrientation:i.orientation,startLineNumber:t.lineNumber,startOrientation:t.orientation})}),h=N(()=>{r&&(a(void 0),d(void 0),(0,p.i)("Selection Cleared"),(0,j.K3)())}),m=N((e,n)=>{t.current.set(e,n),r?.diffAnchor===e&&d(r)}),v=N(e=>t.current.get(e)),L=(0,l.useMemo)(()=>({selectedDiffRowRange:r,updateSelectedDiffRowRange:c,clearSelectedDiffRowRange:h,replaceSelectedDiffRowRange:u,replaceSelectedDiffRowRangeFromGridCells:f,updateDiffLines:m,selectedDiffLines:s,getDiffLinesFromLineRange:n,getDiffLinesByDiffAnchor:v}),[r,c,h,u,f,s,m,n,v]);return(0,i.jsx)(w.Provider,{value:L,children:e})}try{w.displayName||(w.displayName="SelectedDiffRowRangeContext")}catch{}try{D.displayName||(D.displayName="SelectedDiffRowRangeContextProvider")}catch{}var I=n(34164),k=n(55847);let E={gridColumnTemplate:"HiddenDiffPatch-module__gridColumnTemplate--3bEGq"};var _=n(38621);function R({children:e,helpText:t,helpUrl:n,onLoadDiff:r,diffAnchor:a}){let s=n&&t,[o,c]=(0,l.useState)("initial"),u=(0,l.useCallback)(async()=>{try{c("loading"),await r()}catch{c("error")}},[r,c]);return(0,i.jsx)("div",{className:"px-3 py-4 fgColor-muted","data-diff-anchor":a,children:(0,i.jsxs)("div",{className:(0,I.$)(E.gridColumnTemplate),children:[(0,i.jsx)("svg",{"aria-hidden":!0,height:"84",style:{maxWidth:"340px"},viewBox:"0 0 340 84",xmlns:"http://www.w3.org/2000/svg",children:(0,i.jsx)("path",{clipPath:"url(#diff-placeholder)",d:"M0 0h340v84H0z",fillRule:"evenodd",style:{fill:"var(--bgColor-muted, var(--color-canvas-subtle))"}})})," ",(0,i.jsxs)("div",{className:"d-flex flex-justify-center flex-column flex-column text-center flex-items-center",children:["loading"===o&&(0,i.jsx)(d.A,{size:"medium"}),"error"===o&&(0,i.jsx)(_.AlertIcon,{size:24}),"initial"===o&&(0,i.jsx)(k.Q,{className:"h4 mx-auto fgColor-accent",variant:"invisible",onClick:()=>{u(),c("loading")},children:"Load Diff"}),"error"===o?(0,i.jsxs)("span",{className:"fgColor-muted mt-1",children:["The contents of the file couldn't be loaded."," ",(0,i.jsx)(m.A,{inline:!0,as:"button",onClick:()=>{u(),c("loading")},children:"Retry"})]}):(0,i.jsxs)("span",{className:"fgColor-muted mt-1",children:[e,s&&(0,i.jsx)(m.A,{inline:!0,href:n,children:t})]})]})]})})}try{R.displayName||(R.displayName="HiddenDiffPatch")}catch{}let A={finalLineId:"final-hunk-header-line"};function T(e,t){return e.startBlobLineNumber-t.startBlobLineNumber}function O(e,t){if("HUNK"===e.type&&e.__id===A.finalLineId)return{currentHunk:t[t.length-1],previousHunk:t[t.length-2]};let n=t.sort(T).findIndex(t=>t.startBlobLineNumber<=e.blobLineNumber&&t.endBlobLineNumber>=e.blobLineNumber);return{currentHunk:t[n],nextHunk:t[n+1],previousHunk:t[n-1]}}function $(e){let t=[],n=0;for(let i=1;i<e.length;i++){let r=e[i],l=i===e.length-1;if(r&&!(0,b.Po)(r)){if("HUNK"===r.type){let l,a=e[n];if(!a||(0,b.Po)(a))continue;let s=i-1;for(;(!l||(0,b.Po)(l))&&(l=e[s],-1!=--s););l&&!(0,b.Po)(l)&&t.push({startBlobLineNumber:a.blobLineNumber,endBlobLineNumber:l.blobLineNumber}),r.__id===A.finalLineId&&t.push({startBlobLineNumber:r.blobLineNumber,endBlobLineNumber:r.blobLineNumber+20}),n=i;continue}if(l){let i=e[n];i&&!(0,b.Po)(i)&&t.push({startBlobLineNumber:i.blobLineNumber,endBlobLineNumber:r.blobLineNumber})}}}return t}let M=(0,l.createContext)(null);function P({children:e,currentHunk:t,diffEntryId:n,diffLine:r,fileAnchor:a,fileLineCount:s,filePath:o,hasHiddenUnicodeCharacters:d,isLeftSide:c,isRowSelected:u=!1,isSplit:f,modifiedLineThreads:h,nextHunk:m,originalLineThreads:p,previousHunk:g,rowId:x,diffContext:b,setInGridMode:y}){let C=(0,l.useMemo)(()=>({currentHunk:t,diffEntryId:n,diffLine:r,fileAnchor:a,fileLineCount:s,filePath:o,hasHiddenUnicodeCharacters:d,isLeftSide:c,isRowSelected:u,isSplit:f,modifiedLineThreads:h,modifiedLineHasThreads:h&&h.length>0,nextHunk:m,originalLineThreads:p,originalLineHasThreads:p&&p.length>0,previousHunk:g,rowId:x,diffContext:b,setInGridMode:y}),[t,n,r,a,s,o,d,c,u,f,h,m,p,g,x,b,y]);return(0,i.jsx)(M.Provider,{value:C,children:e})}function F(){let e=(0,l.useContext)(M);if(!e)throw Error("useDiffLineContext must be used within a DiffLineContextProvider");return e}try{M.displayName||(M.displayName="DiffLineContext")}catch{}try{P.displayName||(P.displayName="DiffLineContextProvider")}catch{}function U(e,t){return e?.threads?.flatMap(e=>{let n=e?.id,i=e?.commentsData?.comments?.[0]?.author??t,r=e?.commentsData?.totalCount??0,l=e?.commentsData?.__id;return n&&i?[{id:n,author:i,commentCount:r,commentsConnectionId:l,diffSide:e.diffSide,isOutdated:e.isOutdated,line:e.line,startLine:e.startLine,startDiffSide:e.startDiffSide}]:[]})??[]}var H=n(82678);function B(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}let GridNavigator=class GridNavigator{moveToNextItem(e,t){let n,i=this.cellIdToGridLocation.get(this.focusedGridCell?.cellId??"");if(!i)return;let[r]=i,[,l]=i;switch(("ArrowDown"===e||"ArrowUp"===e)&&this.isHunkRow(r)&&this.savedColumnIndex&&(l=this.savedColumnIndex,this.savedColumnIndex=void 0),!0){case t&&"Home"===e:this.focusFirstGridCell();break;case t&&"End"===e:{let e=this.grid.length-1,t=this.grid[e]?.length;t&&(n=this.grid[e]?.[t-1]);break}case"ArrowUp"===e:this.isHunkRow(r-1)?(this.saveColumnIndex(l),n=this.grid[r-1]?.[0]):n=this.grid[r-1]?.[l];break;case"ArrowDown"===e:this.isHunkRow(r+1)?(this.saveColumnIndex(l),n=this.grid[r+1]?.[0]):n=this.grid[r+1]?.[l];break;case"ArrowLeft"===e:n=this.grid[r]?.[l-1];break;case"ArrowRight"===e:n=this.grid[r]?.[l+1];break;case"PageUp"===e:{this.saveColumnIndex(l);let e=this.getPreviousHunkRowIndex(r);n=this.grid[e]?.[0];break}case"PageDown"===e:{this.saveColumnIndex(l);let e=this.getNextHunkRowIndex(r),t=0;e||(e=this.grid.length-1,t=l),n=this.grid[e]?.[t];break}case"Home"===e:n=this.grid[r]?.[0];break;case"End"===e:{let e=this.grid[r];if(e&&!this.isHunkRow(r)){let t=e.length-1;n=this.grid[r]?.[t]}}}return n&&(this.focusedGridCell=n),this.focusedGridCell}reinitializeGrid(e,t){this.initializeGrid(e,t)}focusFirstGridCell(e){e&&this.cellIdToGridLocation.get(e)?this.focusGridCell(e):this.focusedGridCell=this.grid[0]?.[0]}focusGridCell(e){if(this.focusedGridCell?.cellId===e)return;let t=this.cellIdToGridLocation.get(e);if(!t)return;let[n,i]=t;this.focusedGridCell=this.grid[n]?.[i]}getNextSelectableCell(e){let t,n=this.lastSelectedGridCell||this.focusedGridCell,i=this.cellIdToGridLocation.get(n?.cellId??"");if(!i)return;let[r,l]=i;if(("ArrowUp"!==e||!(r<=1))&&("ArrowDown"!==e||r!==this.grid.length-1)){if("ArrowUp"===e){let e=r-1;for(;!t;)t=this.getNextSelectableCellFromRow({rowIndex:e,columnIndex:l}),e--}if("ArrowDown"===e){let e=r+1;for(;!t;)t=this.getNextSelectableCellFromRow({rowIndex:e,columnIndex:l}),e++}return t&&(this.lastSelectedGridCell=t),t}}getValidSelectableRowCell(){if(this.focusedGridCell?.isHunk)return;if(!this.focusedGridCell?.isEmpty)return this.focusedGridCell;let e=this.cellIdToGridLocation.get(this.focusedGridCell.cellId)?.[0];if(e)return this.focusedGridCell.columnIndex<2?this.grid[e]?.[this.focusedGridCell.columnIndex+2]:this.grid[e]?.[this.focusedGridCell.columnIndex-2]}clearLastSelectedCell(){this.lastSelectedGridCell=void 0}getFirstCodeCell(){let e=this.grid.find(e=>e[0]&&!e[0].isHunk);return e?.find(e=>!e.isEmpty)}getLastCodeCell(){let e=this.grid.slice().reverse().find(e=>e[0]&&!e[0].isHunk);return e?.slice().reverse().find(e=>!e.isEmpty)}hasLine(e,t,n){let i=(0,b.qX)(this.fileAnchor,e,t),r=(0,b.u6)(i,0),l=this.cellIdToGridLocation.get(r);if(!l)return!1;let[a]=l;return!!n===this.isHunkRow(a)}getNextSelectableCellFromRow({rowIndex:e,columnIndex:t}){let n=this.grid[e],i=n?.[t];switch(!0){case i?.isHunk:return;case i?.orientation==="left"&&i.isEmpty:return n?.[t+2];case i?.orientation==="right"&&i.isEmpty:return n?.[t-2];default:return n?.[t]}}getNextHunkRowIndex(e){return Array.from(this.hunkRowIndexes).sort((e,t)=>e-t).find(t=>t>e)}getPreviousHunkRowIndex(e){return Array.from(this.hunkRowIndexes).sort((e,t)=>e-t).reverse().find(t=>t<e)??0}initializeGrid(e,t){this.grid=[],this.cellIdToGridLocation=new Map,this.hunkRowIndexes=new Set;for(let n=0;n<e.length;n++){let i=[],r=e[n];if(void 0!==r){if(this.isSplitDiff){let e=(t||[])[n],l=(0,b.qX)(this.fileAnchor,r,e);(0,b.Po)(r)||"HUNK"!==r.type?this.initializeSplitDiffCodeRow({leftLine:r,rightLine:e,row:i,rowIdentifier:l,rowIndex:n}):this.initializeHunkRow(i,l,n)}else{let e=(0,b.qX)(this.fileAnchor,r,r);(0,b.Po)(r)||"HUNK"!==r.type?this.initializeUnifiedDiffCodeRow({diffLine:r,row:i,rowIdentifier:e,rowIndex:n}):this.initializeHunkRow(i,e,n)}this.grid.push(i)}}}initializeContentCell({cellIndex:e,diffLine:t,orientation:n,row:i,rowIdentifier:r,rowIndex:l}){let a,s=(0,b.u6)(r,e);(0,b.Po)(t)||"left"!==n||(a=t?.left),(0,b.Po)(t)||"right"!==n||(a=t?.right),i.push({lineNumber:a,orientation:n,isHunk:!1,isEmpty:(0,b.Po)(t),cellId:(0,b.u6)(r,e),columnIndex:e}),this.cellIdToGridLocation.set(s,[l,e])}initializeHunkRow(e,t,n){let i=(0,b.u6)(t,0);e.push({isHunk:!0,isEmpty:!1,cellId:i,columnIndex:0}),this.cellIdToGridLocation.set(i,[n,0]),this.hunkRowIndexes.add(n)}isHunkRow(e){return this.hunkRowIndexes.has(e)}initializeSplitDiffCodeRow({leftLine:e,rightLine:t,row:n,rowIdentifier:i,rowIndex:r}){this.initializeContentCell({cellIndex:0,diffLine:e,orientation:"left",row:n,rowIdentifier:i,rowIndex:r}),this.initializeContentCell({cellIndex:1,diffLine:e,orientation:"left",row:n,rowIdentifier:i,rowIndex:r}),this.initializeContentCell({cellIndex:2,diffLine:t,orientation:"right",row:n,rowIdentifier:i,rowIndex:r}),this.initializeContentCell({cellIndex:3,diffLine:t,orientation:"right",row:n,rowIdentifier:i,rowIndex:r})}initializeUnifiedDiffCodeRow({diffLine:e,row:t,rowIdentifier:n,rowIndex:i}){let r=(0,b.Po)(e)||"DELETION"!==e.type?"right":"left";this.initializeContentCell({cellIndex:0,diffLine:e,orientation:"left",row:t,rowIdentifier:n,rowIndex:i}),this.initializeContentCell({cellIndex:1,diffLine:e,orientation:"right",row:t,rowIdentifier:n,rowIndex:i}),this.initializeContentCell({cellIndex:2,diffLine:e,orientation:r,row:t,rowIdentifier:n,rowIndex:i})}saveColumnIndex(e){this.isHunkRow(e)||(this.savedColumnIndex=e)}constructor(e,t,n,i,r){B(this,"grid",[]),B(this,"cellIdToGridLocation",new Map),B(this,"hunkRowIndexes",new Set),B(this,"focusedGridCell",void 0),B(this,"lastSelectedGridCell",void 0),B(this,"savedColumnIndex",void 0),this.fileAnchor=e,this.isSplitDiff=t,this.initializeGrid(n,i),this.focusFirstGridCell(r)}};function z(e){e&&setTimeout(()=>{0!==e.tabIndex&&(e.tabIndex=0)})}var G=n(69676);let V={ArrowLeft:G.z0.ArrowHorizontal,ArrowDown:G.z0.ArrowVertical,ArrowUp:G.z0.ArrowVertical,ArrowRight:G.z0.ArrowHorizontal,h:G.z0.HL,j:G.z0.JK,k:G.z0.JK,l:G.z0.HL,a:G.z0.AD,s:G.z0.WS,w:G.z0.WS,d:G.z0.AD,Tab:G.z0.Tab,Home:G.z0.HomeAndEnd,End:G.z0.HomeAndEnd,PageUp:G.z0.PageUpDown,PageDown:G.z0.PageUpDown,Backspace:G.z0.Backspace},q=G.z0.ArrowAll|G.z0.PageUpDown|G.z0.HomeAndEnd|G.z0.AD,W={ghostUser:{displayName:"Ghost",login:"ghost",avatarUrl:"https://avatars.githubusercontent.com/ghost",path:"/ghost",url:"/ghost"}};function K(e){return e in V&&(V[e]&q)>0}function X({clearSelectedDiffRowRange:e,containerRef:t,fileAnchor:n,isSplitDiff:i,leftLines:r,replaceSelectedDiffRowRangeFromGridCells:a,rightLines:s,selectedDiffRowRange:o,updateSelectedDiffRowRange:d,disabled:c}){var u;let f=(0,l.useRef)(void 0),h=(0,l.useMemo)(()=>new GridNavigator(n,i,r,s,f.current?.focusedGridCell?.cellId),[n,i,r,s]);(0,l.useEffect)(()=>{f.current=h},[h]),u=f.current,(0,l.useEffect)(()=>{if(u&&document.activeElement){let e=function(e,t,n){let i=[];for(let r=0;r<t.length;r++){let l=t[r],a=n?.[r]??l,s=!(0,b.Po)(l)&&l?.type==="HUNK";l&&a&&!e.hasLine(l,a,s)&&i.push(l)}return i}(u,r,s);if(0!==e.length){if(document.activeElement===document.body){let t,i,l,a=r.indexOf(e[e.length-1]),s=r[a+1],o=e[0];s&&!(0,b.Po)(s)&&"HUNK"===s.type&&(t=(0,b.u6)((0,b.qX)(n,s,s),0),i=document.querySelector(`[data-grid-cell-id=${t}]`),l=i?.querySelector("button[data-direction=down], button[data-direction=all]")),l||(t=(0,b.u6)((0,b.qX)(n,o,o),0),i=document.querySelector(`[data-grid-cell-id=${t}]`),l=i?.querySelector("button[data-direction=up], button[data-direction=all]")),t&&i&&(l?l.focus():i.focus(),h.focusGridCell(t),z(i))}else if("BUTTON"===document.activeElement.tagName)z(document.activeElement.closest("td"));else if("TD"===document.activeElement.tagName){let e=document.activeElement.getAttribute("data-grid-cell-id"),n=h.focusedGridCell?.cellId;if(e!==n){let e=t.current?.querySelector(`[data-grid-cell-id=${n}]`);e?.focus()}}}}},[n,r,h,s,u,t]);let m=(0,l.useCallback)(e=>{let t=e.target.getAttribute("data-grid-cell-id");t&&h.focusGridCell(t)},[h]);(0,l.useEffect)(()=>{let e=t.current;return e?.addEventListener("focusin",m),()=>e?.removeEventListener("focusin",m)},[t,m]);let p=(0,l.useCallback)((t,i,r)=>{let l=h.getValidSelectableRowCell();switch(!0){case(r.metaKey||r.ctrlKey)&&"KeyA"===r.code:{let e=h.getFirstCodeCell(),t=h.getLastCodeCell();if(!e||!t)return i;return a({diffAnchor:n,focusedGridCell:e,startGridCell:e,endGridCell:t}),i}case r.shiftKey&&"ArrowDown"===r.key:{let e=h.getNextSelectableCell("ArrowDown");if(!e||!l)return i;return o?.firstSelectedLineNumber?d(n,e.lineNumber,e.orientation,!0):a({diffAnchor:n,focusedGridCell:l,startGridCell:l,endGridCell:e}),i}case r.shiftKey&&"ArrowUp"===r.key:{let e=h.getNextSelectableCell("ArrowUp");if(!e||!l)return i;return o?.firstSelectedLineNumber?d(n,e.lineNumber,e.orientation,!0):a({diffAnchor:n,focusedGridCell:l,startGridCell:e,endGridCell:l}),i}case"ArrowLeft"===r.key&&r.metaKey&&r.shiftKey:return;default:{let t=h.moveToNextItem(r.key,r.ctrlKey),n=t&&document.querySelector(`[data-grid-cell-id=${t.cellId}]`);return e(),h.clearLastSelectedCell(),n??void 0}}},[h,o,d,n,a,e]);return(0,H.G)({containerRef:t,bindKeys:q,getNextFocusable:p,focusableElementFilter:e=>"BUTTON"!==e.tagName&&"TEXTAREA"!==e.tagName,focusInStrategy:"previous",disabled:c},[p]),{gridNavigator:h}}var J=n(54332),Y=n(42242),Z=n(82431),Q=n(87330),ee=n(56126),et=n(42389);let en="a, audio, button, details, embed, iframe, img, input, keygen, label, object, select, textarea, video";function ei(e){e?.setAttribute("aria-hidden","true"),!function t(n=0){setTimeout(()=>{let n=Array.from(e?.querySelectorAll("*")??[]),i=Array.from(e?.querySelectorAll(en)??[]);if(0===i.length)return t(200);for(let e of n)e?.setAttribute("aria-hidden","true");for(let e of i)e.setAttribute("tabindex","-1")},n)}()}function er(e){setTimeout(()=>{for(let t of(e?.setAttribute("aria-hidden","false"),Array.from(e?.querySelectorAll("*")??[])))t?.setAttribute("aria-hidden","false");for(let t of Array.from(e?.querySelectorAll(en)??[]))t.setAttribute("tabindex","0")},100)}var el=n(33563);let ea={inlineAnnotation:"InlineAnnotation-module__inlineAnnotation--mNxPj"};function es({annotation:e}){let t=(0,l.useRef)(null),{isInDialogMode:n}=(0,Y.q)();return(0,l.useEffect)(()=>{n?er(t.current):ei(t.current)},[n]),(0,i.jsx)("div",{id:`annotation_${e.databaseId}`,ref:t,className:(0,I.$)("mt-1 border rounded-2 color-border-default color-shadow-small overflow-hidden",ea.inlineAnnotation),"data-level":e.annotationLevel,"data-testid":`annotation-${e.id}`,children:(0,i.jsx)(el.Y,{annotation:e})})}try{es.displayName||(es.displayName="InlineAnnotation")}catch{}let eo={closeMarkersDialogButton:"InlineMarkers-module__closeMarkersDialogButton--H1wyh",markersWrapper:"InlineMarkers-module__markersWrapper--gRSoz",markersDialogActive:"InlineMarkers-module__markersDialogActive--j6cUe",markersDialogInactive:"InlineMarkers-module__markersDialogInactive--iCOj1"};var ed=n(12152),ec=n(80688),eu=n(67136),ef=n(70404),eh=n(52464),em=n(75177),ep=n(47139),eg=n(68593),ex=n(42522);let eb={inlineReviewThreadHeading:"InlineReviewThread-module__inlineReviewThreadHeading--CroDZ"};var ey=n(94493);function eC({children:e}){return(0,i.jsx)(eh.A,{sx:{fontWeight:500,color:"fg.default"},children:e})}function ev({thread:e}){return void 0!==e&&e?.diffSide&&e.line?e.startLine&&e.startDiffSide?ej({thread:e}):eN({thread:e}):null}function eN({thread:e}){let t="LEFT"===e.diffSide?"L":"R";return(0,i.jsxs)("h2",{className:eb.inlineReviewThreadHeading,children:["Comment on line"," ",(0,i.jsxs)(eC,{children:[t,e.line]})]})}function ej({thread:e}){let t="LEFT"===e.startDiffSide?"L":"R",n="LEFT"===e.diffSide?"L":"R";return(0,i.jsxs)("h2",{className:eb.inlineReviewThreadHeading,children:["Comment on lines"," ",(0,i.jsxs)(eC,{children:[t,e.startLine]})," ","to"," ",(0,i.jsxs)(eC,{children:[n,e.line]})]})}function ew(){return(0,i.jsx)("div",{className:"position-relative",children:(0,i.jsxs)(eg.A,{border:!0,children:[(0,i.jsx)(eg.A.Visual,{children:(0,i.jsx)(_.AlertIcon,{size:24,className:"fgColor-muted mt-3 mb-3"})}),(0,i.jsx)(eg.A.Heading,{children:(0,i.jsx)("strong",{children:"Comments cannot be loaded right now"})}),(0,i.jsx)("div",{className:"mb-n2",children:(0,i.jsx)(eg.A.Description,{children:"Refresh the page or try again later"})}),(0,i.jsx)(eg.A.SecondaryAction,{href:"https://www.githubstatus.com/",children:"GitHub status"})]})})}function eL({commentingImplementation:e,fileAnchor:t,filePath:n,threadId:r,isOutdated:a,threads:s,threadsConnectionId:o,isFirstThread:c,enterDialogMode:u,ghostUser:f,manuallyUpdateCommentsWithThisThreadId:h,suggestedChangesConfig:m,...p}){let[g,x]=(0,l.useState)(void 0),{fetchThread:b,shouldRefetchThread:y}=e,C=(0,l.useRef)(null),{isInDialogMode:v}=(0,Y.q)(),N=(0,ec.A)("localStorage"),j=g?.isResolved,[w,L]=(0,l.useState)(j??!1);(0,l.useEffect)(()=>{let e=localStorage.getItem(`reviewThreadIsCollapsed_${r}`);null!==e?L(JSON.parse(e)):j&&L(!0)},[j,r]);let S=(0,l.useCallback)(async(e,t=!0)=>{x(await b(e,t))},[b]);(0,l.useEffect)(()=>{S(r,!1)},[S,h,r]),(0,l.useEffect)(()=>{v&&(v||!g)?er(C.current):ei(C.current)},[v,g]),(0,l.useEffect)(()=>{g||S(r,!1)},[r,g,b,S]);let D=(0,l.useMemo)(()=>{if(t&&g&&g.subject?.startDiffSide&&g.subject?.endDiffSide&&g.subject?.startLine&&g.subject?.endLine&&m?.configureSuggestedChangesFromLineRange){let e=g.subject?.startLine??g?.subject?.endLine,n=g.subject?.startDiffSide??g?.subject?.endDiffSide,i={diffAnchor:t,endLineNumber:g?.subject?.endLine,endOrientation:g.subject?.endDiffSide==="LEFT"?"left":"right",startLineNumber:e,firstSelectedLineNumber:e,firstSelectedOrientation:"LEFT"===n?"left":"right",startOrientation:"LEFT"===n?"left":"right"};return m?.configureSuggestedChangesFromLineRange(i)}},[t,g,m]);(0,l.useEffect)(()=>{g&&y?.(g)&&S(r,!0)},[S,y,g,r,s]);let{sendAnalyticsEvent:I}=(0,ef.s)(),{resolveThread:k,unresolveThread:E,resolvingEnabled:R}=e,A=s.find(e=>e.id===r),{addToast:T}=(0,eu.Y6)();if(!g||!(g.commentsData.comments.length>0))return null;let O=!!g.isResolved,$=A?.commentsConnectionId,M=R&&g.commentsData.comments.some(e=>e.state?.toUpperCase()!=="PENDING");return(0,i.jsx)(ed.t,{fallback:(0,i.jsx)(ew,{}),children:(0,i.jsxs)("div",{className:"rounded-2 bgColor-default",ref:C,children:[(0,i.jsxs)(em.A,{sx:{display:"flex",flexDirection:"row",width:"100%",alignItems:"center",borderBottom:"1px solid",borderColor:"border.muted"},className:"px-1",children:[(0,i.jsx)(Q.K,{"aria-label":w?"Expand comment":"Collapse comment",icon:w?_.ChevronRightIcon:_.ChevronDownIcon,size:"small",variant:"invisible",onClick:()=>{window.requestAnimationFrame(()=>{N.setItem(`reviewThreadIsCollapsed_${r}`,JSON.stringify(!w))}),L(e=>!e)},"data-is-first-collapse-button":c}),(0,i.jsx)(ev,{thread:A}),(0,i.jsxs)(em.A,{sx:{display:"flex",flexDirection:"row",gap:1,alignItems:"center",justifyContent:"right",flexGrow:1},children:[O&&(0,i.jsx)(ep.A,{variant:"secondary",children:"Resolved"}),M&&(0,i.jsx)(ex.m,{text:O?"Unresolve conversation":"Resolve conversation",type:"label",direction:"w",id:"resolve-conversation",children:(0,i.jsx)(Q.K,{"aria-labelledby":"resolve-conversation",icon:O?_.CheckCircleFillIcon:_.CheckCircleIcon,sx:{color:O?"var(--fgColor-done, var(--color-done-fg)) !important":void 0},variant:"invisible",onClick:O?()=>{g&&(E({threadId:g.id,onCompleted:()=>{y||S(g.id),L(!1),N.removeItem(`reviewThreadIsCollapsed_${r}`)},onError:()=>{T({type:"error",message:"Failed to unresolve thread"})}}),I("comments.unresolve_thread","RESOLVE_CONVERSATION_BUTTON"))}:()=>{g&&(k({threadId:g.id,onCompleted:()=>{y||S(g.id),L(!0),N.removeItem(`reviewThreadIsCollapsed_${r}`)},onError:()=>{T({type:"error",message:"Failed to resolve thread"})}}),I("comments.resolve_thread","RESOLVE_CONVERSATION_BUTTON"))}})})]})]}),(0,i.jsx)(l.Suspense,{fallback:(0,i.jsxs)(em.A,{sx:{height:"90px",alignItems:"center",display:"flex",flexDirection:"column",justifyContent:"center",color:"fg.muted",fontSize:0},children:[(0,i.jsx)(d.A,{}),(0,i.jsx)("p",{children:"Loading comments"})]}),children:!w&&(0,i.jsx)(ey.H,{enterDialogMode:u,commentingImplementation:e,commentsConnectionId:$,filePath:n,onRefreshThread:S,thread:g,threadsConnectionId:o,suggestedChangesConfig:D,shouldLimitHeight:!1,...p,ghostUser:f})})]})})}try{eC.displayName||(eC.displayName="Emphasis")}catch{}try{ev.displayName||(ev.displayName="ThreadBanner")}catch{}try{eN.displayName||(eN.displayName="SingleLineThreadBanner")}catch{}try{ej.displayName||(ej.displayName="MultineLineThreadBanner")}catch{}try{ew.displayName||(ew.displayName="CommentErrorFallback")}catch{}try{eL.displayName||(eL.displayName="InlineReviewThread")}catch{}let eS={[et.U.Failure]:0,[et.U.Warning]:1,[et.U.Notice]:2};function eD(e){return(0,i.jsx)(ee.j,{children:(0,i.jsx)(eI,{...e})})}function eI({annotations:e,children:t,commentingImplementation:n,conversationListThreads:r,inlineMarkersRef:a,isMarkerListOpen:s,isRowSelected:o,fileAnchor:d,filePath:c,lineType:u,onAnnotationSelected:f,onCloseConversationDialog:h,onCloseConversationList:m,onCloseFocusMode:p,onThreadSelected:g,returnFocusRef:x,selectedAnnotationId:y,selectedThreadId:C,threadsConnectionId:v,suggestedChangesConfig:N,manuallyUpdateCommentsWithThisThreadId:j,ghostUser:w,enterDialogMode:L,...S}){let D=(0,l.useCallback)(async e=>{let t=await n.fetchThread(e,!1);t&&r.push(t),E({})},[n,r]),[k,E]=(0,l.useState)({});(0,l.useEffect)(()=>{0===r.length&&j&&""!==j&&D(j)},[n,r.length,D,j]);let{isInDialogMode:R,enableInlineCommentDialogMode:A}=(0,Y.q)(),T=(0,l.useMemo)(()=>[...e].sort((e,t)=>eS[e.annotationLevel]-eS[t.annotationLevel]),[e]);return(0,i.jsxs)("div",{className:(0,I.$)("d-flex pt-1",R?eo.markersDialogActive:eo.markersDialogInactive),style:R?{backgroundColor:(0,b.Yf)(u,!0,o)}:{},onClick:()=>{R||A()},"data-inline-markers":!0,ref:a,children:[(0,i.jsxs)("div",{className:eo.markersWrapper,children:[r.map((e,t)=>(0,i.jsx)("div",{className:(0,I.$)("mt-1 border rounded-2 color-border-default color-shadow-small",t===r.length-1?"mb-1":"mb-2"),children:(0,i.jsx)(eL,{manuallyUpdateCommentsWithThisThreadId:j,enterDialogMode:L,isFirstThread:0===t,commentingImplementation:n,filePath:c,fileAnchor:d,threadId:e.id,isOutdated:e.isOutdated,threads:r,threadsConnectionId:v,onThreadSelected:g,suggestedChangesConfig:N,ghostUser:w,...S})},`review-thread-${e.id}`)),t,T.map(e=>(0,i.jsx)(es,{annotation:e},`annotation-${e.id}`))]}),R&&(0,i.jsx)(Q.K,{icon:_.XIcon,className:(0,I.$)(eo.closeMarkersDialogButton,"ml-2 position-relative",0===r.length?"mt-2":"mt-1"),"aria-label":"Return to code","data-exit-dialog-mode-button":"true",variant:"default",size:"small",onMouseUp:p,onKeyDown:e=>{("Enter"===e.key||"Space"===e.code)&&p()}})]})}try{eD.displayName||(eD.displayName="InlineMarkers")}catch{}try{eI.displayName||(eI.displayName="InlineMarkersInternal")}catch{}var ek=n(84100),eE=n(86617),e_=n(89323),eR=n(8338),eA=n(76797);function eT({fileAnchor:e}){let{isSplit:t,isLeftSide:n,diffLine:i}=F(),{selectedDiffRowRange:r}=L(),{getUnifiedDiffLineCode:a,getSplitDiffSingleLineCode:s,getSplitDiffMultiLineCode:o}=function(e){let{selectedDiffRowRange:t,selectedDiffLines:n,getDiffLinesByDiffAnchor:i}=L();return{getUnifiedDiffLineCode:()=>{let n=i(e);if(!n||!t)return"";let{startOrientation:r,endOrientation:l,startLineNumber:a,endLineNumber:s}=t,o=0,d=0;return n.length>1&&(o=n.findIndex(e=>"left"===r?e.left===a:e.right===a),d=n.findIndex(e=>"left"===l?e.left===s:e.right===s)),(0,b.Ls)(n.slice(o,d+1))},getSplitDiffSingleLineCode:(t,n)=>{if(!t||!n)return"";let r=i(e)?.find(e=>"left"===t?e.left===n:e.right===n);return r?(0,b.Ls)([r]):""},getSplitDiffMultiLineCode:e=>void 0===e?"":"left"===e?(0,b.Ls)(n.leftLines):(0,b.Ls)(n.rightLines)}}(e);return(0,l.useCallback)(async()=>{let e=window.getSelection();return e&&""!==e.toString()?void document.execCommand("copy"):t?void(void 0===r||r?.startOrientation===r?.endOrientation&&r?.startLineNumber===r?.endLineNumber?await (0,eA.D)(s(n?"left":"right",n?i?.left:i?.right)):await (0,eA.D)(o(n?"left":"right"))):void await (0,eA.D)(a())},[t,n,i?.left,i?.right,r,s,o,a])}let eO=(0,l.createContext)(null);function e$({children:e,...t}){let n=!!t.commentingImplementation,r=!!t.markerNavigationImplementation;if(t.commentingEnabled!==n&&t.commentingEnabled!==r)throw Error("commentingEnabled, commentingImplementation, and markerNavigationImplementation must be passed together");let a=t?.ghostUser??W.ghostUser,s=(0,l.useMemo)(()=>({ghostUser:a,...t}),[...Object.values(t),a]);return(0,i.jsx)(eO.Provider,{value:s,children:e})}function eM(){let e=(0,l.useContext)(eO);if(!e)throw Error("useDiffContext must be used within a DiffContextProvider");return e}try{eO.displayName||(eO.displayName="DiffContext")}catch{}try{e$.displayName||(e$.displayName="DiffContextProvider")}catch{}var eP=n(57259);function eF(e){return null!=e}let eU="thread",eH="annotation",eB=(0,l.createContext)(null);function ez({children:e,line:t}){let[n,r]=(0,l.useState)(!1),[a,s]=(0,l.useState)(),[o,d]=(0,l.useState)(),[c,u]=(0,l.useState)(),[f,h]=(0,l.useState)(),[m,p]=(0,l.useState)(),{ghostUser:g,markerNavigationImplementation:x}=eM(),{originalLineThreads:b,modifiedLineThreads:y}=F(),[C,v]=(0,l.useState)(),N=eV({line:t,side:C,originalLineThreads:b,modifiedLineThreads:y,ghostUser:g}),j=(0,l.useMemo)(()=>!!a||!!o||!!c||!!f,[a,c,o,f]),w=(0,l.useCallback)(()=>{r(!0)},[]),L=(0,l.useCallback)(()=>{r(!1)},[]),S=(0,l.useCallback)(e=>{e?p({id:e,kind:eU}):p(void 0)},[]),D=m?.kind===eU?m.id:void 0,I=m?.kind===eH?m.id:void 0,k=(0,l.useCallback)(e=>{e?p({id:e,kind:eH}):p(void 0)},[]),E=(0,l.useCallback)((e,t,n)=>{switch((0,eP.e)(x?.overlayPortalContainerName),e){case"context-menu":s(t),h(void 0),u(void 0),d(void 0);break;case"new-conversation":h({cellId:t,withSuggestedChange:n?.withSuggestedChange}),s(void 0),u(void 0),d(void 0);break;case"marker-details":u(t),s(void 0),d(void 0),h(void 0);break;case"marker-list":d(t),s(void 0),h(void 0),u(void 0)}},[x?.overlayPortalContainerName]),_=(0,l.useCallback)(e=>{switch(e){case"context-menu":s(void 0);break;case"new-conversation":h(void 0);break;case"marker-details":u(void 0);break;case"marker-list":d(void 0)}},[]),R=(0,l.useCallback)(e=>(v(e),eV({line:t,side:e,modifiedLineThreads:y,originalLineThreads:b,ghostUser:g})),[t,y,b,g]),A=(0,l.useMemo)(()=>t.annotationsData?.annotations?.filter(eF)??[],[t.annotationsData?.annotations]),T=(0,l.useMemo)(()=>({annotations:A,isActionBarVisible:n,showActionBar:w,hideActionBar:L,selectThreadId:S,selectAnnotationId:k,closeDialog:_,openDialog:E,anyMenuOpen:j,selectedThreadId:D,selectedAnnotationId:I,openContextMenuCell:a,openMarkersListCell:o,openMarkerDetailsCell:c,openNewConversationCell:f,threads:N,updateVisibleThreads:R}),[A,n,w,L,S,k,_,E,j,D,I,a,o,c,f,N,R]);return(0,i.jsx)(eB.Provider,{value:T,children:e})}function eG(){let e=(0,l.useContext)(eB);if(!e)throw Error("useMarkersDialogContext must be used within a MarkersDialogContextProvider");return e}function eV({line:e,side:t,originalLineThreads:n,modifiedLineThreads:i,ghostUser:r}){switch(t){case"LEFT":return n||[];case"RIGHT":return i||[];case void 0:return U(e.threadsData,r);default:return[]}}try{eB.displayName||(eB.displayName="MarkersDialogContext")}catch{}try{ez.displayName||(ez.displayName="MarkersDialogContextProvider")}catch{}var eq=n(46584);function eW(){let{diff_inline_comments:e,prx_files:t}=(0,eq.h)();return e||t}function eK({cellId:e,actionBarRef:t,toggleViewingMarkers:n,onOpenInLineThread:i}){let{replaceSelectedDiffRowRange:r}=L(),{fileAnchor:a}=F(),s=eW(),[o,d]=(0,l.useState)(t),{annotations:c,openDialog:u,closeDialog:f,selectedAnnotationId:h,selectAnnotationId:m,selectedThreadId:p,selectThreadId:g,openContextMenuCell:x,openNewConversationCell:b,openMarkerDetailsCell:y,openMarkersListCell:C,updateVisibleThreads:v,threads:j,anyMenuOpen:w}=eG(),{sendAnalyticsEvent:S}=(0,ef.s)(),D=(0,l.useMemo)(()=>b?.cellId===e,[e,b]),I=(0,l.useMemo)(()=>b?.withSuggestedChange,[b]),k=(0,l.useCallback)(t=>{s&&i?.(),u("new-conversation",e,t)},[e,s,i,u]),E=(0,l.useCallback)(()=>{k()},[k]),_=(0,l.useCallback)(()=>{d(t),k(),S("diff.start_new_conversation","PLUS_ICON")},[t,k,S]),R=(0,l.useCallback)(()=>{k({withSuggestedChange:!0}),S("diff.start_new_conversation_with_suggested_change","CELL_CONTEXT_MENU")},[k,S]),A=(0,l.useCallback)(()=>{d(t),k({withSuggestedChange:!0}),S("diff.start_new_conversation_with_suggested_change","ACTION_BAR_CONTEXT_MENU")},[t,k,S]),T=(0,l.useCallback)(()=>{f("new-conversation")},[f]),O=(0,l.useMemo)(()=>x===e,[e,x]),$=(0,l.useCallback)(()=>{u("context-menu",e)},[e,u]),M=(0,l.useCallback)(()=>{d(t),$()},[t,$]),P=(0,l.useCallback)(()=>{f("context-menu")},[f]),U=(0,l.useCallback)(()=>{O?P():$()},[P,O,$]),H=(0,l.useCallback)(()=>{d(t),U()},[t,U]),B=(0,l.useMemo)(()=>y===e?p:void 0,[e,y,p]),z=(0,l.useMemo)(()=>y===e?h:void 0,[e,y,h]),G=(0,l.useCallback)(()=>{s?i?.():u("marker-details",e)},[e,s,i,u]),V=(0,l.useCallback)(()=>{f("marker-details")},[f]),q=N((e,t={skipLineSelection:!1})=>{if(g(e),G(),t.skipLineSelection)return;let n=j.find(t=>t.id===e);if(n&&n.diffSide&&n.line){let e=n.startLine??n.line,t=n.startDiffSide??n.diffSide;r({diffAnchor:a,endLineNumber:n.line,endOrientation:"LEFT"===n.diffSide?"left":"right",startLineNumber:e,startOrientation:"LEFT"===t?"left":"right",firstSelectedLineNumber:e,firstSelectedOrientation:"LEFT"===t?"left":"right"})}}),W=N((e,t={skipLineSelection:!1})=>{if(m(e),G(),t.skipLineSelection)return;let n=c.find(t=>t.id===e);n&&r({diffAnchor:a,endLineNumber:n.endLine,endOrientation:"right",startLineNumber:n.startLine,startOrientation:"right",firstSelectedLineNumber:n.startLine,firstSelectedOrientation:"right"})}),K=(0,l.useCallback)(()=>{u("marker-list",e)},[e,u]),X=(0,l.useCallback)(()=>{f("marker-list")},[f]),J=(0,l.useCallback)(e=>{if(s)return void n?.();let t=v(e);if(!t?.length&&!c.length)return;let i=t&&t[0],r=t&&1===t.length&&i&&!c.length,l=c[0],a=1===c.length&&l&&!t?.length;r?q(i.id):a?W(l.id):K()},[c,s,K,W,q,n,v]);return{isNewConversationDialogOpen:D,startNewConversation:E,startNewConversationFromActionBar:_,closeNewConversationDialog:T,startNewConversationWithSuggestedChange:R,startNewConversationFromActionBarWithSuggestedChange:A,shouldStartNewConversationWithSuggestedChange:I,isContextMenuOpen:O,openContextMenu:$,openContextMenuFromActionBar:M,closeContextMenu:P,toggleContextMenu:U,toggleContextMenuFromActionBar:H,optimizedSelectedThreadId:B,optimizedSelectedAnnotationId:z,selectThread:q,selectAnnotation:W,openMarkerDetailsDialog:G,closeConversationDetailsDialog:V,isMarkerListDialogOpen:C===e,openMarkerListDialog:K,closeMarkerListDialog:X,openMarkerOrListDialogFromActionBar:(0,l.useCallback)(e=>{J(e),d(t)},[t,J]),openMarkerOrListDialog:(0,l.useCallback)(e=>{J(e)},[J]),annotations:c,returnFocusRef:o,threads:j,anyMenuOpen:w}}function eX({cellRef:e}){let{showActionBar:t,hideActionBar:n,anyMenuOpen:i}=eG(),[r,a]=(0,l.useState)(!1),s=(0,l.useCallback)(()=>{t()},[t]),o=(0,l.useCallback)(t=>{!i&&(e.current&&e.current.contains(t.relatedTarget)||n())},[i,e,n]),d=(0,l.useCallback)(()=>{t()},[t]),c=(0,l.useCallback)(()=>{!i&&(e.current===document.activeElement||e.current?.contains(document.activeElement)||n())},[i,e,n]),u=(0,l.useCallback)(t=>{e.current&&(i||(e.current.contains(t.relatedTarget)?e.current===t.relatedTarget&&a(!1):(n(),a(!1))))},[i,e,n]);return{isActionBarFocused:r,handleCellBlur:o,handleCellFocus:s,handleCellMouseEnter:d,handleCellMouseLeave:c,handleActionBarBlur:u,handleActionBarFocusCapture:(0,l.useCallback)(e=>{i||(e.stopPropagation(),a(!0))},[i]),handleActionBarKeydownCapture:(0,l.useCallback)(e=>{!i&&K(e.key)&&e.stopPropagation()},[i])}}n(70283);var eJ=n(64515),eY=n(91321),eZ=n(62456),eQ=n(46008),e0=n(82126);let e1={commentIndicatorContainer:"CommentIndicator-module__commentIndicatorContainer--L8lU3",AvatarStack:"CommentIndicator-module__AvatarStack--jMN2F",Compact:"CommentIndicator-module__Compact--SQwGN",Relaxed:"CommentIndicator-module__Relaxed--DWkA5",textStyles:"CommentIndicator-module__textStyles--ahQJa"},e2={compact:{avatarSize:18},relaxed:{avatarSize:20}};function e3({shouldAnimateRef:e,lineSpacingPreference:t="relaxed"}){let{diffLine:n}=F(),{ghostUser:r}=eM();(0,l.useEffect)(()=>{e?.current&&(e.current=!1)},[e]);let{avatarSize:a}=e2[t],s=(n.threadsData?.totalCommentsCount||0)+(n.annotationsData?.totalCount||0);if(0===s)return null;let o={},d=[];n.annotationsData?.annotations?.map(e=>{e?.annotationLevel&&d.push({id:e.id,level:e.annotationLevel})}),n.threadsData?.threads?.map(e=>e?.commentsData?.comments?.map(e=>{e?.author?o[e?.author.login]=e.author:r?.login&&(o[r.login]=r)}));let c=[...d.sort((e,t)=>(e0.GF[e.level]?.priority||0)<(e0.GF[t.level]?.priority||0)?-1:1).map(t=>e?.current?(0,i.jsx)(e0.S,{annotationLevel:t.level},t.id):(0,i.jsx)(e0.Xh,{annotationLevel:t.level},t.id)),...Object.keys(o).map(e=>{let t=o[e]?.login,n=o[e]?.avatarUrl??(r?.avatarUrl||" ");return(0,i.jsx)(eZ.r,{alt:t,size:20,src:n},t)})].slice(0,3),u=s>9?"9+":`${s}`;return(0,i.jsxs)("div",{className:(0,I.$)("d-flex","flex-justify-between","flex-items-center",e1.commentIndicatorContainer),children:[(0,i.jsx)(eQ.A,{disableExpand:!0,size:a,className:(0,I.$)(e1.AvatarStack,"relaxed"===t?e1.Relaxed:e1.Compact),children:c}),(0,i.jsx)("span",{className:(0,I.$)("fgColor-default","ml-1",e1.textStyles),children:u})]})}try{e3.displayName||(e3.displayName="CommentIndicator")}catch{}var e4=n(35149),e6=n(39298),e8=n(5993);let e7=({fileDiffReference:e,selectedRange:t,showDivider:n})=>{let r=(0,l.useMemo)(()=>{let n={...e};return t&&(n.selectedRange={start:`${t?.startOrientation[0]?.toUpperCase()??""}${t?.startLineNumber}`,end:`${t?.endOrientation[0]?.toUpperCase()??""}${t?.endLineNumber}`}),n},[e,t]);return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(e_.W,{children:[(0,i.jsx)(e_.W.Anchor,{children:(0,i.jsxs)(eR.l.Item,{children:[(0,i.jsx)(eR.l.LeadingVisual,{children:(0,i.jsx)(_.CopilotIcon,{})}),"Copilot"]})}),(0,i.jsx)(e_.W.Overlay,{children:(0,i.jsxs)(eR.l,{children:[(0,i.jsx)(e6.t,{fileDiffReference:r,eventContext:{prx:!0}}),(0,i.jsx)(e8.e,{fileDiffReference:r,eventContext:{prx:!0}}),(0,i.jsx)(e4.i,{fileDiffReference:r,eventContext:{prx:!0}})]})})]}),n&&(0,i.jsx)(eR.l.Divider,{})]})};try{e7.displayName||(e7.displayName="CopilotDiffChatContextMenu")}catch{}var e9=n(11499);function e5(){let{nextHunk:e,currentHunk:t,previousHunk:n}=F(),{addInjectedContextLines:i}=eM();return te(i,e,t,n)}function te(e,t,n,i){let r=!!n&&0!==n.startBlobLineNumber,l=!!n&&!!t;return{expandStartOfHunk:()=>{r&&n&&e({start:Math.max(0,n.startBlobLineNumber-20),end:n.startBlobLineNumber})},expandEndOfHunk:()=>{l&&n&&e({start:n.endBlobLineNumber+1,end:n.endBlobLineNumber+1+20})},expandEndOfPreviousHunk:()=>{i&&e({start:i.endBlobLineNumber+1,end:i.endBlobLineNumber+1+20})},canExpandEndOfHunk:l,canExpandStartOfHunk:r}}var tt=n(96339);let tn={left:"L",right:"R"},ti="Add comment",tr="Suggest change";function tl(e,t,n){let i=n&&!(0,b.Ji)(t)?tn.left:tn.right;return`${e} on line ${i}${t.blobLineNumber}`}function ta({handleStartConversationWithSuggestedChange:e,handleStartConversation:t}){let n,r,a,{selectedDiffRowRange:s,selectedDiffLines:o,replaceSelectedDiffRowRange:d}=L(),{commentingEnabled:c}=eM(),{diffLine:u,isLeftSide:f,isSplit:h,diffContext:m}=F(),p=(0,l.useMemo)(()=>o.leftLines[0],[o.leftLines]),g=(0,l.useMemo)(()=>o.leftLines[o.leftLines.length-1],[o.leftLines]),x=(0,l.useMemo)(()=>o.leftLines.every(e=>!(0,b.Po)(e)&&"DELETION"!==e.type),[o.leftLines]),y=(0,l.useMemo)(()=>o.rightLines[0],[o.rightLines]),C=(0,l.useMemo)(()=>o.rightLines[o.rightLines.length-1],[o.rightLines]),v=(0,l.useMemo)(()=>0===o.rightLines.length,[o.rightLines]),N=(0,l.useMemo)(()=>0===o.leftLines.length,[o.leftLines]),j=(0,l.useMemo)(()=>!(o.leftLines.find(e=>!(0,b.Po)(e)&&!(0,b.Ji)(e)&&"INJECTED_CONTEXT"!==e.type)||o.rightLines.find(e=>!(0,b.Po)(e)&&!(0,b.Ji)(e)&&"INJECTED_CONTEXT"!==e.type)),[o.leftLines,o.rightLines]),w=(0,l.useCallback)((n,i)=>{!(!s||!g||!p||(0,b.Po)(g)||(0,b.Po)(p))&&p.left&&g.left&&(d({diffAnchor:s.diffAnchor,endLineNumber:g.left,endOrientation:"left",startLineNumber:p.left,startOrientation:"left",firstSelectedLineNumber:p.left,firstSelectedOrientation:"left"}),i?.withSuggestedChange?e():t())},[s,g,p,d,e,t]),S=(0,l.useCallback)((n,i)=>{!(!s||!C||!y||(0,b.Po)(C)||(0,b.Po)(y))&&y.right&&C.right&&(d({diffAnchor:s.diffAnchor,endLineNumber:C.right,endOrientation:"right",startLineNumber:y.right,startOrientation:"right",firstSelectedLineNumber:y.right,firstSelectedOrientation:"right"}),i?.withSuggestedChange?e():t())},[s,C,y,d,e,t]),D="DELETION"!==u.type&&("pr"===m||void 0===m),I=(0,l.useMemo)(()=>!!s&&(s.startOrientation!==s.endOrientation||s.startLineNumber!==s.endLineNumber),[s]);if(!c)return null;let k=!1,E=!1;if(s&&I){let l=tn[s.startOrientation],o=tn[s.endOrientation];return a=` on lines ${l}${s.startLineNumber}-${o}${s.endLineNumber}`,!(0,b.Po)(p)&&!(0,b.Po)(g)&&p&&g&&(k=!0,n=p.left===g.left?v?` on line L${p.left}`:`, original line L${p.left}`:v?` on lines L${p.left}-L${g.right}`:`, original lines L${p.left}-L${g.left}`),!(0,b.Po)(y)&&!(0,b.Po)(C)&&y&&C&&(E=!0,r=y.right===C.right?N||h&&j?` on line R${y.right}`:`, modified line R${C.right}`:N||h&&j?` on lines R${y.right}-R${C.right}`:`, modified lines R${y.right}-R${C.right}`),(0,i.jsx)(i.Fragment,{children:h?(0,i.jsx)(i.Fragment,{children:j?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(eR.l.Item,{onSelect:S,children:[(0,i.jsx)(eR.l.LeadingVisual,{children:(0,i.jsx)(_.PlusIcon,{})}),ti+r,(0,i.jsx)(eR.l.TrailingVisual,{children:(0,i.jsx)(tt.U,{keys:"Alt+n"})})]}),(0,i.jsxs)(eR.l.Item,{onSelect:e=>S(e,{withSuggestedChange:!0}),children:[(0,i.jsx)(eR.l.LeadingVisual,{children:(0,i.jsx)(_.PlusCircleIcon,{})}),tr+r]})]}):(0,i.jsxs)(i.Fragment,{children:[k?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(eR.l.Item,{onSelect:w,children:[(0,i.jsx)(eR.l.LeadingVisual,{children:(0,i.jsx)(_.PlusIcon,{})}),ti+n,(0,i.jsx)(eR.l.TrailingVisual,{children:(0,i.jsx)(tt.U,{keys:v?"Alt+n":"Alt+Shift+N"})})]}),x&&(0,i.jsxs)(eR.l.Item,{onSelect:e=>w(e,{withSuggestedChange:!0}),children:[(0,i.jsx)(eR.l.LeadingVisual,{children:(0,i.jsx)(_.PlusCircleIcon,{})}),tr+n]})]}):null,E?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(eR.l.Item,{onSelect:S,children:[(0,i.jsx)(eR.l.LeadingVisual,{children:(0,i.jsx)(_.PlusIcon,{})}),ti+r,(0,i.jsx)(eR.l.TrailingVisual,{children:(0,i.jsx)(tt.U,{keys:"Alt+n"})})]}),(0,i.jsxs)(eR.l.Item,{onSelect:e=>S(e,{withSuggestedChange:!0}),children:[(0,i.jsx)(eR.l.LeadingVisual,{children:(0,i.jsx)(_.PlusCircleIcon,{})}),tr+r]})]}):null]})}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(eR.l.Item,{onSelect:t,children:[(0,i.jsx)(eR.l.LeadingVisual,{children:(0,i.jsx)(_.PlusIcon,{})}),ti+a]}),D&&x&&(0,i.jsxs)(eR.l.Item,{onSelect:e,children:[(0,i.jsx)(eR.l.LeadingVisual,{children:(0,i.jsx)(_.PlusCircleIcon,{})}),tr+a]})]})})}return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsxs)(eR.l.Item,{onSelect:t,children:[(0,i.jsx)(eR.l.LeadingVisual,{children:(0,i.jsx)(_.PlusIcon,{})}),tl(ti,u,f)]}),D&&(0,i.jsxs)(eR.l.Item,{onSelect:e,children:[(0,i.jsx)(eR.l.LeadingVisual,{children:(0,i.jsx)(_.PlusCircleIcon,{})}),tl(tr,u,f)]})]})}try{ta.displayName||(ta.displayName="StartConversationContextMenuItems")}catch{}function ts(e){return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(tf,{...e}),(0,i.jsx)(tc,{fileDiffReference:e.copilotChatReference}),(0,i.jsx)(tx,{handleCopyCode:e.handleCopyCode}),(0,i.jsx)(tu,{}),(0,i.jsx)(to,{}),(0,i.jsx)(tb,{})]})}function to(){let{diffLine:e,fileAnchor:t}=F(),{selectedDiffRowRange:n}=L(),r=(0,l.useCallback)(()=>{let i=(0,b.j2)({line:e,range:n,fileAnchor:t});i&&(0,eA.D)(i)},[t,e,n]);return(0,i.jsxs)(eR.l.Item,{onSelect:r,onMouseDown:e=>{window.getSelection()?.toString()!==""&&e.preventDefault()},children:[(0,i.jsx)(eR.l.LeadingVisual,{children:(0,i.jsx)(_.LinkIcon,{})}),"Copy link",(0,i.jsx)(eR.l.TrailingVisual,{children:(0,i.jsx)(tt.U,{keys:"Mod+Alt+y"})})]})}function td(){return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(ty,{}),(0,i.jsx)(tu,{})]})}let tc=e=>{let{selectedDiffRowRange:t}=L(),{diffLine:n,isLeftSide:r,fileAnchor:l}=F(),a=(0,b.Av)(t,n,r,l);return e.fileDiffReference?(0,i.jsx)(e7,{showDivider:!0,selectedRange:a,fileDiffReference:e.fileDiffReference}):null};function tu(){let{fileAnchor:e}=F();return(0,i.jsxs)(eR.l.Item,{onSelect:()=>{setTimeout(()=>{document.querySelector(`table[data-diff-anchor="${e}"]`)?.dispatchEvent(new KeyboardEvent("keydown",{key:"a",code:"KeyA",ctrlKey:!0}))})},children:[(0,i.jsx)(eR.l.LeadingVisual,{children:(0,i.jsx)(_.MultiSelectIcon,{})}),"Select all",(0,i.jsx)(eR.l.TrailingVisual,{children:(0,i.jsx)(tt.U,{keys:"Mod+a"})})]})}function tf({handleViewMarkersSelection:e,shouldDisplayCollapseComments:t,showStartConversation:n,startConversationCurrentLine:r,startConversationWithSuggestedChange:l}){let{commentingEnabled:a}=eM(),{originalLineHasThreads:s,modifiedLineHasThreads:o}=F(),{annotations:d}=eG(),c=d.length>0;return a&&(n||s||o||c)?(0,i.jsxs)(i.Fragment,{children:[n&&(0,i.jsx)(ta,{handleStartConversation:r,handleStartConversationWithSuggestedChange:l}),(0,i.jsx)(th,{handleViewMarkersSelection:e,shouldDisplayCollapseComments:t}),(0,i.jsx)(eR.l.Divider,{})]}):null}function th({handleViewMarkersSelection:e,shouldDisplayCollapseComments:t}){let n=eW(),{data:r}=(0,eE.Pe)(),{commentingEnabled:l}=eM(),{isSplit:a}=F();return r&&l&&(!n||r.commentsPreference!==eE.sI.Visible)?a?(0,i.jsx)(tm,{handleViewMarkersSelection:e,shouldDisplayCollapseComments:t}):(0,i.jsx)(tp,{onSelect:()=>e(),shouldDisplayCollapseComments:t}):null}function tm({handleViewMarkersSelection:e,shouldDisplayCollapseComments:t}){let{originalLineHasThreads:n,modifiedLineHasThreads:r,isLeftSide:l}=F(),{annotations:a}=eG(),s=a.length>0;return l?(0,i.jsxs)(i.Fragment,{children:[n&&(0,i.jsx)(tg,{text:t?"Collapse comments":"Expand comments",onSelect:()=>e("LEFT")}),(r||s)&&(0,i.jsx)(tg,{text:t?"Collapse comments, modified line":"Expand comments, modified line",onSelect:()=>e("RIGHT")})]}):(0,i.jsxs)(i.Fragment,{children:[(r||s)&&(0,i.jsx)(tg,{text:t?"Collapse comments":"Expand comments",onSelect:()=>e("RIGHT")}),n&&(0,i.jsx)(tg,{text:t?"Collapse comments, original line":"Expand comments, original line",onSelect:()=>e("LEFT")})]})}function tp({onSelect:e,shouldDisplayCollapseComments:t}){let{ghostUser:n}=eM(),{diffLine:r}=F(),{annotations:l}=eG();return r&&U(r.threadsData,n).length>0||l.length>0?(0,i.jsx)(tg,{text:t?"Collapse comments":"Expand comments",onSelect:()=>e()}):null}function tg({onSelect:e,text:t}){return(0,i.jsxs)(eR.l.Item,{onSelect:e,children:[(0,i.jsx)(eR.l.LeadingVisual,{children:(0,i.jsx)(_.CommentDiscussionIcon,{})}),t]})}function tx({handleCopyCode:e}){return(0,i.jsxs)(eR.l.Item,{onSelect:e,onMouseDown:e=>{window.getSelection()?.toString()!==""&&e.preventDefault()},children:[(0,i.jsx)(eR.l.LeadingVisual,{children:(0,i.jsx)(_.CopyIcon,{})}),"Copy",(0,i.jsx)(eR.l.TrailingVisual,{children:(0,i.jsx)(tt.U,{keys:"Mod+c"})})]})}function tb(){let{canExpandStartOfHunk:e,canExpandEndOfHunk:t}=e5(),{previousHunk:n,nextHunk:r}=F();return e||t||n||r?(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(eR.l.Divider,{}),(0,i.jsx)(ty,{}),(0,i.jsx)(tC,{})]}):null}function ty(){let{canExpandStartOfHunk:e,canExpandEndOfHunk:t}=e5();return(0,i.jsxs)(i.Fragment,{children:[e&&(0,i.jsx)(e9.Vr,{commandId:"pull-requests-diff-view:expand-hunk-up",leadingVisual:(0,i.jsx)(_.FoldUpIcon,{})}),t&&(0,i.jsx)(e9.Vr,{commandId:"pull-requests-diff-view:expand-hunk-down",leadingVisual:(0,i.jsx)(_.FoldDownIcon,{})})]})}function tC(){let{previousHunk:e,nextHunk:t}=F(),{fileAnchor:n}=F();return(0,i.jsxs)(i.Fragment,{children:[t?(0,i.jsxs)(eR.l.Item,{"aria-keyshortcuts":"PageDown",onSelect:()=>{setTimeout(()=>{document.querySelector(`table[data-diff-anchor="${n}"]`)?.dispatchEvent(new KeyboardEvent("keydown",{key:"PageDown"}))})},children:[(0,i.jsx)(eR.l.LeadingVisual,{children:(0,i.jsx)(_.MoveToBottomIcon,{})}),"Go to next hunk",(0,i.jsx)(eR.l.TrailingVisual,{children:"Page Down"})]}):null,e?(0,i.jsxs)(eR.l.Item,{"aria-keyshortcuts":"PageUp",onSelect:()=>{setTimeout(()=>{document.querySelector(`table[data-diff-anchor="${n}"]`)?.dispatchEvent(new KeyboardEvent("keydown",{key:"PageUp"}))})},children:[(0,i.jsx)(eR.l.LeadingVisual,{children:(0,i.jsx)(_.MoveToTopIcon,{})}),"Go to previous hunk",(0,i.jsx)(eR.l.TrailingVisual,{children:"Page Up"})]}):null]})}try{ts.displayName||(ts.displayName="CellContextMenu")}catch{}try{to.displayName||(to.displayName="CopyAnchorLink")}catch{}try{td.displayName||(td.displayName="EmptyCellContextMenu")}catch{}try{tu.displayName||(tu.displayName="SelectAllListItem")}catch{}try{tf.displayName||(tf.displayName="MarkerListItems")}catch{}try{th.displayName||(th.displayName="ViewMarkerListItems")}catch{}try{tm.displayName||(tm.displayName="SplitDiffMarkersListItems")}catch{}try{tp.displayName||(tp.displayName="UnifiedDiffMarkerListItem")}catch{}try{tg.displayName||(tg.displayName="MarkerListItem")}catch{}try{tx.displayName||(tx.displayName="CopyContentListItems")}catch{}try{tb.displayName||(tb.displayName="HunkListItems")}catch{}try{ty.displayName||(ty.displayName="ExpandHunksListItems")}catch{}try{tC.displayName||(tC.displayName="JumpToHunkListItems")}catch{}var tv=n(30729);function tN({iconColor:e,icon:t,size:n=12,backgroundColor:r="fg.onEmphasis",absolute:l=!0,backgroundSx:a}){let s,o;return 12===n?(s="10px",o="1px"):20===n?(s="16px",o="2px"):(s="16px",o="4px"),(0,i.jsxs)(em.A,{sx:{display:"flex",borderRadius:"100px",...l?{position:"absolute",bottom:-1,right:-1,boxShadow:"0 0 0 2px var(--bgColor-default, var(--color-canvas-default))",backgroundColor:"var(--bgColor-default, var(--color-canvas-default))"}:{position:"relative"},...a},children:[(0,i.jsx)(em.A,{sx:{display:"flex",position:"absolute",borderRadius:"100px",width:s,height:s,left:o,top:o,backgroundColor:r}}),(0,i.jsx)(tv.A,{icon:t,size:n,sx:{color:e,position:"relative"}})]})}try{tN.displayName||(tN.displayName="StatusIcon")}catch{}function tj({zIndex:e,altText:t,hovercardUrl:n,src:r,square:l,icon:a,iconColor:s,backgroundColor:o,backgroundSx:d,sx:c,size:u=20}){return(0,i.jsxs)(em.A,{sx:{position:"relative",display:"flex",gap:2,alignItems:"center",...e,...c},children:[(0,i.jsx)(eZ.r,{alt:t,"data-hovercard-url":n,size:u,square:l,src:r}),(0,i.jsx)(tN,{icon:a,iconColor:s,size:12,backgroundColor:o,backgroundSx:d})]})}try{tj.displayName||(tj.displayName="StatusAvatar")}catch{}function tw({authorAvatarUrl:e,authorLogin:t,lineSpacingPreference:n,sx:r}){return(0,i.jsx)(tj,{altText:`${t}'s avatar image with pending indicator`,icon:_.DotFillIcon,iconColor:"var(--fgColor-attention, var(--color-attention-fg))",square:!1,size:"compact"===n?18:20,src:e,backgroundSx:{backgroundColor:"var(--bgColor-default, var(--color-canvas-default))",boxShadow:"0 0 0 .1px var(--bgColor-default, var(--color-canvas-default))"},sx:{alignItems:"center",display:"flex",height:"var(--diff-line-minimum-height)",...r}})}try{tw.displayName||(tw.displayName="InProgressCommentIndicator")}catch{}let tL={"action-bar-position":"ActionBar-module__action-bar-position--q5zYS","left-action-bar":"ActionBar-module__left-action-bar--EJ7Y6","left-action-bar-draft-compact":"ActionBar-module__left-action-bar-draft-compact--BA7vx","left-action-bar-draft-relaxed":"ActionBar-module__left-action-bar-draft-relaxed--yz9iI","left-action-bar-new":"ActionBar-module__left-action-bar-new--NXupU",actionBarArrowSizing:"ActionBar-module__actionBarArrowSizing--VJyrJ",actionBarHeight:"ActionBar-module__actionBarHeight--BT8aR",actionBarStartCommentWidth:"ActionBar-module__actionBarStartCommentWidth--NZ_pB","action-bar-button-group":"ActionBar-module__action-bar-button-group--eolOy"},tS=(0,l.forwardRef)(function({authorAvatarUrl:e,authorLogin:t,cellId:n,cellRef:r,showStartConversation:a,hasDraftComment:s,copilotChatReference:o,handleCopyCode:d,onOpenInLineThread:c,onStartConversation:u,shouldDisplayCollapseComments:f,toggleViewingMarkers:h},m){let p=(0,l.useRef)(null),g=(0,l.useRef)(null),{commentingEnabled:x,viewerData:{lineSpacingPreference:b,commentsPreference:y}}=eM(),{diffLine:C,isRowSelected:v}=F(),N=(0,l.useRef)(null),j=p.current?p:g;(0,eJ.T)(m,j);let w=eW(),L=C.threadsData?.totalCommentsCount||0,S=C.annotationsData?.totalCount||0,{isActionBarFocused:D,handleActionBarBlur:E,handleActionBarFocusCapture:R,handleActionBarKeydownCapture:A}=eX({cellRef:r}),{annotations:T,isContextMenuOpen:O,openMarkerOrListDialogFromActionBar:$,startNewConversationFromActionBar:M,startNewConversationFromActionBarWithSuggestedChange:P,anyMenuOpen:U,threads:H,toggleContextMenu:B,toggleContextMenuFromActionBar:z}=eK({cellId:n,actionBarRef:N,onOpenInLineThread:c,toggleViewingMarkers:h}),G=(0,l.useCallback)(e=>{v&&e.preventDefault()},[v]),V=x&&L+S>0&&(!w||y===eE.sI.Collapsed),q=x&&a,W={onBlur:E,onFocusCapture:R,onKeyDownCapture:A},K=(0,l.useCallback)(e=>{u?.(),M(),G(e)},[u,M,G]);return(0,i.jsxs)(i.Fragment,{children:[q&&(0,i.jsx)("div",{"aria-hidden":!D,className:(0,I.$)("d-flex","flex-row",tL["left-action-bar"]),children:(0,i.jsx)(i.Fragment,{children:s?(0,i.jsx)(k.Q,{"aria-label":"Continue comment in progress",size:"small",className:(0,I.$)("py-0","compact"===b?tL["left-action-bar-draft-compact"]:tL["left-action-bar-draft-relaxed"],tL.actionBarHeight),onClick:K,...W,children:(0,i.jsx)(tw,{lineSpacingPreference:b,authorAvatarUrl:e,authorLogin:t})}):(0,i.jsx)(Q.K,{unsafeDisableTooltip:!0,"aria-label":"Add comment",ref:g,icon:_.PlusIcon,size:"small",className:(0,I.$)("fgColor-muted","bgColor-accent-emphasis","fgColor-onEmphasis","px-0",tL["left-action-bar-new"],tL.actionBarHeight,tL.actionBarStartCommentWidth),onClick:K,...W})})}),(0,i.jsx)("div",{"aria-hidden":!D,className:(0,I.$)("d-flex","flex-row",tL["action-bar-position"]),children:(0,i.jsxs)(eY.A,{onClick:G,className:tL["action-bar-button-group"],...W,children:[V&&(0,i.jsx)(k.Q,{ref:p,"aria-expanded":U,"aria-label":"View comments",size:"small",className:(0,I.$)("py-0","px-1",tL.actionBarHeight),onClick:e=>{(1===H.length||1===T.length)&&e.preventDefault(),$()},children:(0,i.jsx)(e3,{lineSpacingPreference:b})}),(0,i.jsxs)(e_.W,{anchorRef:N,open:O,onOpenChange:B,children:[(0,i.jsx)(e_.W.Anchor,{children:(0,i.jsx)(Q.K,{unsafeDisableTooltip:!0,ref:N,"aria-haspopup":"true","aria-label":"More actions",icon:_.TriangleDownIcon,size:"small",className:(0,I.$)("fgColor-muted",tL.actionBarArrowSizing),onClick:z})}),(0,i.jsx)(e_.W.Overlay,{width:"medium",children:(0,i.jsx)(eR.l,{children:(0,i.jsx)(ts,{shouldDisplayCollapseComments:f,copilotChatReference:o,showStartConversation:a,handleCopyCode:d,handleViewMarkersSelection:$,startConversationCurrentLine:M,startConversationWithSuggestedChange:P})})})]})]})})]})});tS.displayName="ActionBar";let tD={visibilityHidden:"DiffHighlightedOverlay-module__visibilityHidden--v59uf",userSelectNone:"DiffHighlightedOverlay-module__userSelectNone--i39lB",focusedResultStyles:"DiffHighlightedOverlay-module__focusedResultStyles--QZMIm",nonFocusedResultStyles:"DiffHighlightedOverlay-module__nonFocusedResultStyles--x2N7d",nonHunkStyles:"DiffHighlightedOverlay-module__nonHunkStyles--_dJlQ"};function tI({searchResults:e,focusedSearchResult:t,className:n,styleObject:r}){let l=0,a=e[0]?.text??"",s=e[0]?.diffLineNumIndex??-1,o=`overlay-${s}-${a}`;return(0,i.jsxs)("span",{className:(0,I.$)(n,"position-absolute",tD.userSelectNone,!e[0].isHunk&&tD.nonHunkStyles),style:{...r},children:[e.map(e=>{var n,r;let s=e.indexWithinPathDigest===t,o=(0,i.jsxs)("span",{children:[(0,i.jsx)("span",{className:(0,I.$)(tD.visibilityHidden,tD.userSelectNone),children:a.substring(l,e.column)}),(0,i.jsx)("span",{className:(0,I.$)(tD.userSelectNone,s&&tD.focusedResultStyles,!s&&tD.nonFocusedResultStyles),children:(0,i.jsx)("span",{className:(0,I.$)(!s&&tD.visibilityHidden),id:(n=e.indexWithinPathDigest,r=e.pathDigest,`match-${r}-${n}`),children:a.substring(e.column,e.columnEnd)})})]},`find-match-${e.diffLineNumIndex}-${e.column}`);return l=e.columnEnd,o}),(0,i.jsx)("span",{className:(0,I.$)(tD.visibilityHidden,tD.userSelectNone),children:a.substring(l)})]},o)}try{tI.displayName||(tI.displayName="DiffHighlightedOverlay")}catch{}function tk(e,t,n){let i=e.threadsData?.totalCount||0,r=t.threadsData?.totalCount||0;if(0===i&&0===r)return;let l="";1===i?l="has a comment.":i>1&&(l="has comments.");let a="";1===r?a="has a comment.":r>1&&(a="has comments.");let s="";if("LEFT"===n){let e=`${l.charAt(0).toUpperCase()}${l.slice(1)}`,t=`${a.length>1?"Modified line":""} ${a}`;s=`${e} ${t}`}else{let e=`${a.charAt(0).toUpperCase()}${a.slice(1)}`,t=`${l.length>1?"Original line":""} ${l}`;s=`${e} ${t}`}return s}function tE({summary:e}){let t=eW();return""===e?null:(t&&(e+=" Press Enter to view."),(0,i.jsx)("span",{className:"sr-only user-select-none",children:e.trimStart().trimEnd()}))}try{tE.displayName||(tE.displayName="DiffLineScreenReaderSummary")}catch{}let t_={"comment-indicator":"DiffLineTableCellParts-module__comment-indicator--eI0hb","in-progress-comment-indicator":"DiffLineTableCellParts-module__in-progress-comment-indicator--hx3m3"};function tR(e,t){switch(t){case"SHOW_MARKERS":return{userMinimized:!1,showMarkers:!0};case"USER_EXPANDED_MARKERS":return{showMarkers:!0,userMinimized:!1};case"USER_MINIMIZED_MARKERS":return{userMinimized:!0,showMarkers:!1};case"USER_EXITED_MARKERS_DIALOG":return{...e,showMarkers:!1}}}let tA=["CONTEXT","INJECTED_CONTEXT"];function tT(e){let{rowId:t}=F();if(t)return(0,b.u6)(t,e)}let tO=(0,l.forwardRef)(function({children:e,ContextMenu:t,className:n,columnIndex:r,handleDiffCellClick:a,handleDiffCellMouseDown:s,handleExitDialogMode:o,handleHideMarkersFromFocus:d,handleDiffSideCellSelectionBlocking:c,handleStartConversation:u,handleUserClosedMarkersDialog:f,lineAnchor:h,firstLineNumberSelection:m,commentDialogOpen:p,enterDialogMode:x,hasThreads:y,...C},v){let{diffLine:N,fileAnchor:j,isRowSelected:w,isLeftSide:S}=F(),D=(0,l.useRef)(null);(0,l.useImperativeHandle)(v,()=>D.current,[]);let[I,k]=(0,l.useState)(!1),{selectedDiffRowRange:E}=L(),{disableInlineCommentDialogMode:_,isInDialogMode:R}=(0,Y.q)(),A=(0,l.useRef)(null),T=(0,ek.U)(e=>{if(!e.target)return;let t=e.target;if(!I||A.current?.contains(t)||D.current?.contains(t)||2!==e.button?D.current?.contains(t)&&e.target.closest("button")?.contains(t)&&k(!1):k(!1),R){let t=!e.target.closest("[data-inline-markers]"),n=!e.target.closest("#__primerPortalRoot__");t&&n&&_()}});(0,l.useEffect)(()=>(g.XC?.addEventListener("mousedown",T),()=>g.XC?.removeEventListener("mousedown",T)),[T]),(0,l.useEffect)(()=>()=>g.XC?.removeEventListener("mousedown",T),[]);let O=(0,l.useCallback)(()=>{let e=(0,b.j2)({line:N,range:E,fileAnchor:j});e&&(0,eA.D)(e)},[j,N,E]),$=(0,l.useCallback)(()=>{m?.current&&(m.current=null)},[m]),M=(0,l.useCallback)(e=>{let t=e.target?.closest("td"),n=t?.classList.contains("diff-line-number");e.shiftKey?e.preventDefault():n?s?.():m&&(m.current=null),m&&n&&(m.current=S?N.left:N.right),c?.(e)},[c]),P=(0,l.useCallback)(()=>{D.current?.focus(),_(),o?.(),f?.()},[_,o,f]),U=eT({fileAnchor:j}),H=eW(),B=(0,l.useCallback)(async e=>{if(H){if(e.target===D.current&&(e?.metaKey||e?.ctrlKey)&&"c"===e.key){e.preventDefault(),await U();return}if(e.target===D.current&&(e?.metaKey||e?.ctrlKey)&&e.altKey&&"y"===e.key)return void O();if(D.current?.contains(e.target)&&e?.key==="Escape")return void P();if(D.current?.contains(e.target)&&"true"===e.target.getAttribute("data-exit-dialog-mode-button")&&!e?.shiftKey&&e?.key==="Tab"){e.preventDefault(),D.current?.querySelector('[data-is-first-collapse-button="true"]')?.focus();return}if(D.current?.contains(e.target)&&"true"===e.target.getAttribute("data-is-first-collapse-button")&&e?.shiftKey&&e?.key==="Tab"){e.preventDefault(),D.current?.querySelector('[data-exit-dialog-mode-button="true"]')?.focus();return}e.target===D.current&&"Enter"===e.key&&(x?.(),!1===y&&u?.(),e.preventDefault())}},[H,U,O,P,x,y,u]),z=`inline-dialog-heading-${(0,l.useId)()}`;return(0,i.jsxs)("td",{ref:D,"data-grid-cell-id":tT(r),"data-line-anchor":h,"data-selected":w,role:R?"dialog":"gridcell",style:{userSelect:"none",position:"relative"},tabIndex:-1,valign:"top",className:n?`focusable-grid-cell ${n} ${r<3?"left-side":""}`:"focusable-grid-cell",onKeyDown:B,onBlur:e=>e.target.ariaSelected="false",onClick:a,onFocus:e=>e.target.ariaSelected="true",onMouseDown:M,onMouseUp:$,"aria-labelledby":R?z:void 0,...C,children:[R&&(0,i.jsx)("h1",{id:z,className:"sr-only",children:"Comment view"}),e,t&&I&&(0,i.jsx)(e_.W,{anchorRef:D,open:!0,onOpenChange:k,children:(0,i.jsx)(e_.W.Overlay,{width:e?"medium":"small",children:(0,i.jsx)(eR.l,{children:t})})})]})});function t$(){let{isSplit:e}=F();return(0,i.jsx)("div",{className:(0,I.$)("hunk-kebab-icon pr-2 pb-1",!e&&"hunk-kebab-icon-unified"),children:(0,i.jsx)(_.KebabHorizontalIcon,{})})}let tM=(0,l.forwardRef)(function({summary:e,searchResultsForLine:t,focusedSearchResult:n,columnIndex:r,lineAnchor:a,firstLineNumberSelection:s,handleDiffCellClick:d,handleDiffSideCellSelectionBlocking:c,filePath:u,copilotChatReference:f},h){let{diffLine:m,fileAnchor:p,isLeftSide:g,isRowSelected:x}=F(),[y,C]=(0,b._S)(m.html,m.type),[v,j]=(0,l.useState)(""),w=C&&["+","-"].includes(C),{isActionBarVisible:S}=eG(),{selectedDiffRowRange:D,selectedDiffLines:k}=L(),{commentBatchPending:E,commentingEnabled:R,commentingImplementation:A,initialExpandedThreadId:T,markerNavigationImplementation:O,repositoryId:$,subjectId:M,subject:P,viewerData:U}=eM(),{hasPersistedComment:H}=(0,Z.L4)({diffSide:g?"LEFT":"RIGHT",filePath:u,line:m.blobLineNumber,subjectId:M,fileLevelComment:!1}),{isInDialogMode:B,enableInlineCommentDialogMode:z,disableInlineCommentDialogMode:G}=(0,Y.q)(),V=(0,l.useRef)(null),q=(0,l.useRef)(null);(0,l.useImperativeHandle)(h,()=>q.current,[]);let W=eW(),K=!!m.threadsData?.threads?.length||!!m.annotationsData?.annotations?.length,X=(0,b.S4)({hasThreads:K&&!W}),J=function(e,t,n){let{selectedDiffRowRange:i}=L();return(0,l.useMemo)(()=>{let r="Add a comment on",l=!!i&&i.startLineNumber!==i.endLineNumber;if(i&&l&&n){let e={left:"L",right:"R"},t=e[i.startOrientation],n=e[i.endOrientation];r+=i.startLineNumber!==i.endLineNumber?` lines ${t}${i.startLineNumber} to ${n}${i.endLineNumber}`:` line ${t}${i.startLineNumber}`}else{let n=t&&!(0,b.Ji)(e)?"L":"R";r+=` line ${n}${e.blobLineNumber}`}return r},[e,t,i,n])}(m,!!g,x),Q=tT(r),{handleCellBlur:ee,handleCellFocus:et,handleCellMouseEnter:en,handleCellMouseLeave:ei}=eX({cellRef:q}),er=(0,l.useRef)(null),[el,ea]=function(e){let[t,n]=(0,l.useReducer)(tR,{userMinimized:e===eE.sI.Collapsed,showMarkers:!1});return(0,l.useEffect)(()=>{e===eE.sI.Visible?n("SHOW_MARKERS"):n("USER_MINIMIZED_MARKERS")},[e,n]),[t,n]}(U.commentsPreference),es=(0,l.useCallback)((e=!0)=>{q.current?.classList.contains("diff-text-cell")&&(z(),ea("USER_EXPANDED_MARKERS"),e&&setTimeout(()=>{q.current?.querySelector('[data-first-thread-comment="true"]')?.focus()},0))},[ea,z]),eo=(0,l.useCallback)(()=>{setTimeout(()=>q.current?.focus()),G(),ea("USER_MINIMIZED_MARKERS")},[G,ea]),ed=(0,l.useCallback)(()=>{U.commentsPreference===eE.sI.Collapsed&&el.showMarkers?eo():es()},[eo,es,el.showMarkers,U.commentsPreference]),{annotations:ec,isNewConversationDialogOpen:eu,shouldStartNewConversationWithSuggestedChange:eh,startNewConversation:em,startNewConversationWithSuggestedChange:ep,openMarkerOrListDialog:eg,selectAnnotation:ex,selectThread:eb,isMarkerListDialogOpen:ey,closeNewConversationDialog:eC,closeMarkerListDialog:ev,closeConversationDetailsDialog:eN,returnFocusRef:ej,optimizedSelectedAnnotationId:ew,optimizedSelectedThreadId:eL,threads:eS}=eK({cellId:Q,actionBarRef:V,onOpenInLineThread:es}),eI=(0,l.useMemo)(()=>{var e;return(!eu||!W)&&(e=U.viewerCanComment,R&&e&&(0,b.a1)(m,k))},[eu,W,R,U.viewerCanComment,m,k]);(0,l.useEffect)(()=>{A&&T&&eL!==T&&eS.map(e=>e.id).includes(T)&&eb(T,{skipLineSelection:!0})},[T]),(0,l.useEffect)(()=>{if(!O)return;let{activeGlobalMarkerID:e,onActivateGlobalMarkerNavigation:t}=O;if(e){let n=eS.map(e=>e.id),i=ec.map(e=>e.id);n.includes(e)?(eb(e,{skipLineSelection:!0}),t()):i.includes(e)&&(ex(e,{skipLineSelection:!0}),t())}},[eb,eS,O,ec,ex]);let ek=({onCompleted:e,threadsConnectionId:t,...n})=>{if(!A||!m)return;let{leftLines:i,rightLines:r}=k;if(D){let e="left"===D.endOrientation?i:r,n=e[e.length-1];n&&(0,b.qK)(n)&&n.threadsData?.__id&&(t=n.threadsData?.__id)}A.addThread({...n,diffLine:m,isLeftSide:g,isLineSelected:x,selectedDiffRowRange:D,threadsConnectionId:t,onCompleted:(t,n)=>{e?.(t,n),eb(t),W&&j(t)}})},e_=({onCompleted:e,...t})=>{A&&m&&A.deleteComment({...t,onCompleted:()=>{e?.(),eS.length<=1&&(eN(),setTimeout(()=>q.current?.focus()))},filePath:u})},eR=function(e,t,n){let{sendAnalyticsEvent:i}=(0,ef.s)(),{getDiffLinesFromLineRange:r,selectedDiffRowRange:a}=L(),s=N(function(n,l){if(!e)return;let a=function(e){if(!e)return"DELETION"!==t.type;if("right"===e.startOrientation&&"right"===e.endOrientation)return!0;if(e.startLineNumber===e.endLineNumber&&e.startOrientation===e.endOrientation)return"DELETION"!==t.type;let n=r(e)?.selectedLeftLines;return!!n?.every(e=>"empty-diff-line"!==e&&"DELETION"!==e.type)}(n);return{isValidSuggestionRange:a,showSuggestChangesButton:a,sourceContentFromDiffLines:a?function(e){let n=r(e)?.selectedRightLines;if(e&&n&&n.length>1)return(0,b.Ls)(n);if(!t)return"";let[i]=(0,b._S)(t.text,t.type);return i}(n):void 0,onInsertSuggestedChange:()=>{i("diff.add_suggested_change","ADD_SUGGESTED_CHANGE_BUTTON")},shouldInsertSuggestedChange:l}});return(0,l.useMemo)(()=>({selectedDiffRowRange:a,configureSuggestedChangesFromLineRange:s,shouldStartNewConversationWithSuggestedChange:n}),[a,s,n])}(A?.suggestedChangesEnabled,m,eh),eA=(0,l.useCallback)(()=>{W&&es?.(),em?.()},[W,es,em]),eO=(0,l.useCallback)(()=>{B||0!==(q.current?.querySelectorAll(":focus")??[]).length||G()},[G,B]),e$=(0,l.useRef)(!0),{ghostUser:eP}=eM(),eF=eT({fileAnchor:p}),eU=(0,l.useMemo)(()=>K&&U.commentsPreference===eE.sI.Collapsed?!el.userMinimized:(!!eu||!!K)&&!!R&&(U.commentsPreference===eE.sI.Collapsed&&(!!eu||!!B)||U.commentsPreference===eE.sI.Visible&&(!!K||!!eu||!!el.showMarkers)||!1),[R,K,B,eu,el.showMarkers,el.userMinimized,U.commentsPreference]),eH=(0,l.useMemo)(()=>(0,b.dT)(m),[m]);return(0,i.jsxs)(tO,{ref:q,columnIndex:r,commentDialogOpen:eu,handleDiffCellClick:d,enterDialogMode:es,handleDiffSideCellSelectionBlocking:c,handleExitDialogMode:()=>ea("USER_EXITED_MARKERS_DIALOG"),handleUserClosedMarkersDialog:()=>ea("USER_MINIMIZED_MARKERS"),lineAnchor:a,firstLineNumberSelection:s,handleStartConversation:eA,hasThreads:K,ContextMenu:(0,i.jsx)(ts,{shouldDisplayCollapseComments:eU,copilotChatReference:f,showStartConversation:eI,handleViewMarkersSelection:eg,startConversationCurrentLine:eA,startConversationWithSuggestedChange:ep}),className:(0,I.$)(`diff-text-cell ${g?"left-side-diff-cell":"right-side-diff-cell"} ${eH?"pt-4":""}`,{"border-right":g&&"HUNK"!==m.type}),style:{backgroundColor:(0,b.Yf)(m.type,!1,x),paddingRight:X},onBlur:e=>{ee(e),eO()},onFocus:et,onMouseEnter:en,onMouseLeave:ei,children:[(0,i.jsxs)("code",{className:(0,I.$)("diff-text syntax-highlighted-line",{addition:"ADDITION"===m.type,deletion:"DELETION"===m.type}),children:[w&&(0,i.jsx)("span",{className:"diff-text-marker",children:C}),t&&t.length>0&&(0,i.jsx)(tI,{searchResults:t,focusedSearchResult:n,className:(0,I.$)("diff-text-inner",{"color-fg-muted":"HUNK"===m.type})}),(0,i.jsx)(o.mo,{html:y,className:(0,I.$)("diff-text-inner",{"color-fg-muted":"HUNK"===m.type})})]}),m.displayNoNewLineWarning&&(0,i.jsx)(_.NoEntryIcon,{size:16,className:"fgColor-danger"}),S&&(0,i.jsx)(tS,{shouldDisplayCollapseComments:!!W&&el.showMarkers,copilotChatReference:f,authorAvatarUrl:U.avatarUrl,authorLogin:U.login,ref:V,cellId:Q,cellRef:q,onStartConversation:eA,hasDraftComment:H,showStartConversation:eI,onOpenInLineThread:es,handleCopyCode:eF,toggleViewingMarkers:ed}),A&&O&&(0,i.jsx)(i.Fragment,{children:W?eU?(0,i.jsx)(eD,{inlineMarkersRef:er,manuallyUpdateCommentsWithThisThreadId:v,annotations:ec,enterDialogMode:es,batchPending:E,batchingEnabled:A.batchingEnabled,commentingImplementation:{...A,deleteComment:e_},conversationListThreads:eS,fileAnchor:p,filePath:u,onCloseFocusMode:eo,isMarkerListOpen:!!q.current?.classList.contains("diff-text-cell")&&eS.length>0,isRowSelected:x,lineType:m.type,repositoryId:$,returnFocusRef:ej,selectedAnnotationId:ew,selectedThreadId:eL||(q.current?.classList.contains("diff-text-cell")&&eS.length>0?eS[0]?.id:null),subjectId:M,subject:P,suggestedChangesConfig:eR,onCloseConversationDialog:eN,onCloseConversationList:ev,onAnnotationSelected:ex,onThreadSelected:eb,viewerData:U,ghostUser:eP,children:eu&&(0,i.jsx)("div",{className:(0,I.$)(" border rounded-2 color-border-default",(eS.length,"mt-2 mb-1")),children:(0,i.jsx)(Z.cT,{isDialog:!1,addCommentDialogTitle:J,anchorRef:q,batchPending:E,batchingEnabled:A.batchingEnabled,commentBoxConfig:A.commentBoxConfig,commentBoxSubject:A.commentBoxSubject,filePath:u,isLeftSide:!!g,isOpen:eu,lineNumber:m.blobLineNumber,repositoryId:$,returnFocusRef:ej,subjectId:M,suggestedChangesConfig:eR,viewerData:U,onAddComment:ek,onCloseCommentDialog:()=>{eo(),eC()}})})}):null:(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(Z.c7,{annotations:ec,batchPending:E,batchingEnabled:A.batchingEnabled,commentingImplementation:{...A,deleteComment:e_},conversationAnchorRef:q,conversationListAnchorRef:ej,conversationListThreads:eS,fileAnchor:p,filePath:u,isMarkerListOpen:ey,repositoryId:$,returnFocusRef:ej,selectedAnnotationId:ew,selectedThreadId:eL,subjectId:M,subject:P,suggestedChangesConfig:eR,onCloseConversationDialog:eN,onCloseConversationList:ev,onAnnotationSelected:ex,onThreadSelected:eb,markerNavigationImplementation:O,viewerData:U,ghostUser:eP}),(0,i.jsx)(Z.cT,{addCommentDialogTitle:J,anchorRef:q,batchPending:E,batchingEnabled:A.batchingEnabled,commentBoxConfig:A.commentBoxConfig,commentBoxSubject:A.commentBoxSubject,filePath:u,isLeftSide:!!g,isOpen:eu,lineNumber:m.blobLineNumber,repositoryId:$,returnFocusRef:ej,subjectId:M,suggestedChangesConfig:eR,viewerData:U,onAddComment:ek,onCloseCommentDialog:eC})]})}),!S&&(!W||U.commentsPreference===eE.sI.Collapsed)&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)("div",{"aria-hidden":"true",style:{left:"compact"===U.lineSpacingPreference?"-1px":"-2px"},className:(0,I.$)("position-absolute top-0 d-flex user-select-none",t_["in-progress-comment-indicator"]),children:H&&(0,i.jsx)(tw,{lineSpacingPreference:U.lineSpacingPreference,authorAvatarUrl:U.avatarUrl,authorLogin:U.login})}),(0,i.jsx)("div",{"aria-hidden":"true",className:(0,I.$)("position-absolute top-0 d-flex user-select-none",t_["comment-indicator"]),children:(0,i.jsx)(e3,{shouldAnimateRef:e$,lineSpacingPreference:U.lineSpacingPreference})})]}),e&&(0,i.jsx)(tE,{summary:e})]})}),tP=(0,l.memo)(tM),tF=(0,l.memo)(tU);function tU({children:e,columnIndex:t,handleDiffCellClick:n,handleDiffSideCellSelectionBlocking:r,firstLineNumberSelection:a,filePath:s,copilotChatReference:o,contentRef:d,...c}){let u=(0,l.useRef)(null),{diffLine:f,fileAnchor:h,isLeftSide:m,isRowSelected:p}=F(),{updateSelectedDiffRowRange:g}=L(),x=(0,l.useCallback)(()=>{a&&null!==a.current&&g(h,m?f.left:f.right,m?"left":"right",!0,!0)},[h,m,f.left,f.right,a,g]),y=(0,l.useCallback)(()=>{g(h,m?f.left:f.right,m?"left":"right",!1,!0)},[h,m,f.left,f.right,g]);return(0,i.jsx)(tO,{ref:u,className:(0,I.$)("diff-line-number position-relative",tA.includes(f.type)&&"diff-line-number-neutral"),columnIndex:t,handleDiffCellClick:n,handleDiffSideCellSelectionBlocking:r,firstLineNumberSelection:a,style:{backgroundColor:(0,b.Yf)(f.type,!0,p),textAlign:"center"},handleDiffCellMouseDown:y,onMouseEnter:x,...c,children:(0,i.jsx)("code",{children:e})})}function tH({ContextMenu:e,renderHunkButton:t,searchResultsForLine:n,focusedSearchResult:r}){let a=(0,l.useRef)(null),[s,d]=function(e){let[t,n]=(0,l.useState)(!1),[i,r]=(0,l.useState)(!1),a=(0,l.useCallback)(t=>{e.current&&e.current.contains(t.relatedTarget)||n(!1)},[e]),s=(0,l.useCallback)(()=>{e.current===document.activeElement&&n(!0)},[e]),o=(0,l.useCallback)(t=>{e.current&&!e.current.contains(t.relatedTarget)&&n(!1),r(!1)},[e]),d=(0,l.useCallback)(e=>{e.stopPropagation(),r(!0)},[]);return[{onFocus:s,onBlur:a},{"aria-hidden":!i,tabIndex:t?0:-1,onBlur:o,onFocusCapture:d,onKeyDownCapture:(0,l.useCallback)(e=>{K(e.key)&&e.stopPropagation()},[])}]}(a),{diffLine:c}=F();return(0,i.jsx)(tO,{ref:a,ContextMenu:e,colSpan:4,columnIndex:0,style:{backgroundColor:"var(--bgColor-accent-muted, var(--color-accent-subtle))",flexGrow:1},...s,className:"diff-hunk-cell",children:(0,i.jsxs)("div",{className:"d-flex flex-row",children:[t?.(d)??(0,i.jsx)(t$,{}),(0,i.jsxs)("code",{className:"diff-text-cell hunk",children:[n&&n.length>0&&(0,i.jsx)(tI,{searchResults:n,focusedSearchResult:r,className:(0,I.$)("diff-text-inner",{"color-fg-muted":"HUNK"===c.type})}),(0,i.jsx)(o.mo,{className:"diff-text-inner color-fg-muted",html:c.html})]})]})})}function tB({columnIndex:e,showRightBorder:t}){return(0,i.jsx)(tO,{ContextMenu:(0,i.jsx)(td,{}),className:(0,I.$)("empty-diff-line",{"border-right":t}),columnIndex:e})}try{tO.displayName||(tO.displayName="Cell")}catch{}try{t$.displayName||(t$.displayName="HunkKebabIcon")}catch{}try{tM.displayName||(tM.displayName="ContentCellUnmemoized")}catch{}try{tP.displayName||(tP.displayName="ContentCell")}catch{}try{tF.displayName||(tF.displayName="LineNumberCell")}catch{}try{tU.displayName||(tU.displayName="LineNumberCellUnmemoized")}catch{}try{tH.displayName||(tH.displayName="HunkCell")}catch{}try{tB.displayName||(tB.displayName="EmptyCell")}catch{}var tz=n(21728),tG=n(94977);function tV(){let e,t=(0,tz.c)(1);return t[0]===Symbol.for("react.memo_cache_sentinel")?(e=(0,i.jsx)(tG.A,{direction:"n",text:"This line has hidden Unicode characters",children:(0,i.jsx)(_.AlertIcon,{className:"mr-2"})}),t[0]=e):e=t[0],e}try{tV.displayName||(tV.displayName="HiddenUnicodeAlert")}catch{}let tq=({summary:e,resultsForLine:t,focusedSearchResult:n,handleDiffSideCellSelectionBlocking:r,handleDiffRowClick:a,lineAnchor:s,filePath:o,copilotChatReference:d,firstLineNumberSelection:c})=>{let{diffLine:u,hasHiddenUnicodeCharacters:f,isLeftSide:h,isSplit:m,setInGridMode:p}=F(),g=(0,l.useRef)(null),x="ADDITION"!==u.type,b=!m||h,y=b&&!x,C="DELETION"!==u.type,v=!m||!h,N=v&&!C,j=(0,l.useCallback)(e=>{u.left&&a(e,u.left,"left",e.shiftKey,!0)},[a,u.left]),w=(0,l.useCallback)(e=>{u.left&&a(e,u.left,"left",e.shiftKey,!1)},[a,u.left]),L=(0,l.useCallback)(e=>{u.right&&a(e,u.right,"right",e.shiftKey,!0)},[a,u.right]),S=(0,l.useCallback)(e=>{u.right&&a(e,u.right,"right",e.shiftKey,!1)},[a,u.right]),D=(0,l.useCallback)(()=>{r&&r("left")},[r]),I=(0,l.useCallback)(()=>{r&&r("right")},[r]);return(0,i.jsxs)(ez,{line:u,children:[b&&(0,i.jsxs)(tF,{copilotChatReference:d,columnIndex:0,filePath:o,handleDiffCellClick:y?L:j,handleDiffSideCellSelectionBlocking:I,firstLineNumberSelection:c,contentRef:g,children:[f&&!C&&(0,i.jsx)(tK,{children:(0,i.jsx)(tV,{})}),x&&u.left]}),v&&(0,i.jsxs)(tF,{copilotChatReference:d,columnIndex:m?2:1,filePath:o,handleDiffCellClick:N?j:L,handleDiffSideCellSelectionBlocking:D,firstLineNumberSelection:c,contentRef:g,children:[f&&C&&(0,i.jsx)(tK,{children:(0,i.jsx)(tV,{})}),C&&u.right]}),(0,i.jsx)(Y.f,{enableDiffGridMode:p,children:(0,i.jsx)(tP,{copilotChatReference:d,columnIndex:m?h?1:3:2,filePath:o,handleDiffCellClick:h?w:S,lineAnchor:s,handleDiffSideCellSelectionBlocking:h?I:D,searchResultsForLine:t,focusedSearchResult:n,summary:e,firstLineNumberSelection:c,ref:g})})]})},tW=({summary:e,resultsForLine:t,focusedSearchResult:n,fileAnchor:r,filePath:l,handleDiffRowClick:a,handleDiffSideCellSelectionBlocking:s,copilotChatReference:o,firstLineNumberSelection:d})=>{let{diffLine:c,isLeftSide:u}=F();if((0,b.Po)(c))return(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(tB,{columnIndex:2*!u}),(0,i.jsx)(tB,{columnIndex:u?1:3,showRightBorder:u})]});let f=u?"left":(0,h.XU)(c.type),m="left"===f?c.left:c.right,p=(0,h.IQ)(r,f,m??0);switch(c.type){case"HUNK":return null;case"ADDITION":case"DELETION":case"CONTEXT":case"INJECTED_CONTEXT":return(0,i.jsx)(tJ,{copilotChatReference:o,filePath:l,handleDiffRowClick:a,handleDiffSideCellSelectionBlocking:s,lineAnchor:p,resultsForLine:t,focusedSearchResult:n,summary:e,firstLineNumberSelection:d});default:throw Error(`cannot handle type ${c.type}`)}};function tK({children:e}){return(0,i.jsx)("span",{className:"position-absolute",style:{left:"-1px",zIndex:"1"},children:e})}let tX=l.memo(tW),tJ=l.memo(tq);try{tq.displayName||(tq.displayName="CodeDiffLineUnmemoized")}catch{}try{tW.displayName||(tW.displayName="DiffLineSideUnmemoized")}catch{}try{tK.displayName||(tK.displayName="DiffCodeAlert")}catch{}try{tX.displayName||(tX.displayName="DiffLineSide")}catch{}try{tJ.displayName||(tJ.displayName="CodeDiffLine")}catch{}let tY={"expand-button-line":"ExpandableHunkHeaderDiffLine-module__expand-button-line--rnQN5","expand-up-and-down":"ExpandableHunkHeaderDiffLine-module__expand-up-and-down--hCan_","expand-button-unified":"ExpandableHunkHeaderDiffLine-module__expand-button-unified--j86KQ"};function tZ({direction:e,icon:t,label:n,onClick:r,ariaLabel:l,className:a,...s}){let{sendAnalyticsEvent:o}=(0,ef.s)(),{isSplit:d}=F();return(0,i.jsx)("button",{onClick:()=>{r(),o("file_entry.expand_hunk","FILE_EXPANDER_BUTTON")},className:(0,I.$)("Button Button--iconOnly Button--invisible",tY["expand-button-line"],!d&&tY["expand-button-unified"],a),"aria-label":l??n,"data-direction":e,...s,children:(0,i.jsx)(t,{})})}function tQ({nextLine:e,prevLine:t,resultsForLine:n,focusedSearchResult:r}){let{fileLineCount:a,diffLine:s}=F(),{expandStartOfHunk:o,expandEndOfPreviousHunk:d}=e5(),c=!t,u=!e,f=0===s.blobLineNumber,h=c||u,m=u&&s.blobLineNumber===a,p=(0,l.useMemo)(()=>!h&&!(s.blobLineNumber<=0)&&(!!(s.blobLineNumber-t.blobLineNumber<=20)||!!(e.blobLineNumber-s.blobLineNumber>=20)),[h,s,e,t]),g=(0,l.useMemo)(()=>!h&&!m&&s.blobLineNumber-t.blobLineNumber>20,[h,m,s,t]),x=(0,l.useMemo)(()=>!(s.blobLineNumber<=0)&&!f&&!!c,[c,f,s]),y=(0,l.useMemo)(()=>!c&&!m&&!!u,[c,u,m]),C=(0,l.useMemo)(()=>{switch(!0){case p:return"expand-all";case g:return"expand-up-and-down";case x:return"expand-up";case y:return"expand-down"}},[p,g,x,y]),v=()=>o(),N=()=>d(),j=()=>o();return(0,i.jsx)(tH,{searchResultsForLine:n,focusedSearchResult:r,renderHunkButton:n=>{switch(C){case"expand-all":return(0,i.jsx)(tZ,{...n,direction:"all",icon:_.UnfoldIcon,label:`Expand file from line ${t?.blobLineNumber||""} to line ${e?.blobLineNumber||""}`,onClick:j});case"expand-up-and-down":return(0,i.jsxs)("div",{className:"d-flex flex-column",children:[(0,i.jsx)(tZ,{...n,direction:"down",icon:_.FoldDownIcon,label:`Expand file down from line ${t?.blobLineNumber||""}`,className:tY["expand-up-and-down"],onClick:N}),(0,i.jsx)(tZ,{...n,direction:"up",icon:_.FoldUpIcon,label:`Expand file up from line ${e?.blobLineNumber||""}`,className:tY["expand-up-and-down"],onClick:v})]});case"expand-up":return(0,i.jsx)(tZ,{...n,direction:"up",icon:_.FoldUpIcon,label:`Expand file up from line ${e?.blobLineNumber||""}`,onClick:v});case"expand-down":return(0,i.jsx)(tZ,{...n,direction:"down",icon:_.FoldDownIcon,label:`Expand file down from line ${t?.blobLineNumber||""}`,onClick:N});default:return null}},ContextMenu:(0,i.jsx)(t0,{handleCopyContent:()=>{let[e]=(0,b._S)((0,b.ZC)(s.html),s.type);(0,eA.D)(e)},handleExpandAbove:v,handleExpandAll:j,handleExpandBelow:N,shouldCopyContent:!!s.html,shouldExpandAbove:g||x,shouldExpandBelow:g||y})})}function t0({shouldExpandBelow:e,shouldExpandAbove:t,shouldCopyContent:n,handleExpandAll:r,handleExpandBelow:l,handleExpandAbove:a,handleCopyContent:s}){let o={includeShiftKey:!0,key:"["},d={key:"]"},c={key:"["},u={key:"C"};return(0,i.jsx)(e_.W.Overlay,{width:"medium",children:(0,i.jsxs)(eR.l,{children:[(0,i.jsxs)(eR.l.Item,{"aria-keyshortcuts":(0,b.oE)(o),onSelect:r,children:[(0,i.jsx)(eR.l.LeadingVisual,{children:(0,i.jsx)(_.UnfoldIcon,{})}),"Expand all",(0,i.jsx)(eR.l.TrailingVisual,{children:(0,i.jsx)("span",{children:`${(0,b.pI)(o)}`})})]}),t?(0,i.jsxs)(eR.l.Item,{"aria-keyshortcuts":(0,b.oE)(d),onSelect:a,children:[(0,i.jsx)(eR.l.LeadingVisual,{children:(0,i.jsx)(_.FoldUpIcon,{})}),"Expand above",(0,i.jsx)(eR.l.TrailingVisual,{children:(0,i.jsx)("span",{children:`${(0,b.pI)(d)}`})})]}):null,e?(0,i.jsxs)(eR.l.Item,{"aria-keyshortcuts":(0,b.oE)(c),onSelect:l,children:[(0,i.jsx)(eR.l.LeadingVisual,{children:(0,i.jsx)(_.FoldDownIcon,{})}),"Expand below",(0,i.jsx)(eR.l.TrailingVisual,{children:(0,i.jsx)("span",{children:`${(0,b.pI)(c)}`})})]}):null,(0,i.jsx)(tC,{}),n?(0,i.jsxs)(eR.l.Item,{"aria-keyshortcuts":(0,b.oE)(u),onSelect:s,children:[(0,i.jsx)(eR.l.LeadingVisual,{children:(0,i.jsx)(_.CopyIcon,{})}),"Copy",(0,i.jsx)(eR.l.TrailingVisual,{children:(0,i.jsx)("span",{children:`${(0,b.pI)(u)}`})})]}):null]})})}try{tZ.displayName||(tZ.displayName="ExpandButtonLine")}catch{}try{tQ.displayName||(tQ.displayName="ExpandableHunkHeaderDiffLine")}catch{}try{t0.displayName||(t0.displayName="HunkContextMenu")}catch{}let t1=/[\u202A-\u202E]|[\u2066-\u2069]|\u{E0001}|\u{E007F}/u,t2=/[\u202A-\u202E]|[\u2066-\u2069]|\u{E0001}|\u{E007F}/gu,t3=/([\u202A-\u202E]|[\u2066-\u2069]|\u{E0001}|\u{E007F})/gu,t4=new Map(Object.entries({"\u202A":"U+202A","\u202B":"U+202B","\u202C":"U+202C","\u202D":"U+202D","\u202E":"U+202E","\u2066":"U+2066","\u2067":"U+2067","\u2068":"U+2068","\u2069":"U+2069","\u{E0001}":"U+E0001","\u{E007F}":"U+E007F"}));function t6(e){return t8(e)?e.replaceAll(t2,e=>t4.get(e)??""):e}function t8(e){return t1.test(e)}function t7(e){let t,n=(0,tz.c)(2),{char:r}=e;return n[0]!==r?(t=(0,i.jsx)("span",{className:"hidden-unicode-replacement padded",children:r}),n[0]=r,n[1]=t):t=n[1],t}function t9(e){return t8(e)?e.split(t3).map(e=>{let t=t4.get(e);return t?`<span class="hidden-unicode-replacement">${t}</span>`:e}).join(""):null}try{t7.displayName||(t7.displayName="HiddenUnicodeCharacter")}catch{}let t5=(0,l.memo)(function({searchResults:e,diffContext:t="pr",focusedSearchResult:n,clearSelectedDiffRowRange:r,diffEntryId:a,diffHasHiddenUnicodeCharacters:s,diffLines:o,fileAnchor:d,fileLineCount:c,filePath:u,handleDiffRowClick:f,handleDiffSideCellSelectionBlocking:h,replaceSelectedDiffRowRangeFromGridCells:m,selectedDiffRowRange:p,setInGridMode:g,showHiddenUnicode:x,tableRef:C,updateDiffLines:v,updateSelectedDiffRowRange:N,copilotChatReference:j,inGridMode:w,firstLineNumberSelection:L}){let{leftLines:S,rightLines:D}=function(e){let t=e.reduce((e,t)=>e+(t.threadsData?.totalCount??0),0)??0,{leftLines:n,rightLines:i}=(0,l.useMemo)(()=>(function(e){let t=[],n=[],i=()=>{for(;t.length<n.length;)t.push(J.V);for(;n.length<t.length;)n.push(J.V)};for(let l of e)switch(l.type){case"ADDITION":n.push(l);break;case"DELETION":t.push(l);break;case"CONTEXT":case"INJECTED_CONTEXT":var r;i();let[e,a]=[{...r=l,threadsData:void 0,annotationsData:void 0},{...r,threadsData:r.threadsData?{...r.threadsData,threads:r.threadsData.threads,totalCommentsCount:r.threadsData.totalCommentsCount,totalCount:r.threadsData.totalCount}:void 0}];t.push(e),n.push(a);break;case"HUNK":i(),t.push(l),n.push(l)}return i(),{leftLines:t,rightLines:n}})(e),[e,t]);return{leftLines:n,rightLines:i}}(o),{addInjectedContextLines:I,ghostUser:k}=eM();X({clearSelectedDiffRowRange:r,containerRef:C,fileAnchor:d,isSplitDiff:!0,leftLines:S,replaceSelectedDiffRowRangeFromGridCells:m,rightLines:D,selectedDiffRowRange:p,updateSelectedDiffRowRange:N,disabled:!w});let E=(0,l.useMemo)(()=>{if(p)return y({selectedDiffRowRange:p,leftLines:S,rightLines:D,isNumberCell:!0})},[p,S,D]);(0,l.useEffect)(()=>{v(d,o)},[o,d,v]);let _=(0,l.useMemo)(()=>$(S),[S]),R=new Map,A=new Map,T=new Map;for(let t=0;t<(e?.length??0);t++){let n=e?.[t];n&&(R.has(n.leftLineNumber)?R.get(n.leftLineNumber)?.push(n):-1!==n.leftLineNumber&&R.set(n.leftLineNumber,[n]),T.has(n.hunkLineNumber)?T.get(n.hunkLineNumber)?.push(n):n.isHunk&&T.set(n.hunkLineNumber,[n]),A.has(n.rightLineNumber)?A.get(n.rightLineNumber)?.push(n):-1!==n.rightLineNumber&&A.set(n.rightLineNumber,[n]))}let M=e=>{let t=!1;return s&&!(0,b.Po)(e)&&(t=t8(e.text),x&&t&&(e=e.html?{...e,html:t9(e.html)??e.html}:{...e,text:t6(e.text)})),[e,t]},F=[];for(let e=0;e<S.length;e++){let r=S[e],s=D[e],o=S[e-1],[m,p]=M(r),[x,y]=M(s),C=(0,b.Po)(S[e+1])?D[e+1]:S[e+1],v=(0,b.qK)(m)&&"HUNK"===m.type,N=(0,b.qX)(d,m,x),w=(0,b.Po)(m)?(0,b.Po)(x)?void 0:x:m;if(!w)continue;let $=(0,b.Po)(m)?void 0:m.threadsData,H=(0,b.Po)(x)?void 0:x.threadsData,{currentHunk:B,nextHunk:z,previousHunk:G}=O(w,_),V=R.get((0,b.Po)(m)?-2:m.left??-2),q=A.get((0,b.Po)(x)?-2:x.right??-2),W=T.get(w.blobLineNumber),K=W?.[0]?.rightLineNumber===x?.right?n:void 0,X=V?.[0]?.leftLineNumber===m?.left?n:void 0,J=q?.[0]?.rightLineNumber===x?.right?n:void 0,Y=tk(m,x,"LEFT"),Z=tk(m,x,"RIGHT"),Q=U(H,k),ee=U($,k),et={currentHunk:B,diffEntryId:a,fileAnchor:d,fileLineCount:c,filePath:u,isRowSelected:(E?.isRowSelected(r)||E?.isRowSelected(s))??!1,nextHunk:z,previousHunk:G,rowId:N,isSplit:!0,diffContext:t,setInGridMode:g},{expandEndOfHunk:en,expandEndOfPreviousHunk:ei,expandStartOfHunk:er}=te(I,z,B,G),el=()=>{if(!(0,b.Po)(m)&&m?.type==="HUNK")return void ei();en()};F.push((0,i.jsx)(l.Fragment,{children:(0,i.jsx)(e9.tL,{as:"tr",className:"diff-line-row",commands:{"pull-requests-diff-view:expand-hunk-up":er,"pull-requests-diff-view:expand-hunk-down":el},children:v?(0,i.jsx)(P,{...et,hasHiddenUnicodeCharacters:p||y,diffLine:w,modifiedLineThreads:Q,originalLineThreads:ee,children:(0,i.jsx)(tQ,{nextLine:C,prevLine:o,focusedSearchResult:K,resultsForLine:W})}):(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(P,{...et,diffLine:m,hasHiddenUnicodeCharacters:p,isLeftSide:!0,modifiedLineThreads:Q,originalLineThreads:ee,children:(0,i.jsx)(tX,{summary:Y,copilotChatReference:j,fileAnchor:d,filePath:u,handleDiffRowClick:f,handleDiffSideCellSelectionBlocking:h,resultsForLine:V,focusedSearchResult:X,firstLineNumberSelection:L})}),(0,i.jsx)(P,{...et,diffLine:x,hasHiddenUnicodeCharacters:y,modifiedLineThreads:Q,originalLineThreads:ee,children:(0,i.jsx)(tX,{summary:Z,copilotChatReference:j,fileAnchor:d,filePath:u,handleDiffRowClick:f,handleDiffSideCellSelectionBlocking:h,resultsForLine:q,focusedSearchResult:J,firstLineNumberSelection:L})})]})})},N))}return(0,i.jsx)(i.Fragment,{children:F})});try{t5.displayName||(t5.displayName="SplitDiffLines")}catch{}let ne=(0,l.memo)(function({searchResults:e,diffContext:t="pr",focusedSearchResult:n,clearSelectedDiffRowRange:r,diffEntryId:a,diffHasHiddenUnicodeCharacters:s,diffLines:o,fileLineCount:d,fileAnchor:c,filePath:u,tableRef:f,selectedDiffRowRange:m,showHiddenUnicode:p,handleDiffRowClick:g,updateDiffLines:x,updateSelectedDiffRowRange:C,replaceSelectedDiffRowRangeFromGridCells:v,copilotChatReference:N,setInGridMode:j,inGridMode:w,firstLineNumberSelection:L}){X({clearSelectedDiffRowRange:r,containerRef:f,fileAnchor:c,isSplitDiff:!1,leftLines:o,replaceSelectedDiffRowRangeFromGridCells:v,selectedDiffRowRange:m,updateSelectedDiffRowRange:C,disabled:!w});let{addInjectedContextLines:S}=eM(),D=(0,l.useMemo)(()=>{if(m)return y({selectedDiffRowRange:m,leftLines:o,isNumberCell:!0})},[m,o]),I=(0,l.useMemo)(()=>$(o.map(e=>e)),[o]);(0,l.useEffect)(()=>{x(c,o)},[o,c,x]);let k=new Map;for(let t=0;t<(e?.length??0);t++){let n=e?.[t];n&&(e&&k.has(n.diffLineNumIndex)?k.get(n.diffLineNumIndex)?.push(n):e&&k.set(n.diffLineNumIndex,[n]))}let E=o.map((e,r)=>{let f=e,m=o[r+1],x=o[r-1],y="HUNK"===e.type,C=(0,h.IQ)(c,(0,h.XU)(f.type),f.blobLineNumber),{currentHunk:v,nextHunk:w,previousHunk:E}=O(f,I),_=k.get(r),R=r===_?.[0]?.diffLineNumIndex?n:void 0,A=tk(e,e,"RIGHT"),T=D?.isRowSelected(e)??!1,$=(0,b.qX)(c,f,f),M=s&&t8(f.text);p&&M&&(f=f.html?{...f,html:t9(f.html)??f.html}:{...f,text:t6(f.text)});let F={diffEntryId:a,diffLine:f,currentHunk:v,fileAnchor:c,fileLineCount:d,filePath:u,hasHiddenUnicodeCharacters:M,isLeftSide:"DELETION"===f.type,isRowSelected:T,isSplit:!1,nextHunk:w,previousHunk:E,diffContext:t,rowId:$,setInGridMode:j},{expandEndOfHunk:U,expandEndOfPreviousHunk:H,expandStartOfHunk:B}=te(S,w,v,E);return(0,i.jsx)(l.Fragment,{children:(0,i.jsx)(e9.tL,{as:"tr",className:"diff-line-row",commands:{"pull-requests-diff-view:expand-hunk-up":B,"pull-requests-diff-view:expand-hunk-down":()=>{if(!(0,b.Po)(e)&&e?.type==="HUNK")return void H();U()}},children:(0,i.jsx)(P,{...F,children:y?(0,i.jsx)(tQ,{nextLine:m,prevLine:x,focusedSearchResult:R,resultsForLine:_},r):(0,i.jsx)(tJ,{filePath:u,copilotChatReference:N,handleDiffRowClick:g,firstLineNumberSelection:L,lineAnchor:C,resultsForLine:_,focusedSearchResult:R,summary:A},r)})})},r)});return(0,i.jsx)(i.Fragment,{children:E})});try{ne.displayName||(ne.displayName="UnifiedDiffLines")}catch{}let nt={tableLayoutFixed:"DiffLines-module__tableLayoutFixed--YZcIJ",compact:"DiffLines-module__compact--wEEom"};var nn=n(94232),ni=n(6869);function nr(e){let t,n,r,l,a,s=(0,tz.c)(7),{isShown:o,toggleShowHiddenCharacters:d}=e;s[0]===Symbol.for("react.memo_cache_sentinel")?(t=[],s[0]=t):t=s[0];let[c]=(0,nn.I)(nl,g.cg,t);if(!c)return null;s[1]===Symbol.for("react.memo_cache_sentinel")?(n=(0,i.jsx)(_.AlertIcon,{}),s[1]=n):n=s[1],s[2]===Symbol.for("react.memo_cache_sentinel")?(r=(0,i.jsxs)("span",{children:["This file contains bidirectional or hidden Unicode text that may be interpreted or compiled differently than what appears below. To review, open the file in an editor that reveals hidden Unicode characters."," ",(0,i.jsx)(m.A,{inline:!0,href:"https://github.co/hiddenchars",target:"_blank",rel:"noreferrer",children:"Learn more about bidirectional Unicode characters"})]}),s[2]=r):r=s[2],s[3]===Symbol.for("react.memo_cache_sentinel")?(l={backgroundClip:"padding-box"},s[3]=l):l=s[3];let u=o?"Hide revealed characters":"Show hidden characters";return s[4]!==u||s[5]!==d?(a=(0,i.jsxs)(ni.A,{className:"d-flex flex-items-center",full:!0,variant:"warning",children:[n,r,(0,i.jsx)(k.Q,{className:"ml-4 float-right",onClick:d,size:"small",style:l,children:u})]}),s[4]=u,s[5]=d,s[6]=a):a=s[6],a}function nl(){return g.cg}try{nr.displayName||(nr.displayName="HiddenUnicodeBanner")}catch{}function na({diffAnchor:e,children:t}){return(0,i.jsx)("div",{className:"fgColor-muted p-2","data-diff-anchor":e,children:t})}let ns=(0,l.memo)(function({searchResults:e,diffContext:t="pr",focusedSearchResult:n,diffEntryData:r,diffLinesManuallyUnhidden:l,baseHelpUrl:a,onHandleLoadDiff:s,copilotChatReference:o,...d}){let c=`diff-${r.pathDigest}`;if(r.isBinary)return(0,i.jsx)(na,{diffAnchor:c,children:"Binary file not shown."});if((0,u.dK)(r))return(0,i.jsx)(na,{diffAnchor:c,children:"File renamed without changes."});if((0,u.Jc)(r))return(0,i.jsx)(na,{diffAnchor:c,children:"File copied without changes."});if((0,u.Sn)(r,r.status,r.oldTreeEntry?.mode,r.newTreeEntry?.mode))return(0,i.jsx)(na,{diffAnchor:c,children:"File mode changed."});if(!l&&(0,u.HI)(r))return(0,i.jsx)(R,{diffAnchor:c,onLoadDiff:s,children:(0,u.l_)(r.truncatedReason)});if((0,u.s8)(r))return(0,i.jsx)(na,{diffAnchor:c,children:"Whitespace-only changes."});if(!l&&(0,u.lO)(r))return(0,i.jsx)(R,{diffAnchor:c,onLoadDiff:s,children:"This file was deleted."});if(!l&&(0,u.xW)(r))return(0,i.jsxs)(R,{diffAnchor:c,helpText:"customizing how changed files appear on GitHub.",helpUrl:`${a}/github/administering-a-repository/customizing-how-changed-files-appear-on-github`,onLoadDiff:s,children:["Some generated files are not rendered by default. Learn more about"," "]});if(r.isTooBig){if("commit"===t&&0===r.diffLines.length)if(l)return(0,i.jsxs)(na,{diffAnchor:c,children:["Diff is too big to render. To view,"," ",(0,i.jsx)(m.A,{inline:!0,href:`${a}/pull-requests/collaborating-with-pull-requests/reviewing-changes-in-pull-requests/checking-out-pull-requests-locally`,children:"check out this pull request locally."})]});else return(0,i.jsx)(R,{diffAnchor:c,onLoadDiff:s,children:"Large diffs are not rendered by default."});if("pr"===t)if(r.diffLines.length>0)return(0,i.jsx)(R,{diffAnchor:c,onLoadDiff:s,children:"Large diffs are not rendered by default."});else return(0,i.jsxs)(na,{diffAnchor:c,children:["Diff is too big to render. To view,"," ",(0,i.jsx)(m.A,{inline:!0,href:`${a}/pull-requests/collaborating-with-pull-requests/reviewing-changes-in-pull-requests/checking-out-pull-requests-locally`,children:"check out this pull request locally."})]})}return r.diffLines?(0,i.jsx)(e$,{...d,children:(0,i.jsx)(D,{children:(0,i.jsx)(no,{diffAnchor:c,diffContext:t,diffEntryData:r,viewerData:d.viewerData,focusedSearchResult:n,searchResults:e,copilotChatReference:o})})}):null});function no({diffAnchor:e,viewerData:t,diffEntryData:n,searchResults:r,focusedSearchResult:a,copilotChatReference:s,diffContext:o}){let d=(0,l.useRef)(null),[c,u]=(0,l.useState)(!0),[m,p]=(0,l.useState)(null),[x,y]=(0,l.useState)(!1),C=n.newTreeEntry?.lineCount??n.oldTreeEntry?.lineCount??0,v=(0,l.useMemo)(()=>{let e=n.diffLines[n.diffLines.length-1];return e?.blobLineNumber&&e.blobLineNumber<C?n.diffLines.concat({__id:A.finalLineId,blobLineNumber:e.blobLineNumber+1,left:null,right:null,type:"HUNK",html:"",text:""}):n.diffLines},[n.diffLines,C]),{diffViewPreference:N,lineSpacingPreference:j,tabSizePreference:w}=t,{selectedDiffRowRange:S,replaceSelectedDiffRowRange:D,replaceSelectedDiffRowRangeFromGridCells:k,clearSelectedDiffRowRange:E,updateDiffLines:_,updateSelectedDiffRowRange:R}=L(),T=(0,l.useCallback)(e=>{if(!d.current||!e.target)return;let t=e.target,n=t.closest("td.diff-line-number"),i=d.current.contains(t);n&&!i&&(E(),H.current=null)},[E,d]);(0,l.useEffect)(()=>(g.XC?.addEventListener("mousedown",T),()=>{g.XC?.removeEventListener("mousedown",T)}),[T]);let O=e===S?.diffAnchor,$=(0,l.useMemo)(()=>{let e,t=n.status,i=n.oldTreeEntry?.path,r=n.newTreeEntry?.path;if(i||r)return e="RENAMED"===t?`${i} renamed to ${r}`:"DELETED"===t||"REMOVED"===t?i:r,`Diff for: ${e}`},[n]);(0,l.useEffect)(()=>{if(!O)return;let e=(0,b.On)(S,v);e&&e!==S&&D(e)},[v,S,O,D]);let M=g.cg?.location.search,P=(0,l.useMemo)(()=>"split"===new URLSearchParams(M).get("diff")||"split"===N,[M,N]),F=(0,h.c7)(v),U=(0,l.useCallback)(e=>{p(e)},[p]),H=(0,l.useRef)(null),B=(0,l.useCallback)((t,n,i,r,l)=>{!function(e){let t=document.getElementById("__primerPortalRoot__");return!!t&&!!e&&t.contains(e)}(t.target)&&!t.defaultPrevented&&l&&R(e,n,i,r,l)},[e,R]),z=(0,l.useCallback)(e=>{let t=document.getSelection();if(t){let n=[];for(let e=0;e<t.rangeCount;e++){let i=t.getRangeAt(e).cloneContents();if(i.querySelectorAll("td").length){let e=`td.diff-line-number, span.diff-text-marker${P?`, ${"left"===m?"td.left-side-diff-cell":"td.right-side-diff-cell"}`:""}`;for(let t of i.querySelectorAll(e))t.parentNode&&t.parentNode.removeChild(t);for(let e of i.children){let t=e.textContent;`
`===t?n.push(""):n.push(t)}}else 1===t.rangeCount?n.push(t.toString()):n.push(i.textContent)}e.clipboardData.setData("text/plain",n.join(`
`)),e.preventDefault()}},[m,P]),G=(0,l.useMemo)(()=>v.some(e=>t8(e.text)),[v]),V={searchResults:r,diffContext:o,focusedSearchResult:a,clearSelectedDiffRowRange:E,diffEntryId:n.objectId,diffHasHiddenUnicodeCharacters:G,diffLines:v,fileAnchor:e,fileLineCount:C,filePath:n.path,handleDiffRowClick:B,handleDiffSideCellSelectionBlocking:U,replaceSelectedDiffRowRangeFromGridCells:k,selectedDiffRowRange:O?S:null,showHiddenUnicode:x,tableRef:d,updateDiffLines:_,updateSelectedDiffRowRange:R,copilotChatReference:s,setInGridMode:u,inGridMode:c,firstLineNumberSelection:H};return(0,i.jsxs)(i.Fragment,{children:[G&&(0,i.jsx)(nr,{isShown:x,toggleShowHiddenCharacters:()=>y(!x)}),(0,i.jsx)(e9.tL,{as:"table",triggerOnDefaultPrevented:!0,"aria-label":$,commands:{"pull-requests-diff-view:expand-all-hunks":()=>{let e=document.querySelector(`.js-expand-all-difflines-button[data-file-path="${n.path}"]`);e?.dispatchEvent(new MouseEvent("click",{bubbles:!0,cancelable:!0}))}},ref:d,className:(0,I.$)("tab-size","width-full",nt.tableLayoutFixed,{[nt.compact]:"compact"===j}),"data-block-diff-cell-selection":m,"data-diff-anchor":e,"data-tab-size":w,"data-paste-markdown-skip":!0,onCopy:z,role:"grid",style:{"--line-number-cell-width":`${F}px`,"--line-number-cell-width-unified":`${2*parseFloat(F)}px`},children:P?(0,i.jsx)(f.wj,{lineWidth:F,children:(0,i.jsx)(t5,{...V})}):(0,i.jsx)(f.Qe,{lineWidth:F,children:(0,i.jsx)(ne,{...V})})})]})}try{na.displayName||(na.displayName="PlainTextStatus")}catch{}try{ns.displayName||(ns.displayName="DiffLines")}catch{}try{no.displayName||(no.displayName="CodeDiffLines")}catch{}let nd={diffTargetable:"Diff-module__diffTargetable--hLfiB",diffHeaderWrapper:"Diff-module__diffHeaderWrapper--J03RC"};var nc=n(46309),nu=n(58599);let nf={filesActionList:"SubmoduleDiff-module__filesActionList--Uek7G",fileRowLinkItem:"SubmoduleDiff-module__fileRowLinkItem--ebKNW",path:"SubmoduleDiff-module__path--GK9U6",fileRow:"SubmoduleDiff-module__fileRow--ohBMr",linesAdded:"SubmoduleDiff-module__linesAdded--jgi_y",linesDeleted:"SubmoduleDiff-module__linesDeleted--C3uEX"};function nh({submodule:e}){let{basePath:t,changedFiles:n,contentsUrl:r,newCommitOid:a,oldCommitOid:s,status:o,submoduleUrl:d}=e,c=e.summary.length>0&&e.contentsUrl&&"MODIFIED"===o,u=(0,l.useMemo)(()=>{switch(o){case"ADDED":return(0,i.jsx)(ng,{commitOid:a,contentsUrl:r,type:"added"});case"DELETED":case"REMOVED":return(0,i.jsx)(ng,{commitOid:s,contentsUrl:r,type:"deleted"});default:return(0,i.jsx)(nx,{newCommitOid:a,oldCommitOid:s,changedFiles:n,contentsUrl:r})}},[a,s,o,n,r]);return(0,i.jsxs)("div",{children:[(0,i.jsxs)("div",{className:`px-3 py-2 ${c?"border-bottom bgColor-muted":""}`,children:[(0,i.jsx)(_.FileSubmoduleIcon,{className:"fgColor-muted mr-2",size:16}),(0,i.jsx)(nm,{basePath:t,submoduleUrl:d}),u]}),c&&(0,i.jsx)(eR.l,{className:nf.filesActionList,showDividers:!0,variant:"full",children:e.summary.map(e=>(0,i.jsx)(nb,{compareUrl:`${r}/compare/${s}...${a}`,linesAdded:e.linesAdded,linesDeleted:e.linesDeleted,path:e.path,pathDigest:e.pathDigest,status:e.status},e.pathDigest))})]})}function nm({basePath:e,submoduleUrl:t}){return(0,i.jsxs)(i.Fragment,{children:["Submodule"," ",t?(0,i.jsx)(m.A,{inline:!0,href:t,children:e}):e," "]})}function np(e){return e.slice(0,7)}function ng({commitOid:e="",contentsUrl:t,type:n}){let r="added"===n?"added at":"deleted from";return t?(0,i.jsxs)(i.Fragment,{children:[r," ",(0,i.jsx)(m.A,{inline:!0,href:`${t}/tree/${e}`,children:np(e)})]}):(0,i.jsxs)(i.Fragment,{children:[r," ",np(e)]})}function nx({newCommitOid:e="",oldCommitOid:t="",changedFiles:n=0,contentsUrl:r}){let l=n>0&&r?`${n} ${1===n?"file":"files"}`:`from ${np(t)} to ${np(e)}`;return(0,i.jsxs)(i.Fragment,{children:["updated"," ",r?(0,i.jsx)(m.A,{inline:!0,href:`${r}/compare/${t}...${e}`,children:l}):l]})}function nb({compareUrl:e,linesAdded:t,linesDeleted:n,path:l,pathDigest:a,status:s}){return(0,i.jsx)(eR.l.LinkItem,{href:`${e}#diff-${a}`,className:nf.fileRowLinkItem,children:(0,i.jsxs)(nc.B,{gap:"condensed",direction:"horizontal",align:"center",className:nf.fileRow,children:[(0,i.jsx)(nu.E,{status:s}),(0,i.jsxs)("div",{className:"d-flex gap-1 flex-justify-between width-full",children:[(0,i.jsx)("span",{className:nf.path,children:l}),(t>0||n>0)&&(0,i.jsxs)("div",{className:"d-flex flex-shrink-0 gap-1 flex-nowrap",children:[(0,i.jsx)("div",{className:nf.linesAdded,children:t>0&&(0,i.jsxs)(r.C,{isAddition:!0,children:["+",ny(t)]})}),(0,i.jsx)("div",{className:nf.linesDeleted,children:n>0&&(0,i.jsxs)(r.C,{isAddition:!1,children:["-",ny(n)]})})]})]})]})})}function ny(e){return e>999?`${(e/1e3).toFixed(1)}k`:e.toLocaleString()}try{nh.displayName||(nh.displayName="SubmoduleDiff")}catch{}try{nm.displayName||(nm.displayName="SubmodulePath")}catch{}try{ng.displayName||(ng.displayName="SubmoduleCommitChange")}catch{}try{nx.displayName||(nx.displayName="SubmoduleModified")}catch{}try{nb.displayName||(nb.displayName="SubmoduleFileRow")}catch{}var nC=n(5796);let nv=({hasCopilotAccess:e,isBinary:t,isSubmodule:n,path:i,repository:r,status:l})=>!!e&&!t&&!n&&!!i&&"DELETED"!==l&&"REMOVED"!==l&&!!r.id&&!!r.name&&!!r.ownerLogin&&!0,nN=({newCommitOid:e,newTreeEntry:t,oldCommitOid:n,oldTreeEntry:i,path:r,pathDigest:l,repository:a})=>{let s=n&&e?(0,nC.IO9)({repo:a,commitish:n,action:"raw",path:r}):"";return{baseFile:nj({path:i?.path,oid:n,repository:a}),headFile:nj({path:t?.path,oid:e,repository:a}),baseBranchRef:n,id:`#diff-${l}`,type:"file-diff",url:s}},nj=({path:e,oid:t,repository:n})=>e&&t?{type:"file",url:(0,nC.IO9)({repo:n,commitish:t,action:"raw",path:e}),path:e,repoID:n.id,repoName:n.name,repoOwner:n.ownerLogin,ref:t,commitOID:t}:null,nw=(0,l.forwardRef)(function({collapsed:e,commentingEnabled:t,commentBatchPending:n,commentingImplementation:a,currentUser:s,diffContext:o,diffLines:d,diffManuallyExpanded:u,diffMatches:f,diffSize:h,focusedSearchResult:m,helpUrl:p,isBinary:g,isSubmodule:x,isTooBig:b,leftSideContent:y,linesAdded:C,linesChanged:v,linesDeleted:N,initialExpandedThreadId:j,markerNavigationImplementation:w,newTreeEntry:L,newCommitOid:S,objectId:D,oldTreeEntry:I,oldCommitOid:k,onToggleCollapse:E,path:_,pathDigest:R,pullRequest:A,repository:T,richDiff:O,rightSideContent:$,hasExpandedAllRanges:M,expandAllContextLines:P,canExpandOrCollapseLines:F,status:U,submodule:H,truncatedReason:B,addInjectedContextLines:z,loadDiff:G},V){let[q,W]=(0,l.useState)(O?.defaultToRichDiff),K=x&&!!H,[X,J]=(0,l.useState)(u),Y=function({isBinary:e,isSubmodule:t,path:n,status:i,repository:r,newCommitOid:a,newTreeEntry:s,oldCommitOid:o,oldTreeEntry:d,pathDigest:c,hasCopilotAccess:u}){return(0,l.useMemo)(()=>{if(nv({isBinary:e,isSubmodule:t,path:n,status:i,repository:r,hasCopilotAccess:u}))return nN({newCommitOid:a,newTreeEntry:s,oldCommitOid:o,oldTreeEntry:d,path:n,pathDigest:c,repository:r})},[a,s,o,d,c,r,u,e,t,n,i])}({isBinary:g,isSubmodule:x,path:_,status:U,repository:T,newCommitOid:S,newTreeEntry:L,oldCommitOid:k,oldTreeEntry:I,pathDigest:R,hasCopilotAccess:s.hasCopilotAccess}),Z=async()=>{await G(),J(!0)},Q=(0,l.useMemo)(()=>({avatarUrl:s?.avatarURL??"",diffViewPreference:s?.splitPreference,isSiteAdmin:!1,login:s?.login??"",lineSpacingPreference:s?.lineSpacing,tabSizePreference:s?.tabSize??8,viewerCanComment:s?.canComment,viewerCanApplySuggestion:s?.canApplySuggestion,commentsPreference:s?.commentsPreference}),[s]),ee=(0,l.useId)(),et=`heading-${ee}`;return(0,i.jsxs)("div",{role:"region",ref:V,"aria-labelledby":et,id:`diff-${R}`,className:nd.diffTargetable,style:{contain:"layout"},children:[(0,i.jsx)("div",{className:nd.diffHeaderWrapper,children:(0,i.jsx)(r.B,{headingId:et,areLinesExpanded:M,canExpandOrCollapseLines:F,defaultToRichDiff:O?.defaultToRichDiff,fileLinkHref:`#diff-${R}`,isCollapsed:e,isBinary:g,size:h,canToggleRichDiff:O?.canToggleRichDiff,linesAdded:C,linesChanged:v,linesDeleted:N,newMode:L?.mode,newPath:L?.path,oldMode:I?.mode,oldPath:I?.path,patchStatus:U,path:_,onToggleExpandAllLines:P,onToggleFileCollapsed:t=>E(t,!e),onToggleDiffDisplay:e=>W(e),additionalLeftSideContent:y,rightSideContent:$})}),e?null:(0,i.jsxs)("div",{className:"border position-relative rounded-bottom-2",children:[K&&(0,i.jsx)(nh,{submodule:H}),q&&(0,i.jsx)(c,{loading:!1,proseDiffHtml:O?.proseDiffHtml,fileRendererInfo:O?.renderInfo,dependencyDiffPath:O?.dependencyDiffPath}),!K&&!q&&(0,i.jsx)(ns,{diffContext:o,copilotChatReference:Y,searchResults:f,focusedSearchResult:m,diffEntryData:{diffLines:d,isBinary:g,isTooBig:b,linesChanged:v,newTreeEntry:L,newCommitOid:S,objectId:D,oldTreeEntry:I,oldCommitOid:k,path:_,pathDigest:R,status:U,truncatedReason:B},baseHelpUrl:p,commentBatchPending:n,repositoryId:T.id.toString(),subject:{state:A?.state},subjectId:A?.globalRelayId||"",viewerData:Q,newCommitOid:S,oldCommitOid:k,addInjectedContextLines:z,commentingEnabled:t||!1,commentingImplementation:a,initialExpandedThreadId:j,markerNavigationImplementation:w,diffLinesManuallyUnhidden:X,onHandleLoadDiff:Z})]})]},`${R}_${d.length}`)});function nL({path:e,pathDigest:t,linesAdded:n,linesChanged:a,linesDeleted:s,oldTreeEntry:o,newTreeEntry:d,status:c}){let u=(0,l.useId)(),f=`heading-${u}`,[h,m]=(0,l.useState)(!1);return(0,i.jsxs)("div",{role:"region","aria-labelledby":f,id:`diff-${t}`,className:nd.diffTargetable,style:{contain:"layout"},children:[(0,i.jsx)("div",{className:nd.diffHeaderWrapper,children:(0,i.jsx)(r.B,{headingId:f,isCollapsed:h,isBinary:!1,linesAdded:n,linesChanged:a,linesDeleted:s,newMode:d?.mode,newPath:d?.path,oldMode:o?.mode,oldPath:o?.path,patchStatus:c,path:e,onToggleFileCollapsed:()=>m(!h)})}),!h&&(0,i.jsx)("div",{className:"border position-relative rounded-bottom-2",children:(0,i.jsxs)(eg.A,{children:[(0,i.jsx)(eg.A.Visual,{children:(0,i.jsx)(_.AlertIcon,{size:"medium",className:"fgColor-muted"})}),(0,i.jsx)(eg.A.Heading,{as:"h4",children:"There was an issue loading this file"}),(0,i.jsxs)(eg.A.Description,{children:[" ","Try refreshing the page or if the problem persists"," ",(0,i.jsx)("a",{className:"fgColor-muted",href:"https://support.github.com/",children:(0,i.jsx)("u",{children:"contact support"})}),"."]})]})})]},`${t}_error`)}let nS=(0,l.memo)(nw);try{nw.displayName||(nw.displayName="DiffUnmemoized")}catch{}try{nL.displayName||(nL.displayName="DiffErrorFallback")}catch{}try{nS.displayName||(nS.displayName="Diff")}catch{}var nD=n(9591);let nI={defaultStyles:"DiffFind-module__defaultStyles--gxyWR"},nk=(0,l.memo)(function({currentPathDigestIndex:e,searchTerm:t,searchResults:n,setSearchTerm:r,focusedSearchResult:a,currentIndex:s,setCurrentIndex:o,setFocusedSearchResult:d,scrollDiffCellIntoView:c}){let u=(0,l.useRef)([]),f=(0,l.useRef)(0),h=()=>{r(""),d(void 0),e.current=0},m=(0,i.jsxs)("div",{className:"d-flex flex-row flex-justify-center flex-items-center",children:[t&&(0,i.jsxs)("span",{className:"text-small fgColor-subtle mx-2 text-center",children:[0===n.size||void 0===a?0:s+1,"/",f.current]}),!t&&(0,i.jsx)("span",{className:"text-small fgColor-subtle mx-2 text-center pr-4",children:"\xa0"}),t&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(Q.K,{size:"small",variant:"invisible",onClick:()=>{p(-1)},icon:_.ChevronUpIcon,"aria-label":"Up","data-testid":"up-search"}),(0,i.jsx)(Q.K,{size:"small",variant:"invisible",onClick:()=>{p(1)},icon:_.ChevronDownIcon,"aria-label":"Down","data-testid":"down-search"})]})]}),p=t=>{if(void 0===a||""===a.pathDigest){e.current=0,d({pathDigest:u.current[0]??"",indexWithinDigest:0});return}1===t?(o(s===f.current-1?0:s+1),a.indexWithinDigest===n.get(a.pathDigest).length-1?(e.current=e.current+1,e.current===u.current.length&&(e.current=0),a.pathDigest=u.current[e.current]??"",a.indexWithinDigest=0):a.indexWithinDigest=a.indexWithinDigest+1):(o(0===s?f.current-1:s-1),0===a.indexWithinDigest?(e.current=e.current-1,-1===e.current&&(e.current=u.current.length-1),a.pathDigest=u.current[e.current]??"",a.indexWithinDigest=n.get(a.pathDigest).length-1):a.indexWithinDigest=a.indexWithinDigest-1),d(a)};return(0,l.useEffect)(()=>{u.current=Array.from(n.keys()),e.current=0,d({pathDigest:u.current[0]??"",indexWithinDigest:0});let t=0;for(let e of n.values())t+=e.length;f.current=t},[e,n,n.size,d]),(0,l.useEffect)(()=>{n.size>0&&void 0!==a&&c(a)},[n,a,s]),(0,i.jsxs)("div",{className:nI.defaultStyles,children:[(0,i.jsx)(e9.ak,{commands:{"pull-requests-diff-view:jump-to-next-result-alternate":()=>p(1),"pull-requests-diff-view:jump-to-previous-result-alternate":()=>p(-1)}}),(0,i.jsx)(e9.tL,{commands:{"pull-requests-diff-view:jump-to-next-result":()=>p(1),"pull-requests-diff-view:jump-to-previous-result":()=>p(-1)},children:(0,i.jsx)(nD.A,{className:"border-0 box-shadow-none",style:{width:"100%"},validationStatus:f.current>1e3?"error":void 0,type:"text",leadingVisual:()=>(0,i.jsx)(tv.A,{icon:_.SearchIcon,"aria-hidden":"true"}),autoComplete:"off",name:"Find in commit input","aria-label":"Search within code",placeholder:"Search within code",value:t,onChange:e=>{e.target.value?(r(e.target.value),o(0)):h()},block:!0,trailingAction:m})})]})});try{nk.displayName||(nk.displayName="DiffFind")}catch{}let nE=(0,l.createContext)({diffFindOpen:!1,setDiffFindOpen:()=>void 0});function n_({children:e,searchTerm:t,setSearchTerm:n}){let r=(0,l.useRef)(""),[a,s]=(0,l.useState)(!1),o=(0,l.useCallback)(e=>{e&&""===t&&""!==r.current?n(r.current):e||""===t||(r.current=t,n("")),s(e)},[t,n]),d=(0,l.useMemo)(()=>({diffFindOpen:a,setDiffFindOpen:o}),[a,o]);return(0,i.jsx)(nE.Provider,{value:d,children:e})}try{nE.displayName||(nE.displayName="DiffFindOpenContext")}catch{}try{n_.displayName||(n_.displayName="DiffFindOpenProvider")}catch{}var nR=n(73412),nA=n(93307);function nT({data:e}){let{query:t,diffEntryInfo:n,currentDiffEntryData:i}=e,r=new Map;return{matchingDiffs:i?function(e,t,n){if(0===n.size)return new Map;let i=n.size>=200,r={},l=e.reduce((n,i,l)=>{if(r[l])return n;r[l]=!0;let a=nM(t,[e[l]]),s=a.next();for(;!s.done&&n.size<200;){let{resultsWithinDiff:t}=s.value;n.set(e[l]?.pathDigest??"",t),s=a.next()}return n},new Map);if(l.size<200&&i){let n=nM(t,e,l.size),i=n.next();for(;!i.done&&l.size<200;){let{resultsWithinDiff:t,diff:r}=i.value;l.set(e[r]?.pathDigest??"",t),i=n.next()}}return l}(n,n$(t),i):function(e,t){let n=new Map,i=nM(t,e),r=i.next();for(;!r.done&&n.size<200;){let{resultsWithinDiff:t,diff:l}=r.value;n.set(e[l]?.pathDigest??"",t),r=i.next()}return n}(n,n$(t)),query:t}}let nO={Text:"Text"};function n$(e){let t=e.replace(/[.*+?^${}()|[\]\\]/g,"\\$&");return{kind:nO.Text,regexp:RegExp(t,"gi")}}function*nM(e,t,n=0){for(let i=n;i<t.length;i++){let n=t[i],r=[],l=0;for(let a=0;a<n.diffLines.length;a++){let s,o;s=t[i]?.diffLines[a]?.type==="HUNK"?n.diffLines[a]?.text:n.diffLines[a]?.text?.substring(1);let d=n.diffLines[a];for(;s&&null!==(o=e.regexp.exec(s));){let e=o[0],t=o.index;r.push({pathDigest:n.pathDigest,indexWithinPathDigest:l,matchContent:e,column:t,diffLineNumIndex:a,isHunk:d?.type==="HUNK",hunkLineNumber:d?.blobLineNumber??-1,leftLineNumber:d?.type!=="ADDITION"?d?.left??-1:-1,rightLineNumber:d?.type!=="DELETION"?d?.right??-1:-1,columnEnd:t+e.length,text:s}),l++}}0!==r.length&&(yield{diff:i,resultsWithinDiff:r})}}function nP(e,t,n,i){let[r,a]=(0,l.useState)(new Map),[s,o]=(0,l.useState)(void 0),[d,c]=(0,l.useState)(0),u=l.useRef();!u.current&&t&&(u.current=new nA.N(new nR.z(n,nT),200,e=>1!==e.query.length));let f=(0,l.useRef)(t);f.current=t;let h=(0,l.useRef)("");(0,l.useEffect)(()=>function(){u.current?.terminate()},[]);let m=(0,l.useRef)([]);return u.current&&e!==m.current&&(u.current.onResponse=e=>{e.query===f.current&&(a(e.matchingDiffs),h.current=f.current)},m.current=e),(0,l.useEffect)(()=>{if(!e||!u.current||!h.current||""===h.current){a(new Map),o(void 0);return}a(new Map),o(void 0),u.current.post({query:h.current,diffEntryInfo:e,currentDiffEntryData:void 0})},[e?.length,e]),(0,l.useEffect)(()=>{if(e&&u.current)if(""===t)a(new Map),o(void 0),c(0),h.current="";else{var n;if(!((n=t).length>0&&n.length<=1e3))return;let i=h.current.length>0&&t.startsWith(h.current);u.current.post({query:t,diffEntryInfo:e,currentDiffEntryData:i?r:void 0}),c(0)}},[t,i]),{focusedSearchResult:s,setFocusedSearchResult:o,searchResults:r,currentIndex:d,setCurrentIndex:c}}},29063:(e,t,n)=>{n.d(t,{Dd:()=>s,EW:()=>r,ZD:()=>o,i8:()=>d,j$:()=>c,pd:()=>a});var i=n(4460);function r(e){let t=e.match(/^#?(diff-[a-f0-9]+)(L|R)(\d+)(?:-(L|R)(\d+))?$/i);if(null!=t&&6===t.length)return t;let n=e.match(/^#?(discussion-diff-[0-9]+)(L|R)(\d+)(?:-(L|R)(\d+))?$/i);return null!=n&&6===n.length?n:null}function l(e,t){return`${"left"===t?"L":"R"}${e}`}function a(e){let t=e.match(/^#?(diff-[a-f0-9]+)/);return t?.[1]}function s(e){let t=e.match(/^#?(r\d+)/),n=t?.[1];return n?parseInt(n.slice(1)):void 0}function o(e){let t=r(e);if(t){let e=t[1],n=t[2]?"L"===t[2]?"left":"right":void 0,i=t[3]?parseInt(t[3]):void 0;if(!e||!n||void 0===i)return;return{diffAnchor:e,startOrientation:n,startLineNumber:i,endOrientation:(t[4]?"L"===t[4]?"left":"right":void 0)??n,endLineNumber:(t[5]?parseInt(t[5]):void 0)??i,firstSelectedLineNumber:i,firstSelectedOrientation:n}}}function d(e){!function(e){let t=`#${e}`;if(t===window.location.hash)return;let n=window.location.href;(0,i.Zu)(t),window.dispatchEvent(new HashChangeEvent("hashchange",{newURL:window.location.href,oldURL:n}))}(c(e))}function c(e){let t=l(e.startLineNumber,e.startOrientation),n=`${e.diffAnchor}${t}`;if(e.endLineNumber!==e.startLineNumber||e.endOrientation!==e.startOrientation){let t=l(e.endLineNumber,e.endOrientation);n+=`-${t}`}return n}},37109:(e,t,n)=>{n.d(t,{Av:()=>L,Ji:()=>h,Ls:()=>j,Mk:()=>p,On:()=>o,Po:()=>u,S4:()=>y,Yf:()=>S,ZC:()=>g,_S:()=>m,a1:()=>N,a2:()=>s,dT:()=>w,j2:()=>x,oE:()=>C,pI:()=>b,qK:()=>f,qX:()=>d,u6:()=>c});var i=n(67220),r=n(96884),l=n(54332),a=n(29063);function s(e,t,n){return"left"===n?!u(e)&&e.left===t:!u(e)&&(0,i.XU)(e.type)===n&&e.right===t}function o(e,t){if(!e)return;if(!t)return e;let n=!1,i=!1,r=!1;for(let l of t)if(l&&(i||(i=s(l,e.startLineNumber,e.startOrientation)),r||(r=s(l,e.endLineNumber,e.endOrientation)),(n=r&&!i)||i&&r))break;return n?{...e,startLineNumber:e.endLineNumber,startOrientation:e.endOrientation,endLineNumber:e.startLineNumber,endOrientation:e.startOrientation}:e}function d(e,t,n){let i=`-${u(t)||"number"!=typeof t.left?"empty":t.left}`,r=n?`-${u(n)||"number"!=typeof n.right?"empty":n.right}`:"";return`${e}${i}${r}`}function c(e,t){return`${e}-${t}`}function u(e){return!!e&&e===l.V}function f(e){return!!e&&e!==l.V}function h(e){return"CONTEXT"===e.type}function m(e,t){let n;switch(t){case"ADDITION":n="+";break;case"DELETION":n="-";break;case"CONTEXT":case"INJECTED_CONTEXT":n=" "}if(!n||!e.startsWith(n))return[e,void 0];let i=e[0];return[e.substring(1),i]}function p(e){let t=[],n=[],i=()=>{for(;t.length<n.length;)t.push(l.V);for(;n.length<t.length;)n.push(l.V)};for(let r of e)switch(r.type){case"ADDITION":n.push(r);break;case"DELETION":t.push(r);break;case"CONTEXT":case"INJECTED_CONTEXT":case"HUNK":i(),t.push(r),n.push(r)}return i(),{leftLines:t,rightLines:n}}function g(e){return new DOMParser().parseFromString(e,"text/html").documentElement.textContent||""}function x({line:e,range:t,fileAnchor:n}){let i,{origin:r,pathname:l}=window.location;if(t?i=(0,a.j$)(t):e&&(i=function(e,t){let n=["HUNK","CONTEXT","INJECTED_CONTEXT","DELETION"].includes(e.type),i=n?e.left:e.right,r=n?"left":"right";if(null!==i)return(0,a.j$)({diffAnchor:t,endLineNumber:i,endOrientation:r,startLineNumber:i,startOrientation:r,firstSelectedLineNumber:i,firstSelectedOrientation:r})}(e,n)),i)return`${r}${l}#${i}`}function b({includeControlKey:e=!0,includeShiftKey:t,includeOptionKey:n,key:i}){let l=e?`${(0,r.U0)()?"\u2318":"Ctrl + "}`:"";return n&&(l+=`${(0,r.U0)()?"\u2325":"Alt + "}`),t&&(l+=`${(0,r.U0)()?"\u21E7":"Shift + "}`),l+=i}function y({hasThreads:e}){return e?"80px":"24px"}function C({includeControlKey:e=!0,includeShiftKey:t,includeOptionKey:n,key:i}){let l="";return e&&(l+=(0,r.U0)()?"Command+":"Control+"),n&&(l+=(0,r.U0)()?"Option+":"Alt+"),t&&(l+="Shift+"),l+=i}let v=["ADDITION","DELETION","CONTEXT"],N=(e,t)=>{if(!e)return!1;let n=t.leftLines.concat(t.rightLines);return n.length>0&&n.includes(e)?n.every(e=>!u(e)&&v.includes(e.type)):!u(e)&&v.includes(e.type)},j=e=>e?e.filter(e=>!u(e)).map(e=>{let[t]=m(g(e.html),e.type);return t}).join(`
`):"";function w(e){return!!(e.text.length<1&&("CONTEXT"===e.type||"INJECTED_CONTEXT"===e.type)||("DELETION"===e.type||"ADDITION"===e.type)&&1===e.text.length&&["+","-"].includes(e.text.charAt(0)))}let L=(e,t,n,i)=>{let r;if(e)return e;if(!u(t)){let e=(n?t.left:t.right)??0,l=n?"left":"right";r={startOrientation:l,endOrientation:l,startLineNumber:e,endLineNumber:e,firstSelectedLineNumber:e,firstSelectedOrientation:l,diffAnchor:i}}return r};function S(e,t=!1,n=!1){let i;switch(e){case"ADDITION":i=t?"var(--diffBlob-additionNum-bgColor, var(--diffBlob-addition-bgColor-num))":"var(--diffBlob-additionLine-bgColor, var(--diffBlob-addition-bgColor-line))";break;case"DELETION":i=t?"var(--diffBlob-deletionNum-bgColor, var(--diffBlob-deletion-bgColor-num))":"var(--diffBlob-deletionLine-bgColor, var(--diffBlob-deletion-bgColor-line))";break;case"HUNK":i=t?"var(--diffBlob-hunkNum-bgColor-rest, var(--diffBlob-hunk-bgColor-num))":"var(--diffBlob-hunkLine-bgColor, var(--bgColor-accent-muted))";break;case"EMPTY":i=t?"var(--diffBlob-emptyNum-bgColor, var(--diffBlob-hunk-bgColor-num))":"var(--diffBlob-emptyLine-bgColor, var(--bgColor-accent-muted))";break;default:i="var(--bgColor-default)"}return n?`color-mix(in oklab, var(--bgColor-accent-emphasis) 8%, ${i})`:i}},87592:(e,t,n)=>{n.d(t,{U:()=>a,l:()=>s});var i=n(96540),r=n(29063),l=n(47584);function a(){let[e,t]=(0,i.useState)(""),n=(0,i.useCallback)(()=>{t(((0,r.pd)(l.fV.hash??"")??"").replace("diff-",""))},[]);return(0,i.useEffect)(()=>(window.addEventListener("hashchange",n),n(),()=>{window.removeEventListener("hashchange",n)}),[n]),e}function s(){let[e,t]=(0,i.useState)(""),n=(0,i.useCallback)(()=>{let e=(0,r.EW)(l.fV.hash??"")??"",n="";t((""===e?(0,r.pd)(l.fV.hash??"")??"":e?.[0]??"").replace("diff-",""))},[]);return(0,i.useEffect)(()=>(window.addEventListener("hashchange",n),n(),()=>{window.removeEventListener("hashchange",n)}),[n]),e}},54332:(e,t,n)=>{n.d(t,{V:()=>i});let i="empty-diff-line"},80934:(e,t,n)=>{n.d(t,{U:()=>d});var i=n(21728),r=n(57572),l=n(97665),a=n(94747),s=n(86617),o=n(56176);function d(e){let t,n,d,c,u,f=(0,i.c)(11),{onSuccess:h,onError:m}=e,p=(0,l.jE)();return f[0]===Symbol.for("react.memo_cache_sentinel")?(t=async e=>{let{commentsPreference:t,lineSpacing:n,splitPreference:i}=e;if(!(0,o.M3)())return;let l={};t&&(l={...l,commentsPreference:t}),n&&(l={...l,lineSpacing:n}),i&&(l={...l,diff:i});let a=await (0,r.Sr)("/users/diffview",{method:"POST",headers:{Accept:"application/json"},body:l}),s=await a.json();if(a.ok)return s;throw Error(s.error||"Unknown error occurred",{cause:a.status})},f[0]=t):t=f[0],f[1]!==p?(n=async e=>{p.setQueryData((0,s.nZ)(),t=>({...t,...e}))},f[1]=p,f[2]=n):n=f[2],f[3]!==h?(d=()=>{h()},f[3]=h,f[4]=d):d=f[4],f[5]!==m?(c=e=>{m(e)},f[5]=m,f[6]=c):c=f[6],f[7]!==n||f[8]!==d||f[9]!==c?(u={mutationFn:t,onMutate:n,onSuccess:d,onError:c},f[7]=n,f[8]=d,f[9]=c,f[10]=u):u=f[10],(0,a.n)(u)}},86617:(e,t,n)=>{n.d(t,{C0:()=>h,Pe:()=>u,Qn:()=>m,bJ:()=>f,in:()=>d,nZ:()=>c,sI:()=>o});var i=n(21728),r=n(41281),l=n(97286),a=n(46928),s=n(4460);let o={Visible:"visible",Collapsed:"collapsed"},d={hideWhitespace:!1,splitPreference:"split",lineSpacing:"relaxed",commentsPreference:o.Visible};function c(){return[r.u.diffViewUserSettings]}function u(e){let t,n,r,a=(0,i.c)(6);a[0]===Symbol.for("react.memo_cache_sentinel")?(t=c(),a[0]=t):t=a[0];let s=t;return a[1]!==e?(n=async()=>e||d,a[1]=e,a[2]=n):n=a[2],a[3]!==e||a[4]!==n?(r={queryKey:s,queryFn:n,initialData:e,staleTime:1/0},a[3]=e,a[4]=n,a[5]=r):r=a[5],(0,l.I)(r)}function f(e,t){let n=new URL(window.location.href,window.location.origin);if(t){let i=encodeURIComponent(t);n.searchParams.set(e,i)}else n.searchParams.delete(e);(0,s.bj)(n.toString())}function h(e){let t,n=(0,i.c)(2),r=e,[l]=(0,a.o)();n[0]!==l?(t=l.get("diff"),n[0]=l,n[1]=t):t=n[1];let s=t;return("split"===s||"unified"===s)&&(r=s),r}function m(e){let t=e,[n]=(0,a.o)(),i=n.get("w");return"1"===i?t=!0:"0"===i&&(t=!1),t}},79658:(e,t,n)=>{n.d(t,{sI:()=>i});let i={Visible:"visible",Collapsed:"collapsed"}},41281:(e,t,n)=>{n.d(t,{u:()=>i});let i={codeButton:"code_button",codeowners:"codeowners",commits:"commits",diffEntries:"diff_entries",diffstat:"diffstat",header:"header",mergeBox:"merge_box",mergeInstructions:"merge_instructions",pendingReview:"pending_review",statusChecks:"status_checks",tabCounts:"tab_counts",threadPreviews:"thread_previews",viewedFilesCount:"viewed_files_count",viewedFilesCount2:"viewed_files_count2",diffSummaries:"diff_summaries",diffViewUserSettings:"user_diff_view_settings",tableOfContents:"table_of_contents",markers:"markers",diffCollapsedStatus:"diff_collapsed_status",diffContextLines:"diff_context_lines",abandonReview:"abandon_review",addCommentReaction:"add_comment_reaction",changeBase:"change_base",cleanupCodespaces:"cleanup_codespaces",createReviewComment:"create_review_comment",deleteHeadRef:"delete_head_ref",dequeuePullRequest:"dequeue_pull_request",disableAutoMerge:"disable_auto_merge",enableAutoMerge:"enable_auto_merge",dismissReview:"dismiss_review",markReadyForReview:"mark_ready_for_review",merge:"merge",removeCommentReaction:"remove_comment_reaction",reRequestReviewFromUser:"re_request_review_from_user",restoreHeadRef:"restore_head_ref",resolveThread:"resolve_thread",runActionRequiredWorkflows:"run_action_required_workflows",submitReview:"submit_review",unresolveThread:"unresolve_thread",updateReviewComment:"update_review_comment",updatePullRequestBranch:"update_pull_request_branch",updateTitle:"update_title",updateDiffViewUserSettings:"update_diff_view_user_settings",updateViewedFiles:"update_viewed_files",updateMergeBoxUserPreference:"update_merge_box_user_preference",hideComment:"hide_comment",unhideComment:"unhide_comment",submitSuggestedChanges:"apply_suggestions"}},28448:(e,t,n)=>{n.d(t,{Z:()=>r});var i=n(96540);function r({focusRowRef:e,mouseRowRef:t}){let[n,r]=i.useState(!1);return i.useEffect(()=>{if(e.current&&t.current){let n=()=>{let t=e.current?.querySelector(".PRIVATE_TreeView-item-content-text");t?.scrollWidth!==t?.offsetWidth&&r(!0)};e.current.onfocus=()=>{n()},e.current.onblur=()=>{r(!1)},t.current.onmouseenter=()=>{n()},t.current.onmouseleave=()=>{r(!1)}}},[e,t]),n}},87292:(e,t,n)=>{n.d(t,{L:()=>r});var i=n(96540);function r(e){(0,i.useEffect)(()=>{if(!e)return;let t=document.querySelector(".footer");if(t)return t.hidden=!0,()=>{t.hidden=!1}},[e])}},62964:(e,t,n)=>{n.d(t,{q:()=>h});var i=n(74848),r=n(78026),l=n(61663),a=n(94232),s=n(96540),o=n(5796),d=n(57572);async function c(e,t){if(!t)return;let n=new FormData;n.set("file_tree_visible",e?"true":"false"),(0,d.DI)((0,o.h6D)(t),{method:"PUT",body:n,headers:{Accept:"application/json"}})}let u={sm:l.Gy.small,md:l.Gy.medium,lg:l.Gy.large},f={size:"medium",mobileBreakpoint:"md"};function h(e,t,n,o){let d={...f,...o},[h]=(0,a.I)(()=>!1,!0,[]),m=(0,s.useRef)(null),p=(0,s.useRef)(null),g=u[d.mobileBreakpoint??"md"],[x,b]=(0,s.useState)(t),[y,C]=(0,s.useState)(!1),v=(0,s.useCallback)(()=>{(0,l.nn)(window.innerWidth)<=g?(C(!0),requestAnimationFrame(()=>p.current?.focus())):(b(!0),c(!0,n),requestAnimationFrame(()=>m.current?.focus()))},[g,n]),N=(0,s.useCallback)(()=>{(0,l.nn)(window.innerWidth)<=g?(C(!1),requestAnimationFrame(()=>p.current?.focus())):(b(!1),c(!1,n),requestAnimationFrame(()=>m.current?.focus()))},[g,n]),j=(0,s.useMemo)(()=>(0,i.jsx)(r.L,{expanded:x,alignment:"left",ariaLabel:x?"Collapse file tree":"Expand file tree",tooltipDirection:"se",testid:"file-tree-button",ariaControls:e,ref:m,onToggleExpanded:()=>{x?N():v()},className:`d-none d-${d.mobileBreakpoint}-flex position-relative`,size:d.size}),[x,e,d.mobileBreakpoint,d.size,N,v]),w=(0,s.useMemo)(()=>(0,i.jsx)(r.L,{expanded:y,alignment:"left",ariaLabel:y?"Collapse file tree":"Expand file tree",tooltipDirection:"se",testid:"file-tree-button",ariaControls:e,ref:p,onToggleExpanded:()=>{y?N():v()},className:`d-${d.mobileBreakpoint}-none position-relative`,size:d.size}),[y,e,d.mobileBreakpoint,d.size,N,v]);return{splitPagePaneHidden:h&&!t,splitPageContentHidden:{narrow:y,regular:!1},isTreeExpanded:x,isMobileTreeExpanded:y,expandTree:v,collapseTree:N,treeToggleElement:(0,s.useMemo)(()=>(0,i.jsxs)(i.Fragment,{children:[w,j]}),[w,j]),treeToggleRef:m}}},96590:(e,t,n)=>{n.d(t,{$:()=>s});var i=n(74848),r=n(38621),l=n(8338),a=n(39298);let s=e=>(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(l.l.Divider,{}),(0,i.jsx)(a.t,{eventContext:{prx:!0},leadingVisual:(0,i.jsx)(r.CopilotIcon,{}),fileDiffReference:e.copilotChatReference})]});try{s.displayName||(s.displayName="CopilotDiffChatBlobActionsMenuItems")}catch{}},35149:(e,t,n)=>{n.d(t,{i:()=>o});var i=n(74848),r=n(91618),l=n(46988),a=n(67136),s=n(8338);let o=({fileDiffReference:e,eventContext:t,afterSelect:n})=>{let{addToast:o}=(0,a.Y6)();return(0,i.jsx)(s.l.Item,{onSelect:()=>{(0,r.Oc)(e),o({message:"Reference added to thread",type:"success"}),(0,l.BI)("copilot.file-diff.add",t),n?.()},children:"Attach to current thread"})};try{o.displayName||(o.displayName="DiffLinesAttachMenuItem")}catch{}},39298:(e,t,n)=>{n.d(t,{t:()=>o});var i=n(74848),r=n(91618),l=n(77342),a=n(46988),s=n(8338);let o=({fileDiffReference:e,leadingVisual:t,eventContext:n,afterSelect:o})=>(0,i.jsxs)(s.l.Item,{onSelect:()=>{(0,r.qR)({intent:l.wh.conversation,references:[e]}),(0,a.BI)("copilot.file-diff.discuss",n),o?.()},children:[t&&(0,i.jsx)(s.l.LeadingVisual,{children:t}),"Ask about this diff"]});try{o.displayName||(o.displayName="DiffLinesDiscussMenuItem")}catch{}},5993:(e,t,n)=>{n.d(t,{e:()=>o});var i=n(74848),r=n(91618),l=n(77342),a=n(46988),s=n(8338);let o=({fileDiffReference:e,eventContext:t,afterSelect:n})=>(0,i.jsx)(s.l.Item,{onSelect:()=>{(0,r.qR)({content:"Explain",intent:l.wh.explainFileDiff,references:[e]}),(0,a.BI)("copilot.file-diff.explain",t),n?.()},children:"Explain"});try{o.displayName||(o.displayName="DiffLinesExplainMenuItem")}catch{}},10712:(e,t,n)=>{n.d(t,{oj:()=>v,ZH:()=>x});var i=n(74848),r=n(21728),l=n(38621),a=n(96540),s=n(12719),o=n(34614),d=n(7284),c=n(26920),u=n(58599),f=n(28448),h=n(29063),m=n(47584);let p={"file-tree-row":"DiffFileTree-module__file-tree-row--yr73E"},g=(0,a.memo)(function(e){let t,n=(0,r.c)(2),{changeType:l}=e;return n[0]!==l?(t=(0,i.jsx)(u.E,{status:l}),n[0]=l,n[1]=t):t=n[1],t});g.displayName="FileStatusIconItem";let x=(0,a.memo)(function(e){let t,n,c,u,h,x,b,y,C,v,N=(0,r.c)(44),{file:j,depth:w,hash:L,onSelect:S}=e,D=(0,a.useRef)(null),I=(0,a.useRef)(null),k=`#diff-${j.diff.pathDigest}`;N[0]===Symbol.for("react.memo_cache_sentinel")?(t={focusRowRef:D,mouseRowRef:D},N[0]=t):t=N[0];let E=(0,f.Z)(t),_=j.diff.totalCommentsCount??0,R=j.diff.highestAnnotationLevel,A=null,T=null;switch(R){case"WARNING":{let e,t,n=_>0?"and ":"";N[1]!==n?(e=(0,i.jsxs)("span",{className:"sr-only",children:[n," has warning annotations"]}),N[1]=n,N[2]=e):e=N[2],T=e,N[3]===Symbol.for("react.memo_cache_sentinel")?(t=(0,i.jsx)("div",{className:"pl-1 fgColor-attention",children:(0,i.jsx)(l.AlertIcon,{})}),N[3]=t):t=N[3],A=t;break}case"NOTICE":{let e,t,n=_>0?"and ":"";N[4]!==n?(e=(0,i.jsxs)("span",{className:"sr-only",children:[n," has notice annotations"]}),N[4]=n,N[5]=e):e=N[5],T=e,N[6]===Symbol.for("react.memo_cache_sentinel")?(t=(0,i.jsx)("div",{className:"pl-1 fgColor-default",children:(0,i.jsx)(l.InfoIcon,{})}),N[6]=t):t=N[6],A=t;break}case"FAILURE":{let e,t,n=_>0?"and ":"";N[7]!==n?(e=(0,i.jsxs)("span",{className:"sr-only",children:[n," has failure annotations"]}),N[7]=n,N[8]=e):e=N[8],T=e,N[9]===Symbol.for("react.memo_cache_sentinel")?(t=(0,i.jsx)("div",{className:"pl-1 fgColor-danger",children:(0,i.jsx)(l.XCircleFillIcon,{})}),N[9]=t):t=N[9],A=t}}N[10]!==j.diff.pathDigest||N[11]!==L?(n=()=>{if(D.current&&j.diff.pathDigest===L){let e=window.setTimeout(()=>{let e=m.XC?.getElementById("diff_file_tree")?.parentElement,t=D.current.offsetTop,n=m.cg?.innerHeight??0;e&&(e.scrollTop=t-n/2)},0);return()=>{window.clearTimeout(e)}}},c=[j.diff.pathDigest,L],N[10]=j.diff.pathDigest,N[11]=L,N[12]=n,N[13]=c):(n=N[12],c=N[13]),(0,a.useEffect)(n,c),N[14]!==k||N[15]!==j.diff||N[16]!==S?(u=e=>{if(e.nativeEvent instanceof KeyboardEvent){if(D?.current!==document.activeElement)return void e.preventDefault();if("Enter"===e.key||" "===e.key){e.preventDefault(),S?.(j.diff),I?.current?.click();return}}if(e.nativeEvent instanceof MouseEvent){if(e.metaKey||e.ctrlKey||1===e.button){e.preventDefault(),window.open(k,"_blank");return}S?.(j.diff),I?.current?.click()}},N[14]=k,N[15]=j.diff,N[16]=S,N[17]=u):u=N[17];let O=u,$=j.diff.pathDigest===L;return N[18]!==j.diff.changeType?(h=(0,i.jsx)(s.G.LeadingVisual,{children:(0,i.jsx)(g,{changeType:j.diff.changeType})}),N[18]=j.diff.changeType,N[19]=h):h=N[19],N[20]!==k||N[21]!==j.fileName?(x=(0,i.jsx)(o.A,{href:k,muted:!0,ref:I,role:"presentation",className:"fgColor-default",tabIndex:-1,"data-analytics-opt-out":!0,children:j.fileName}),N[20]=k,N[21]=j.fileName,N[22]=x):x=N[22],N[23]!==j.fileName||N[24]!==E?(b=E&&(0,i.jsx)(d.m,{"data-testid":`${j.fileName}-item-tooltip`,id:`${j.fileName}-item-tooltip`,contentRef:D,"aria-label":j.fileName,open:!0,direction:"ne"}),N[23]=j.fileName,N[24]=E,N[25]=b):b=N[25],N[26]!==_?(y=!!_&&(0,i.jsxs)("span",{className:"sr-only",children:["has ",_<10?_:"9+"," ",_>1?"comments":"comment"]}),N[26]=_,N[27]=y):y=N[27],N[28]!==A||N[29]!==R||N[30]!==_?(C=(!!_||R)&&(0,i.jsx)(s.G.TrailingVisual,{children:(0,i.jsxs)("div",{className:"d-flex flex-items-center flex-row",children:[!!_&&(0,i.jsxs)(i.Fragment,{children:[(0,i.jsx)(l.CommentIcon,{}),(0,i.jsx)("div",{className:"ml-1 text-bold fgColor-default f6",children:_<10?_:"9+"})]}),A]})}),N[28]=A,N[29]=R,N[30]=_,N[31]=C):C=N[31],N[32]!==T||N[33]!==w||N[34]!==j.diff.path||N[35]!==j.diff.pathDigest||N[36]!==O||N[37]!==C||N[38]!==$||N[39]!==h||N[40]!==x||N[41]!==b||N[42]!==y?(v=(0,i.jsx)(i.Fragment,{children:(0,i.jsxs)(s.G.Item,{defaultExpanded:!0,"aria-level":w,current:$,id:j.diff.path,onSelect:O,ref:D,className:p["file-tree-row"],children:[h,x,b,y,T,C]},j.diff.pathDigest)}),N[32]=T,N[33]=w,N[34]=j.diff.path,N[35]=j.diff.pathDigest,N[36]=O,N[37]=C,N[38]=$,N[39]=h,N[40]=x,N[41]=b,N[42]=y,N[43]=v):v=N[43],v});function b(e){let t,n,l,o,c,u,h,m,p,g,x,v,N=(0,r.c)(43);N[0]!==e?({directory:t,renderPattern:l,depth:o,leadingPath:c,...n}=e,N[0]=e,N[1]=t,N[2]=n,N[3]=l,N[4]=o,N[5]=c):(t=N[1],n=N[2],l=N[3],o=N[4],c=N[5]);let j=void 0===o?0:o,w=void 0===c?"":c,L=w?`${w}/`:"",S=a.useRef(null),D=a.useRef(null);N[6]===Symbol.for("react.memo_cache_sentinel")?(u={focusRowRef:D,mouseRowRef:S},N[6]=u):u=N[6];let I=(0,f.Z)(u);if(!t.files.length&&1===t.directories.length){let e,r;if(N[7]!==j||N[8]!==t.directories||N[9]!==t.name||N[10]!==n||N[11]!==L||N[12]!==l){let r;N[14]!==j||N[15]!==t.name||N[16]!==n||N[17]!==L||N[18]!==l?(r=e=>(0,i.jsx)(b,{depth:0===j?1:j,directory:e,leadingPath:`${L}${t.name}`,renderPattern:l,...n},e.path),N[14]=j,N[15]=t.name,N[16]=n,N[17]=L,N[18]=l,N[19]=r):r=N[19],e=t.directories.map(r),N[7]=j,N[8]=t.directories,N[9]=t.name,N[10]=n,N[11]=L,N[12]=l,N[13]=e}else e=N[13];return N[20]!==e?(r=(0,i.jsx)(i.Fragment,{children:e}),N[20]=e,N[21]=r):r=N[21],r}N[22]!==j||N[23]!==t||N[24]!==n||N[25]!==l?(h=function(){return"traditional"===l?(0,i.jsx)(y,{directory:t,depth:j,renderPattern:l,...n}):(0,i.jsx)(C,{directory:t,depth:j,renderPattern:l,...n})},N[22]=j,N[23]=t,N[24]=n,N[25]=l,N[26]=h):h=N[26];let k=h;if(0===j){let e;return N[27]!==k?(e=k(),N[27]=k,N[28]=e):e=N[28],e}N[29]===Symbol.for("react.memo_cache_sentinel")?(m=(0,i.jsx)(s.G.LeadingVisual,{children:(0,i.jsx)(s.G.DirectoryIcon,{})}),N[29]=m):m=N[29];let E=`${L}${t.name}`;return N[30]!==E?(p=(0,i.jsx)("span",{ref:S,children:E}),N[30]=E,N[31]=p):p=N[31],N[32]!==t.name||N[33]!==L||N[34]!==I?(g=I&&(0,i.jsx)(d.m,{"data-testid":`${t.name}-directory-item-tooltip`,id:`${t.name}-directory-item-tooltip`,contentRef:D,"aria-label":`${L}${t.name}`,open:!0,direction:"ne"}),N[32]=t.name,N[33]=L,N[34]=I,N[35]=g):g=N[35],N[36]!==k?(x=(0,i.jsx)(s.G.SubTree,{children:k()}),N[36]=k,N[37]=x):x=N[37],N[38]!==t.path||N[39]!==p||N[40]!==g||N[41]!==x?(v=(0,i.jsx)(i.Fragment,{children:(0,i.jsxs)(s.G.Item,{ref:D,defaultExpanded:!0,id:t.path,children:[m,p,g,x]},t.path)}),N[38]=t.path,N[39]=p,N[40]=g,N[41]=x,N[42]=v):v=N[42],v}let y=(0,a.memo)(function(e){let t,n,l,a,s,o,d,c=(0,r.c)(20);c[0]!==e?({directory:t,fileNodeRenderer:n,renderPattern:a,depth:s,...l}=e,c[0]=e,c[1]=t,c[2]=n,c[3]=l,c[4]=a,c[5]=s):(t=c[1],n=c[2],l=c[3],a=c[4],s=c[5]);let u=void 0===s?0:s;if(c[6]!==u||c[7]!==t.directories||c[8]!==t.files||c[9]!==n||c[10]!==l||c[11]!==a){let e,r=t.files.map(N).concat(t.directories.map(j));r.sort(w),c[13]!==u||c[14]!==n||c[15]!==l||c[16]!==a?(e=e=>"file"!==e.pathType?(0,i.jsx)(b,{depth:u+1,directory:e.node,fileNodeRenderer:n,renderPattern:a,...l},e.path):n?n({...l,file:e.node,depth:u+1}):(0,i.jsx)(x,{depth:u+1,file:e.node,...l},e.path),c[13]=u,c[14]=n,c[15]=l,c[16]=a,c[17]=e):e=c[17],o=r.map(e),c[6]=u,c[7]=t.directories,c[8]=t.files,c[9]=n,c[10]=l,c[11]=a,c[12]=o}else o=c[12];return c[18]!==o?(d=(0,i.jsx)(i.Fragment,{children:o}),c[18]=o,c[19]=d):d=c[19],d});function C(e){let t,n,l,a,s,o,d=(0,r.c)(21);d[0]!==e?({directory:t,depth:l,...n}=e,d[0]=e,d[1]=t,d[2]=n,d[3]=l):(t=d[1],n=d[2],l=d[3]);let c=void 0===l?0:l;if(d[4]!==c||d[5]!==t.files||d[6]!==n){let e;d[8]!==c||d[9]!==n?(e=e=>(0,i.jsx)(x,{depth:c+1,file:e,...n},e.filePath),d[8]=c,d[9]=n,d[10]=e):e=d[10],a=t.files.map(e),d[4]=c,d[5]=t.files,d[6]=n,d[7]=a}else a=d[7];if(d[11]!==c||d[12]!==t.directories||d[13]!==n){let e;d[15]!==c||d[16]!==n?(e=e=>(0,i.jsx)(b,{depth:c+1,directory:e,...n},e.path),d[15]=c,d[16]=n,d[17]=e):e=d[17],s=t.directories.map(e),d[11]=c,d[12]=t.directories,d[13]=n,d[14]=s}else s=d[14];return d[18]!==a||d[19]!==s?(o=(0,i.jsxs)(i.Fragment,{children:[a,s]}),d[18]=a,d[19]=s,d[20]=o):o=d[20],o}let v=(0,a.memo)(function(e){let t,n,l,o,d,u,f,p,g,x,y,C=(0,r.c)(20);C[0]!==e?({diffs:n,fileNodeRenderer:l,renderPattern:d,className:t,...o}=e,C[0]=e,C[1]=t,C[2]=n,C[3]=l,C[4]=o,C[5]=d):(t=C[1],n=C[2],l=C[3],o=C[4],d=C[5]),C[6]!==n?(u=(0,c.xY)(n),C[6]=n,C[7]=u):u=C[7];let v=u,[N,j]=a.useState("");C[8]===Symbol.for("react.memo_cache_sentinel")?(f=()=>{j(((0,h.pd)(m.fV.hash??"")??"").replace("diff-",""))},C[8]=f):f=C[8];let w=f;return C[9]===Symbol.for("react.memo_cache_sentinel")?(p=()=>(window.addEventListener("hashchange",w),w(),()=>{window.removeEventListener("hashchange",w)}),g=[w],C[9]=p,C[10]=g):(p=C[9],g=C[10]),(0,a.useEffect)(p,g),C[11]!==l||C[12]!==o||C[13]!==v||C[14]!==N||C[15]!==d?(x=(0,i.jsx)(b,{directory:v,fileNodeRenderer:l,renderPattern:d,...o,hash:N}),C[11]=l,C[12]=o,C[13]=v,C[14]=N,C[15]=d,C[16]=x):x=C[16],C[17]!==t||C[18]!==x?(y=(0,i.jsx)(s.G,{"aria-label":"File Tree",className:t,children:x}),C[17]=t,C[18]=x,C[19]=y):y=C[19],y});try{x.displayName||(x.displayName="File")}catch{}try{b.displayName||(b.displayName="Directory")}catch{}try{y.displayName||(y.displayName="TraditionalDirectoryRendering")}catch{}try{C.displayName||(C.displayName="GroupedDirectoryRendering")}catch{}try{v.displayName||(v.displayName="DiffFileTree")}catch{}function N(e){return{path:e.filePath,pathType:"file",node:e}}function j(e){return{path:e.path,pathType:"directory",node:e}}function w(e,t){return(0,c.wH)(e.path,t.path)}},3240:(e,t,n)=>{n.d(t,{kF:()=>g,F7:()=>p});var i,r=n(74848),l=n(21728),a=n(38621),s=n(9591),o=n(89323),d=n(87330),c=n(63867),u=n(8338),f=n(96540),h=n(34164);let m={filterLoadingHeight:"FileFilter-module__filterLoadingHeight--cW8BP",filterMaxHeight:"FileFilter-module__filterMaxHeight--TgM5t"},p="No extension";function g({filterSize:e="medium",filterText:t,onFilterTextChange:n,fileExtensions:i,unselectedFileExtensions:l,onFilterChange:c,additionalFilterGroups:g}){i=i??{},l=l??new Set;let[x,b]=(0,f.useState)(t),y=(e,t)=>{c?.(e?"selectFileExtension":"unselectFileExtension",{extension:t})},C=Object.keys(i).filter(e=>e!==p).sort(),v=e=>!l.has(e),N=!!i[p];return(0,r.jsxs)("div",{className:"d-flex flex-nowrap gap-2",children:[(0,r.jsx)(s.A,{block:!0,"aria-label":"Filter files\u2026",leadingVisual:a.SearchIcon,placeholder:"Filter files\u2026",size:e,className:(0,h.$)("small"===e&&m.filterMaxHeight),value:x,onChange:e=>{b(e.target.value),n?.(e.target.value)}}),(0,r.jsxs)(o.W,{children:[(0,r.jsx)(o.W.Anchor,{children:(0,r.jsx)(d.K,{"aria-label":"Filter options",icon:a.SlidersIcon,className:"flex-shrink-0",size:e})}),(0,r.jsx)(o.W.Overlay,{children:(0,r.jsxs)(u.l,{children:[(0,r.jsxs)(u.l.Group,{selectionVariant:"multiple",children:[(0,r.jsx)(u.l.GroupHeading,{children:"File extensions"}),C.map(e=>{let t=v(e);return(0,r.jsx)(u.l.Item,{selected:t,onSelect:()=>y(!t,e),children:`${e} (${i[e]})`},e)}),N&&(0,r.jsx)(u.l.Item,{selected:v(p),onSelect:()=>y(!v(p),p),children:`${p} (${i[p]})`},p)]}),g]})})]})]})}try{(i=function(e){let t,n,i,u,f,p=(0,l.c)(9),{filterText:g,onFilterTextChange:x}=e;return p[0]!==x?(t=e=>x?.(e.target.value),p[0]=x,p[1]=t):t=p[1],p[2]!==g||p[3]!==t?(n=(0,r.jsx)(s.A,{block:!0,"aria-label":"Filter files\u2026",leadingVisual:a.SearchIcon,placeholder:"Filter files\u2026",value:g,onChange:t}),p[2]=g,p[3]=t,p[4]=n):n=p[4],p[5]===Symbol.for("react.memo_cache_sentinel")?(i=(0,r.jsx)(o.W.Anchor,{children:(0,r.jsx)(d.K,{"aria-label":"Filter options",icon:a.SlidersIcon,className:"flex-shrink-0"})}),p[5]=i):i=p[5],p[6]===Symbol.for("react.memo_cache_sentinel")?(u=(0,r.jsxs)(o.W,{children:[i,(0,r.jsx)(o.W.Overlay,{className:(0,h.$)(m.filterLoadingHeight),children:(0,r.jsx)("div",{className:(0,h.$)("d-flex","flex-column","flex-justify-center","flex-items-center",m.filterLoadingHeight),children:(0,r.jsx)(c.A,{size:"medium"})})})]}),p[6]=u):u=p[6],p[7]!==n?(f=(0,r.jsxs)("div",{className:"d-flex flex-nowrap gap-2",children:[n,u]}),p[7]=n,p[8]=f):f=p[8],f}).displayName||(i.displayName="FileFilterLoading")}catch{}try{g.displayName||(g.displayName="FileFilterShared")}catch{}},58599:(e,t,n)=>{n.d(t,{E:()=>a});var i=n(74848),r=n(21728),l=n(38621);function a(e){let t=(0,r.c)(4),{status:n}=e;switch(n){case"ADDED":case"COPIED":{let e;return t[0]===Symbol.for("react.memo_cache_sentinel")?(e=(0,i.jsx)(l.FileAddedIcon,{size:16,className:"fgColor-success"}),t[0]=e):e=t[0],e}case"DELETED":case"REMOVED":{let e;return t[1]===Symbol.for("react.memo_cache_sentinel")?(e=(0,i.jsx)(l.FileRemovedIcon,{size:16,className:"fgColor-danger"}),t[1]=e):e=t[1],e}case"RENAMED":{let e;return t[2]===Symbol.for("react.memo_cache_sentinel")?(e=(0,i.jsx)(l.FileMovedIcon,{size:16,className:"fgColor-attention"}),t[2]=e):e=t[2],e}default:{let e;return t[3]===Symbol.for("react.memo_cache_sentinel")?(e=(0,i.jsx)(l.FileDiffIcon,{size:16,className:"fgColor-muted"}),t[3]=e):e=t[3],e}}}try{a.displayName||(a.displayName="FileStatusIcon")}catch{}},57442:(e,t,n)=>{n.d(t,{G:()=>M});var i=n(74848),r=n(21728),l=n(38621),a=n(89323),s=n(8338),o=n(34164),d=n(84217),c=n(55847),u=n(98939),f=n(96540),h=n(56176),m=n(5796),p=n(86365),g=n(57572);function x(e){return!e.dismissed}function b(e){return 0===(function(){let e,t,n=(0,r.c)(5),i=(0,p.B)();if(!i){let e;return n[0]===Symbol.for("react.memo_cache_sentinel")?(e=[],n[0]=e):e=n[0],e}n[1]!==i.userNotices?(e=i.userNotices??[],n[1]=i.userNotices,n[2]=e):e=n[2];let l=e;return n[3]!==l?(t=l.filter(x),n[3]=l,n[4]=t):t=n[4],t})().filter(t=>t.name===e).length}var y=n(80934);let C="compact_diff_lines";function v(){let e,t,n,l,a,s,o,p,x,v,w,L,S,D=(0,r.c)(22),I=b(C),{dismissNotice:k}=function(e){let t,n,i=(0,r.c)(5),l=b(e);i[0]!==l||i[1]!==e?(t=()=>{(0,h.M3)()&&!l&&(0,g.DI)((0,m.VB1)({noticeName:e}),{method:"POST"})},i[0]=l,i[1]=e,i[2]=t):t=i[2];let a=t;return i[3]!==a?(n={dismissNotice:a},i[3]=a,i[4]=n):n=i[4],n}(C);D[0]===Symbol.for("react.memo_cache_sentinel")?(e={onSuccess:j,onError:N},D[0]=e):e=D[0];let{mutate:E}=(0,y.U)(e),[_,R]=(0,f.useState)(!0);D[1]!==k||D[2]!==E?(t=()=>{E({lineSpacing:"compact"}),R(!1),k()},D[1]=k,D[2]=E,D[3]=t):t=D[3];let A=t;D[4]!==k?(n=()=>{R(!1),k()},D[4]=k,D[5]=n):n=D[5];let T=n;return I?null:(D[6]===Symbol.for("react.memo_cache_sentinel")?(l={top:"60px",right:"-4px"},D[6]=l):l=D[6],D[7]===Symbol.for("react.memo_cache_sentinel")?(a={minWidth:"260px",width:"40%"},D[7]=a):a=D[7],D[8]===Symbol.for("react.memo_cache_sentinel")?(s=(0,i.jsx)(d.A,{sx:{fontSize:2},as:"h2",children:"Customizable line height"}),o=(0,i.jsx)("p",{children:"The default line height has been increased for improved accessibility. You can choose to enable a more compact line height from the view settings menu."}),D[8]=s,D[9]=o):(s=D[8],o=D[9]),D[10]===Symbol.for("react.memo_cache_sentinel")?(p={flexShrink:0,flexGrow:1},D[10]=p):p=D[10],D[11]!==A?(x=(0,i.jsx)(c.Q,{onClick:A,sx:p,children:"Enable compact line height"}),D[11]=A,D[12]=x):x=D[12],D[13]===Symbol.for("react.memo_cache_sentinel")?(v={color:"accent.fg",flexGrow:1},D[13]=v):v=D[13],D[14]!==T?(w=(0,i.jsx)(c.Q,{onClick:T,variant:"invisible",sx:v,alignContent:"center",children:"Dismiss"}),D[14]=T,D[15]=w):w=D[15],D[16]!==w||D[17]!==x?(L=(0,i.jsxs)(u.A.Content,{className:"d-flex flex-column gap-2",sx:a,children:[s,o,(0,i.jsxs)("div",{className:"d-flex gap-2 flex-row w-full flex-wrap",children:[x,w]})]}),D[16]=w,D[17]=x,D[18]=L):L=D[18],D[19]!==_||D[20]!==L?(S=(0,i.jsx)(u.A,{open:_,caret:"top-right",sx:l,children:L}),D[19]=_,D[20]=L,D[21]=S):S=D[21],S)}function N(){}function j(){}try{v.displayName||(v.displayName="DiffCompactLinesPopover")}catch{}var w=n(86617),L=n(97665);function S(e){let t,n,l,a,o,d=(0,r.c)(15),{lineSpacingPreferenceAvailable:c,reloadOnChange:u}=e,f=void 0===c||c,h=void 0!==u&&u,{data:m}=(0,w.Pe)();d[0]===Symbol.for("react.memo_cache_sentinel")?(t={onSuccess:I,onError:D},d[0]=t):t=d[0];let{mutate:p}=(0,y.U)(t),g=(0,L.jE)();d[1]!==m||d[2]!==g||d[3]!==h?(n=()=>{m&&(g.setQueryData((0,w.nZ)(),e=>({...e,hideWhitespace:!m.hideWhitespace})),(0,w.bJ)("w",m.hideWhitespace?"0":"1"),h&&window.location.reload())},d[1]=m,d[2]=g,d[3]=h,d[4]=n):n=d[4];let x=n;return m?(d[5]!==m.hideWhitespace||d[6]!==x?(l=(0,i.jsx)(s.l.Item,{selected:m.hideWhitespace,onSelect:x,children:"Hide whitespace"}),d[5]=m.hideWhitespace,d[6]=x,d[7]=l):l=d[7],d[8]!==m.lineSpacing||d[9]!==f||d[10]!==p?(a=f&&(0,i.jsx)(s.l.Item,{selected:"compact"===m.lineSpacing,onSelect:()=>p({lineSpacing:"compact"===m.lineSpacing?"relaxed":"compact"}),children:"Compact line height"}),d[8]=m.lineSpacing,d[9]=f,d[10]=p,d[11]=a):a=d[11],d[12]!==l||d[13]!==a?(o=(0,i.jsxs)(s.l.Group,{selectionVariant:"multiple",variant:"subtle",children:[l,a]}),d[12]=l,d[13]=a,d[14]=o):o=d[14],o):null}function D(){}function I(){}try{S.displayName||(S.displayName="DiffLinePresentationToggles")}catch{}function k(e){let t,n,l,a,o,d,c,u=(0,r.c)(17),{reloadOnChange:f}=e,h=void 0!==f&&f,{data:m}=(0,w.Pe)(),p=m?.splitPreference;u[0]===Symbol.for("react.memo_cache_sentinel")?(t={onSuccess:_,onError:E},u[0]=t):t=u[0];let{mutate:g}=(0,y.U)(t);u[1]===Symbol.for("react.memo_cache_sentinel")?(n=(0,i.jsx)(s.l.GroupHeading,{children:"Layout"}),u[1]=n):n=u[1];let x="unified"===p;u[2]!==h||u[3]!==g?(l=()=>{g({splitPreference:"unified"}),(0,w.bJ)("diff","unified"),h&&window.location.reload()},u[2]=h,u[3]=g,u[4]=l):l=u[4],u[5]!==x||u[6]!==l?(a=(0,i.jsx)(s.l.Item,{selected:x,onSelect:l,children:"Unified"}),u[5]=x,u[6]=l,u[7]=a):a=u[7];let b="split"===p;return u[8]!==h||u[9]!==g?(o=()=>{g({splitPreference:"split"}),(0,w.bJ)("diff","split"),h&&window.location.reload()},u[8]=h,u[9]=g,u[10]=o):o=u[10],u[11]!==b||u[12]!==o?(d=(0,i.jsx)(s.l.Item,{selected:b,onSelect:o,children:"Split"}),u[11]=b,u[12]=o,u[13]=d):d=u[13],u[14]!==a||u[15]!==d?(c=(0,i.jsxs)(s.l.Group,{selectionVariant:"single",children:[n,a,d]}),u[14]=a,u[15]=d,u[16]=c):c=u[16],c}function E(){}function _(){}try{k.displayName||(k.displayName="DiffViewPreferenceToggle")}catch{}var R=n(46584),A=n(79658);function T(){let e,t,n,l,a=(0,r.c)(8),{diff_inline_comments:o,prx_files:d}=(0,R.h)(),{data:c}=(0,w.Pe)();a[0]===Symbol.for("react.memo_cache_sentinel")?(e={onSuccess:$,onError:O},a[0]=e):e=a[0];let{mutate:u}=(0,y.U)(e);if(!c||!(o||d))return null;let f=c.commentsPreference===A.sI.Collapsed;return a[1]===Symbol.for("react.memo_cache_sentinel")?(t=(0,i.jsx)(s.l.Divider,{}),a[1]=t):t=a[1],a[2]!==f||a[3]!==u?(n=()=>u({commentsPreference:f?A.sI.Visible:A.sI.Collapsed}),a[2]=f,a[3]=u,a[4]=n):n=a[4],a[5]!==f||a[6]!==n?(l=(0,i.jsxs)(i.Fragment,{children:[t,(0,i.jsx)(s.l.Group,{selectionVariant:"single",children:(0,i.jsx)(s.l.Item,{role:"menuitemcheckbox",selected:f,onSelect:n,children:"Minimize comments"})})]}),a[5]=f,a[6]=n,a[7]=l):l=a[7],l}function O(){}function $(){}try{T.displayName||(T.displayName="DiffCommentsPreferenceToggle")}catch{}function M(e){let t,n,d,c,u,f,h,m,p,g,x,b=(0,r.c)(22),{invisible:y,lineSpacingPreferenceAvailable:C,reloadOnSplitPreferenceChange:N,reloadOnWhitespaceChange:j,small:w}=e,L=void 0===C||C,D=void 0!==N&&N,I=void 0!==j&&j,E=void 0===y||y?"Button--invisible":"Button--secondary",_=w&&"Button--small";return b[0]!==E||b[1]!==_?(t=(0,o.$)("Button Button--iconOnly",E,_),b[0]=E,b[1]=_,b[2]=t):t=b[2],b[3]===Symbol.for("react.memo_cache_sentinel")?(n=(0,i.jsx)(l.GearIcon,{}),b[3]=n):n=b[3],b[4]!==t?(d=(0,i.jsx)(a.W.Anchor,{children:(0,i.jsx)("button",{className:t,"aria-label":"Open diff view settings",children:n})}),b[4]=t,b[5]=d):d=b[5],b[6]!==D?(c=(0,i.jsx)(k,{reloadOnChange:D}),b[6]=D,b[7]=c):c=b[7],b[8]===Symbol.for("react.memo_cache_sentinel")?(u=(0,i.jsx)(T,{}),f=(0,i.jsx)(s.l.Divider,{}),b[8]=u,b[9]=f):(u=b[8],f=b[9]),b[10]!==L||b[11]!==I?(h=(0,i.jsx)(S,{lineSpacingPreferenceAvailable:L,reloadOnChange:I}),b[10]=L,b[11]=I,b[12]=h):h=b[12],b[13]!==c||b[14]!==h?(m=(0,i.jsx)(a.W.Overlay,{children:(0,i.jsxs)(s.l,{children:[c,u,f,h]})}),b[13]=c,b[14]=h,b[15]=m):m=b[15],b[16]!==m||b[17]!==d?(p=(0,i.jsxs)(a.W,{children:[d,m]}),b[16]=m,b[17]=d,b[18]=p):p=b[18],b[19]===Symbol.for("react.memo_cache_sentinel")?(g=(0,i.jsx)(v,{}),b[19]=g):g=b[19],b[20]!==p?(x=(0,i.jsxs)(i.Fragment,{children:[p,g]}),b[20]=p,b[21]=x):x=b[21],x}try{M.displayName||(M.displayName="DiffViewSettings")}catch{}},78026:(e,t,n)=>{n.d(t,{L:()=>d});var i=n(74848),r=n(21728),l=n(38621),a=n(87330),s=n(94977),o=n(34164);let d=n(96540).forwardRef((e,t)=>{let n,d,c,u,f=(0,r.c)(21),{expanded:h,testid:m,ariaLabel:p,ariaControls:g,onToggleExpanded:x,alignment:b,dataHotkey:y,className:C,size:v,tooltipDirection:N,variant:j}=e,w=`expand-button-${m}`,L=h?`collapse-${m}`:`expand-${m}`,S=`expand-button-${m}`,D=h?"left"===b?l.SidebarExpandIcon:l.SidebarCollapseIcon:"left"===b?l.SidebarCollapseIcon:l.SidebarExpandIcon;f[0]!==x?(n=e=>{x(e)},f[0]=x,f[1]=n):n=f[1];let I=j??"invisible";return f[2]!==C?(d=(0,o.$)(C,"fgColor-muted"),f[2]=C,f[3]=d):d=f[3],f[4]!==g||f[5]!==y||f[6]!==h||f[7]!==t||f[8]!==v||f[9]!==L||f[10]!==S||f[11]!==D||f[12]!==n||f[13]!==I||f[14]!==d?(c=(0,i.jsx)(a.K,{unsafeDisableTooltip:!0,ref:t,"data-testid":L,"aria-labelledby":S,"aria-expanded":h,"aria-controls":g,icon:D,"data-hotkey":y,onClick:n,variant:I,size:v,className:d,"data-analytics-opt-out":!0}),f[4]=g,f[5]=y,f[6]=h,f[7]=t,f[8]=v,f[9]=L,f[10]=S,f[11]=D,f[12]=n,f[13]=I,f[14]=d,f[15]=c):c=f[15],f[16]!==p||f[17]!==w||f[18]!==c||f[19]!==N?(u=(0,i.jsx)(s.A,{"aria-label":p,id:w,direction:N,children:c}),f[16]=p,f[17]=w,f[18]=c,f[19]=N,f[20]=u):u=f[20],u});d.displayName="ExpandButton"},8877:(e,t,n)=>{n.r(t),n.d(t,{default:()=>h});var i=n(74848),r=n(94232),l=n(6869),a=n(75177),s=n(63867),o=n(52464),d=n(96540);let c={ERROR:"ERROR",LOADING:"LOADING",LOADED:"LOADED",READY:"READY"};function u(e){e&&(e.load=e.hello=null,e.helloTimer&&(clearTimeout(e.helloTimer),e.helloTimer=null),e.loadTimer&&(clearTimeout(e.loadTimer),e.loadTimer=null))}function f(e,t){e&&e.postMessage&&e.postMessage(JSON.stringify(t),"*")}function h({identityUuid:e,size:t,type:n,url:o}){let[h]=(0,r.I)(()=>window.location.origin,"https://www.github.com",[]),p=new URL(o,h).origin,{renderState:g,errorMsg:x,iFrameRef:b,containerRef:y}=function(e){let[t,n]=function(e){let[t,n]=(0,d.useState)(e),i=(0,d.useRef)(t);return[i,e=>{i.current=e,n(e)}]}(c.LOADING),i=(0,d.useRef)(null),r=(0,d.useRef)(null),l=(0,d.useRef)(null),a=(0,d.useRef)({untimed:!0}),s=(0,d.useCallback)(t=>(function(e,t,n,i,r,l,a){if(e.origin!==t)return;let s=function(e){var t;let n=e.data;if(!n)return null;if("string"==typeof n)try{n=JSON.parse(n)}catch{return null}return"object"==typeof(t=n)&&t&&"render"===t.type&&"string"==typeof t.body&&"object"==typeof t.payload?n:null}(e);if(!s)return void l(c.ERROR);let o=s.body,d=null!=s.payload?s.payload:void 0,u=n.current?.contentWindow;switch(o){case"hello":(r.current??{untimed:!0}).hello=Date.now(),f(u,{type:"render:cmd",body:{cmd:"ack",ack:!0}}),f(u,{type:"render:cmd",body:{cmd:"branding",branding:!1}});break;case"error":case"error:fatal":case"error:invalid":d&&a(d.error??null),l(c.ERROR);break;case"loading":l(c.LOADING);break;case"loaded":l(c.LOADED);break;case"ready":d&&"number"==typeof d.height&&i.current&&(i.current.style.height=`${d.height}px`),l(c.READY);break;case"resize":d&&"number"==typeof d.height&&i.current&&(i.current.style.height=`${d.height}px`);break;case"code_rendering_service:container:get_size":f(u,{type:"render:cmd",body:{cmd:"code_rendering_service:container:size","code_rendering_service:container:size":{width:i.current?.getBoundingClientRect().width}}});break;case"code_rendering_service:markdown:get_data":if(!n.current||!i.current)return;!function(e,t){let n=e.getAttribute("data-content");if(!n)return;let i={type:"render:cmd",body:{cmd:"code_rendering_service:data:ready","code_rendering_service:data:ready":{data:JSON.parse(n).data,width:t.getBoundingClientRect().width}}};f(e.contentWindow,i)}(n.current,i.current)}})(t,e,r,l,a,n,e=>i.current=e),[e,n]);return(0,d.useEffect)(()=>{u(a.current);let e=e=>{(t.current===c.LOADING||t.current===c.LOADED)&&(!e||a.current.hello)&&n(c.ERROR)};return a.current={load:Date.now(),hello:null,helloTimer:window.setTimeout(e,1e4,!0),loadTimer:window.setTimeout(e,45e3)},()=>{u(a.current)}},[t,n]),(0,d.useEffect)(()=>(window.addEventListener("message",s),()=>window.removeEventListener("message",s)),[s]),{renderState:t.current,errorMsg:i.current,iFrameRef:r,containerRef:l}}(p);if("ipynb"===n&&t>3e7||t>2e8)return(0,i.jsx)(l.A,{variant:"danger",children:"Sorry, this is too big to display."});let C=g!==c.READY?{height:"1px",width:"1px",position:"fixed",bottom:0,right:0}:{height:"100%",width:"100%"};return(0,i.jsx)(a.A,{sx:{width:"100%",display:"flex",justifyContent:"center"},children:(0,i.jsxs)(a.A,{"data-hpc":!0,"data-host":p,"data-type":n,ref:y,sx:{width:1024,...g!==c.ERROR?{borderBottomLeftRadius:"6px",borderBottomRightRadius:"6px",lineHeight:"0",padding:5,textAlign:"center"}:{},...g===c.READY?{height:"500px",padding:0,background:"none"}:{}},children:[g===c.ERROR?(0,i.jsx)(m,{error:x}):g!==c.READY?(0,i.jsx)(s.A,{size:"large",sx:{mx:"auto"}}):null,g!==c.ERROR&&(0,i.jsx)(a.A,{as:"iframe",ref:b,src:`${o}#${e}`,sandbox:"allow-scripts allow-same-origin allow-top-navigation",sx:{border:0,display:"block",...C},name:e,title:"File display",children:"Viewer requires iframe."})]})})}function m({error:e}){if(!e)return(0,i.jsx)(l.A,{variant:"danger",children:"Unable to render code block"});let t=e.split(`
`);return(0,i.jsxs)(l.A,{variant:"danger",children:[(0,i.jsx)(o.A,{as:"p",sx:{fontWeight:"bold"},children:"Error rendering embedded code"}),(0,i.jsx)("p",{children:t.map((e,t)=>(0,i.jsxs)(d.Fragment,{children:[e,(0,i.jsx)("br",{})]},`error-line-${t}`))})]})}try{h.displayName||(h.displayName="FileRendererBlob")}catch{}try{m.displayName||(m.displayName="FileRendererErrorMessage")}catch{}},84688:(e,t,n)=>{n.d(t,{x:()=>c});var i=n(74848),r=n(21728),l=n(93108),a=n(96540),s=n(94232);function o(e,t){let n,a,o,c,u,f,h=(0,r.c)(13);h[0]!==e?({children:n,src:o,...a}=e,h[0]=e,h[1]=n,h[2]=a,h[3]=o):(n=h[1],a=h[2],o=h[3]),h[4]===Symbol.for("react.memo_cache_sentinel")?(c=[],h[4]=c):c=h[4];let[m]=(0,s.I)(d,!0,c);return h[5]!==m||h[6]!==o?(u=m?{}:{src:o,"data-nonce":(0,l.M1)()},h[5]=m,h[6]=o,h[7]=u):u=h[7],h[8]!==n||h[9]!==a||h[10]!==t||h[11]!==u?(f=(0,i.jsx)("include-fragment",{...a,ref:t,...u,children:n}),h[8]=n,h[9]=a,h[10]=t,h[11]=u,h[12]=f):f=h[12],f}function d(){return!1}let c=(0,a.forwardRef)(o);try{o.displayName||(o.displayName="IncludeFragmentWithRef")}catch{}try{c.displayName||(c.displayName="IncludeFragment")}catch{}}}]);
//# sourceMappingURL=ui_packages_diff-lines_diff-lines_ts-ui_packages_diff-lines_hooks_use-selected-diff-hash_ts-u-62bb97-dde53261b9ab.js.map